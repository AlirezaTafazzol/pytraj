
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hbond &mdash; pytraj 1.0.3-beta0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.3-beta0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="pytraj 1.0.3-beta0 documentation" href="../index.html" />
    <link rel="up" title="Advanced examples" href="advanced_examples.html" />
    <link rel="next" title="Endless streaming calculation" href="advanced_endless_streaming.html" />
    <link rel="prev" title="Lysozyme NH order parameters" href="lysozyme_order_parameter_.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          pytraj</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.3-beta0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html">Trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../read_and_write.html">Read and Write</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modify_traj.html">Modify trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atom_mask_selection.html">Atom mask selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_slice.html">Fancy indexing of trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel.html">Parallel calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What&#8217;s new?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer guide for pytraj</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda.html">Use conda to manage different Python versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_viewer.html">Trajectory Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Hbond</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="lysozyme_order_parameter_.html" title="Previous Chapter: Lysozyme NH order parameters"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Lysozyme NH o...</span>
    </a>
  </li>
  <li>
    <a href="advanced_endless_streaming.html" title="Next Chapter: Endless streaming calculation"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Endless strea... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/tutorials/hbonds.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="hbond">
<span id="hbond-tutorial"></span><h1>Hbond<a class="headerlink" href="#hbond" title="Permalink to this headline">Â¶</a></h1>
<p>try <code class="docutils literal"><span class="pre">pytraj</span></code> online:</p>
<a class="reference external image-reference" href="http://mybinder.org/repo/hainm/notebook-pytraj"><img src="http://mybinder.org/badge.svg" /></a>
<div class="ipynotebook" id="notebook-container">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># load data</span>
<span class="c1"># pdb file from: http://www.rcsb.org/pdb/explore/explore.do?pdbId=1l2y</span>

<span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s1">&#39;1L2Y.pdb&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;1L2Y.pdb&#39;</span><span class="p">)</span>
<span class="n">traj</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[1]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>pytraj.TrajectoryIterator, 38 frames: 
Size: 0.000258 (GB)
&lt;Topology: 304 atoms, 20 residues, 1 mols, PBC with box type = ortho&gt;
           </pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># search hbonds for all residues</span>
<span class="c1"># dump data to `dataset` (similiar to python&#39;list and dict)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">search_hbonds</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;dataset&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="c1"># 0: no hbond</span>
<span class="c1"># 1: there is hbond</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;pytraj.DatasetList with 32 datasets&gt;
total_solute_hbonds
[6 7 8 ..., 7 6 6]

ASN1_O-GLN5_N-H
[1 0 0 ..., 0 0 0]

ARG16_O-TRP6_NE1-HE1
[1 1 1 ..., 1 1 1]
...

ASP9_OD2-SER14_OG-HG
[0 0 0 ..., 0 0 0]

ASP9_OD2-ARG16_NH1-HH11
[0 0 0 ..., 0 0 0]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get total solute hbonds</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;total_solute_hbonds&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;pytraj.array.DataArray: size=38, key=total_solute_hbonds, dtype=int32, ndim=1&gt; 
values:
[6 7 8 ..., 7 6 6]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># take data for specific hbond</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;ARG16_O-TRP6_NE1-HE1&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;pytraj.array.DataArray: size=38, key=ARG16_O-TRP6_NE1-HE1, dtype=int32, ndim=1&gt; 
values:
[1 1 1 ..., 1 1 1]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># take hbond for only ASP9</span>
<span class="n">glu5</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;ASP9&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glu5</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&apos;ASP9_O-SER14_OG-HG&apos;, &apos;ASP9_OD2-ARG16_NH1-HH12&apos;, &apos;ASP9_OD2-ARG16_NH2-HH22&apos;, &apos;ASP9_OD2-ARG16_NE-HE&apos;, &apos;ASP9_OD1-LYS8_NZ-HZ1&apos;, &apos;ASP9_OD2-ARG16_NH2-HH21&apos;, &apos;ASP9_OD1-SER14_OG-HG&apos;, &apos;GLN5_O-ASP9_N-H&apos;, &apos;ASP9_OD2-SER14_OG-HG&apos;, &apos;ASP9_OD2-ARG16_NH1-HH11&apos;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glu5_val</span> <span class="o">=</span> <span class="n">glu5</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glu5_val</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total hbonds for GLU5 per frame&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">glu5_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">glu5_val</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glu5_total</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1 1 1 ..., 0 0 0]
 [0 1 0 ..., 0 0 0]
 [0 1 0 ..., 0 0 0]
 ..., 
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]]
total hbonds for GLU5 per frame
[1 3 1 ..., 0 0 0]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># plot</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">glu5_total</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x10a017550&gt;]</pre>
</div>

</div>

<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
B7GVnQAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get usage</span>
<span class="n">help</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">search_hbonds</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function hbond in module pytraj.hbond_:

hbond(traj, mask=&apos;&apos;, solvent_donor=None, solvent_acceptor=None, distance=3.0, angle=135.0, image=False, series=True, options=&apos;&apos;, dtype=&apos;hbond&apos;, frame_indices=None, top=None)
    (combined with cpptraj doc) Searching for Hbond donors/acceptors in region specified by &#96;&#96;mask&#96;&#96;.
    Hydrogen bond is defined as A-HD, where A is acceptor heavy atom, H is hydrogen, D is
    donor heavy atom. Hydrogen bond is formed when A to D distance &lt; distance cutoff and A-H-D angle
    &gt; angle cutoff; if &#96;angle&#96; &lt; 0 it is ignored.
    
    Notes
    -----
    This pytraj&apos;s method provides limited data processing for hbond. If you need any extra analysis, please
    use cpptraj.
    
    Also, the usage of this method might be changed in the future (so don&apos;t be suprised).
    
    Parameters
    ----------
    traj : Trajectory-like
    mask : {str, 1D array-like}
        Atom mask for searching hbond. If this &#96;mask&#96; is specify, cpptraj will
        automatically search for donors and acceptors.
    solvent_donor : {None, str}, default None
    solvent_acceptor: {None, str}, deafult None
        if solvent_acceptor and solvent_donor are None, cpptraj only search hbond for
        if solvent_donor and solvent_acceptor are NOT None, cpptraj will search for hbond
        between solute and solvent too.
    distance : float, default 3.0 (angstrom)
        hbond distance cut off
    angle : float, 135.0 degree
        hbond angle cut off
    dtype : return output&apos;s type, default &apos;hbond&apos;
    image : bool, default False
    series : bool, default True
        - output time series (array of 1 and 0) for hbond or not (highly recommend to use this default value)
        - if False, you must specify dtype=&apos;dataset&apos;
    options : str
        additional cpptraj options. For example you can explicitly specify donormask and
        acceptormask.
    
        - If &#96;&#96;donormask&#96;&#96; is specified but not &#96;&#96;acceptormask&#96;&#96;, acceptors will be
          automatically searched for in &#96;&#96;mask&#96;&#96;.
    
        - If &#96;&#96;acceptormask&#96;&#96; is specified but not donormask, donors will be
        automatically search for in &#96;&#96;mask&#96;&#96;.
    
        - If both &#96;&#96;donormask&#96;&#96; and &#96;&#96;acceptormask&#96;&#96; are specified no automatic searching will
          occur.
    
    
    Returns
    -------
    out : DatasetHBond if series is True else return &apos;DatasetList&apos;
    
    Notes
    -----
    - pytraj use &apos;series&apos; as default. In cpptraj, you need to explicitly specify &apos;series&apos;.
    - if &apos;series&apos; is False, the &apos;dtype&apos; argument will be ignored.
    
    See also
    --------
    to_amber_mask
    
    
    Examples
    --------
    &gt;&gt;&gt; import pytraj as pt
    &gt;&gt;&gt; traj = pt.load_sample_data(&apos;tz2&apos;)
    &gt;&gt;&gt; # search hbond without including solvent
    &gt;&gt;&gt; data = pt.search_hbonds(traj, &apos;:5,8&apos;)
    &gt;&gt;&gt; data
    &lt;pytraj.hbonds.DatasetHBond
    donor_acceptor pairs : 2&gt;
    &gt;&gt;&gt; data.donor_acceptor
    [&apos;LYS8_O-GLU5_N-H&apos;, &apos;GLU5_O-LYS8_N-H&apos;]
    
    &gt;&gt;&gt; # get raw data, ndarray with shape=(n_hbonds+1, n_frames)
    &gt;&gt;&gt; # first array shows the total solute hbonds and other arrays shows
    &gt;&gt;&gt; # if hbond exists (1) or non-exists (0) for each frame
    &gt;&gt;&gt; data.values
    array([[2, 2, 0, ..., 1, 1, 1],
           [1, 1, 0, ..., 1, 1, 1],
           [1, 1, 0, ..., 0, 0, 0]], dtype=int32)
    
    &gt;&gt;&gt; # search hbond including solvent
    &gt;&gt;&gt; hbonds = pt.search_hbonds(traj, &apos;:5,8&apos;, solvent_donor=&apos;:WAT@O&apos;, solvent_acceptor=&apos;:WAT&apos;)
    &gt;&gt;&gt; hbonds
    &lt;pytraj.hbonds.DatasetHBond
    donor_acceptor pairs : 8&gt;
    
    &gt;&gt;&gt; hbonds.donor_acceptor
    [&apos;LYS8_O-GLU5_N-H&apos;, &apos;GLU5_O-LYS8_N-H&apos;, &apos;LYS8_HZ1-V&apos;, &apos;LYS8_HZ2-V&apos;, &apos;GLU5_OE2-V&apos;, &apos;GLU5_O-V&apos;, &apos;GLU5_OE1-V&apos;, &apos;LYS8_HZ3-V&apos;]
    &gt;&gt;&gt; # &apos;GLU5_O-V&apos; mean non-specific hbond between GLU5_O and solvent (:WAT in this case)

</pre>
</div>
</div>

</div>
</div>

</div>
</div><p>(<a class="reference external" href="hbonds_tutorial.ipynb">hbonds_tutorial.ipynb</a>; <a class="reference external" href="hbonds_tutorial_evaluated.ipynb">hbonds_tutorial_evaluated.ipynb</a>; <a class="reference external" href="hbonds_tutorial.py">hbonds_tutorial.py</a>)</p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, pytraj developers.<br/>
      Last updated on Apr 10, 2016.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>