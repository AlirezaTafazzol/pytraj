
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pytraj.io &#8212; pytraj 1.0.9.dev0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.9.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="pytraj 1.0.9.dev0 documentation" href="../index.html" />
    <link rel="up" title="API" href="index.html" />
    <link rel="next" title="pytraj.Trajectory" href="pytraj.trajectory.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          pytraj</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.9.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../read_and_write.html">Supported file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html">Trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atom_mask_selection.html">Atom mask selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel.html">Parallel calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer guide for pytraj</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Misc</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What&#8217;s new?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pytraj.io</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="pytraj.trajectory.html" title="Next Chapter: pytraj.Trajectory"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">pytraj.Trajec... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/_api/pytraj.io.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="pytraj-io">
<span id="id1"></span><h1>pytraj.io<a class="headerlink" href="#pytraj-io" title="Permalink to this headline">¶</a></h1>
<div class="custom-index container">
<script type="text/javascript" src='../_static/cindex.js'></script></div>
<span class="target" id="module-pytraj.io"></span><dl class="function">
<dt id="pytraj.io.load">
<code class="descclassname">pytraj.io.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>mask=None</em>, <em>stride=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load" title="Permalink to this definition">¶</a></dt>
<dd><p>try loading and returning appropriate values. See example below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, Trajectory filename</p>
<p><strong>top</strong> : Topology filename or a Topology</p>
<p><strong>frame_indices</strong> : {None, array_like}, default None</p>
<blockquote>
<div><p>only load frames with given number given in frame_indices</p>
</div></blockquote>
<p><strong>stride</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if given, frame will be skip every <cite>stride</cite>.
Note: if bot frame_indices and stride are given, <cite>frame_indices</cite> will be ignored.</p>
</div></blockquote>
<p><strong>mask</strong> : {str, None}, default None</p>
<blockquote>
<div><p>if None: load coordinates for all atoms
if string, load coordinates for given atom mask</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.io.iterload" title="pytraj.io.iterload"><code class="xref py py-obj docutils literal"><span class="pre">iterload</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li>For further slicing options, see pytraj.TrajectoryIterator (created by <code class="docutils literal"><span class="pre">pytraj.iterload</span></code>)</li>
<li>Also see <cite>pytraj.iterload</cite> for loading a series of trajectories that don&#8217;t fit to
memory</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load netcdf file with given amber parm file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load mol2 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;traj.mol2&#39;</span><span class="p">)</span> <span class="c1"># </span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load pdb file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;traj.pdb&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load given frame numbers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s1">&#39;tz2_dry&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="s1">&#39;!@H=&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load with frame slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># which is equal to:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load with stride</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">21</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load with stride for more than one filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">223</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load with stride for more than one filename, and with mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s1">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.iterload">
<code class="descclassname">pytraj.io.</code><code class="descname">iterload</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.iterload" title="Permalink to this definition">¶</a></dt>
<dd><p>return TrajectoryIterator object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: {str, list-like of filenames, pattern}</strong></p>
<blockquote>
<div><p>input trajectory filename(s). You can use a single filename, a list of filenames
or a pattern.</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}</p>
<blockquote>
<div><p>input topology. If str, pytraj will load from disk to Topology first</p>
</div></blockquote>
<p><strong>frame_slice: tuple or list of tuple</strong></p>
<blockquote>
<div><p>specify start, stop, step for each trajectory you want to read.</p>
<p>cpptraj input:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">trajin</span> <span class="n">traj0</span><span class="o">.</span><span class="n">nc</span> <span class="mi">1</span> <span class="mi">10</span>
<span class="n">trajin</span> <span class="n">traj1</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>In pytraj, corresponding frame_slice=[(0, 10), (0, -1)]</p>
</div></blockquote>
<p><strong>stride</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if not None, trajectories will be strided.
Note: if both stride and frame_slice are not None, frame_slice will be ignored</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.TrajectoryIterator</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Unlike <cite>pytraj.load</cite>, you can not arbitarily set <cite>frame_indices</cite>. If you want to do
so, first load trajectories to TrajectoryIterator object, then do fancy slicing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># register to load traj.nc from 0-th to 99-th frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s1">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;prmtop&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)])</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># do fancy indexing to load specific frames to memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load to disk with given mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s1">&#39;!@H=&#39;</span><span class="p">]</span> 
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s1">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load from a list of filenames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s1">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s1">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load all files with a given pattern (sorted)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s1">&#39;./traj*.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load from a list of files with given frame step</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># for each file, only register to load from frame 0 to 9 (skip 10), skip every 2 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s1">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s1">&#39;2koc.parm7&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># load from frame 0 to 9 for `traj0.nc`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># load all frames from `traj1.nc`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s1">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s1">&#39;2koc.parm7&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># use stride, skip every 2 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_remd_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filenames</span><span class="p">,</span> <span class="n">topology_filename</span> <span class="o">=</span> <span class="n">get_remd_fn</span><span class="p">(</span><span class="s1">&#39;remd_ala2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]</span>
<span class="go">[&#39;rem.nc.000&#39;, &#39;rem.nc.001&#39;, &#39;rem.nc.002&#39;, &#39;rem.nc.003&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">topology_filename</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_remd">
<code class="descclassname">pytraj.io.</code><code class="descname">load_remd</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>T='300.0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_remd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.io.iterload_remd">
<code class="descclassname">pytraj.io.</code><code class="descname">iterload_remd</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>T='300.0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.iterload_remd" title="Permalink to this definition">¶</a></dt>
<dd><p>Load temperature remd trajectory for single temperature.
e.g: Suppose you have replica trajectoris remd.x.00{1-4}.
You want to load and extract only frames at 300 K, use this method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>top</strong> : {str, Topology}</p>
<p><strong>T</strong> : {float, str}, default=300.0</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.traj.TrajectoryCpptraj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_pdb_rcsb">
<code class="descclassname">pytraj.io.</code><code class="descname">load_pdb_rcsb</code><span class="sig-paren">(</span><em>pdbid</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_pdb_rcsb" title="Permalink to this definition">¶</a></dt>
<dd><p>load pdb file from rcsb website</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pdbid</strong> : str</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>io.loadpdb_rcsb(&#8220;2KOC&#8221;) # popular RNA hairpin</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_cpptraj_file">
<code class="descclassname">pytraj.io.</code><code class="descname">load_cpptraj_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_cpptraj_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str, name of cpptraj input file</p>
<blockquote class="last">
<div><p>(&#8220;cpptraj -i input.txt&#8221; &#8211;&gt; fname = &#8220;input.txt&#8221;)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_sample_data">
<code class="descclassname">pytraj.io.</code><code class="descname">load_sample_data</code><span class="sig-paren">(</span><em>data_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_sample_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return TrajectoryIterator instance for Ala3 or tz2 data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_name</strong> : str, {&#8216;ala3&#8217;, &#8216;tz2&#8217;, &#8216;rna&#8217;, &#8216;trpcage&#8217;}, default &#8216;ala3&#8217;</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>tz2 dataset</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">$AMBERHOME/AmberTools/test/cpptraj/</span><dd>explicit water, ortho box</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_parmed">
<code class="descclassname">pytraj.io.</code><code class="descname">load_parmed</code><span class="sig-paren">(</span><em>parm</em>, <em>traj=True</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_parmed" title="Permalink to this definition">¶</a></dt>
<dd><p>return pytraj&#8217;s Topology or Trajectory objects</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>parm</strong> : ParmEd&#8217;s Structure object</p>
<p><strong>traj: bool, default True</strong></p>
<blockquote>
<div><p>if True, return pytraj.Trajectory
if False, return Topology</p>
</div></blockquote>
<p><strong>&gt;&gt;&gt; import parmed as pmd</strong></p>
<p><strong>&gt;&gt;&gt; import pytraj as pt</strong></p>
<p><strong>&gt;&gt;&gt; p = pmd.download_PDB(&#8220;1l2y&#8221;)</strong></p>
<p class="last"><strong>&gt;&gt;&gt; traj = pt.load_parmed(p)</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_leap">
<code class="descclassname">pytraj.io.</code><code class="descname">load_leap</code><span class="sig-paren">(</span><em>command</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_leap" title="Permalink to this definition">¶</a></dt>
<dd><p>create pytraj.Trajectory from tleap&#8217;s command.</p>
<p class="rubric">Notes</p>
<p>If you load pdb file, make sure to use absolute dir.
This method is not extensively tested. Use it with your own risk.</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_antechamber">
<code class="descclassname">pytraj.io.</code><code class="descname">load_antechamber</code><span class="sig-paren">(</span><em>filename</em>, <em>format=None</em>, <em>options=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_antechamber" title="Permalink to this definition">¶</a></dt>
<dd><p>create pytraj.Trajectory by using antechamber to convert <cite>filename</cite> to mol2 format,
then using <cite>pytraj.load</cite></p>
<p>Good for file formats that cpptraj and ParmEd do not support (.ac, ...)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>format</strong> : str or None, default None</p>
<blockquote>
<div><p>if None, using filename extension
else, use given format</p>
</div></blockquote>
<p class="last"><strong>options</strong> : str, additional antechamber command</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.load_topology">
<code class="descclassname">pytraj.io.</code><code class="descname">load_topology</code><span class="sig-paren">(</span><em>filename</em>, <em>option=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.load_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>load Topology from a filename or from url or from ParmEd object. Adapted from cpptraj doc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, Amber prmtop, pdb, mol2, psf, cif, gromacs topology, sdf, tinker formats</p>
<p><strong>option</strong> : cpptraj options.</p>
<blockquote class="last">
<div><p>if filename is a pdb file, option = {&#8216;pqr&#8217;, &#8216;noconnect&#8217;}.</p>
<ul class="simple">
<li>pqr     : Read atomic charge/radius from occupancy/B-factor columns.</li>
<li>noconect: Do not read CONECT records if present.</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if cpptraj/pytraj does not support specific file format, you still can convert to PDB
file. cpptraj will do the bond guess based on distance.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from a filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s2">&quot;data/tz2.ortho.parm7&quot;</span><span class="p">)</span>
<span class="go">&lt;Topology: 5293 atoms, 1704 residues, 1692 mols, PBC with box type = ortho&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># read with option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s1">&#39;1KX5.pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;bondsearch 0.2&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.write_parm">
<code class="descclassname">pytraj.io.</code><code class="descname">write_parm</code><span class="sig-paren">(</span><em>filename=None</em>, <em>top=None</em>, <em>format='amberparm'</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.write_parm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.io.save">
<code class="descclassname">pytraj.io.</code><code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>obj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.save" title="Permalink to this definition">¶</a></dt>
<dd><p>an universal method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : output filename</p>
<p><strong>obj</strong> : Topology or Trajetory-like</p>
<blockquote>
<div><p>if Topology, write a new Topology to disk
if Trajetory-like, write a trajectory to disk</p>
</div></blockquote>
<p class="last"><strong>*args, **kwd: additional options</strong></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.io.write_traj" title="pytraj.io.write_traj"><code class="xref py py-obj docutils literal"><span class="pre">write_traj</span></code></a>, <a class="reference internal" href="#pytraj.io.write_parm" title="pytraj.io.write_parm"><code class="xref py py-obj docutils literal"><span class="pre">write_parm</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">Topology</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save Topology to a new Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;output/prmtop&#39;</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s1">&#39;output/prmtop&#39;</span><span class="p">),</span> <span class="n">pt</span><span class="o">.</span><span class="n">Topology</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># save TrajectoryIterator to disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;output/traj.nc&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s1">&#39;output/traj.nc&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">),</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.write_traj">
<code class="descclassname">pytraj.io.</code><code class="descname">write_traj</code><span class="sig-paren">(</span><em>filename</em>, <em>traj</em>, <em>format='infer'</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>overwrite=False</em>, <em>crdinfo=None</em>, <em>options=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.write_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>write Trajectory-like or iterable object to trajectory file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>traj</strong> : Trajectory-like or iterator that produces Frame or 3D ndarray with shape=(n_frames, n_atoms, 3)</p>
<p><strong>format</strong> : str, default &#8216;infer&#8217;</p>
<blockquote>
<div><p>if &#8216;inter&#8217;, detect format based on extension. If can not detect, use amber mdcdf format.</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default: None</p>
<p><strong>frame_indices: array-like or iterator that produces integer, default: None</strong></p>
<blockquote>
<div><p>If not None, only write output for given frame indices</p>
</div></blockquote>
<p><strong>overwrite: bool, default: False</strong></p>
<p><strong>crdinfo</strong> : None or dict, default None</p>
<blockquote>
<div><p>if None, try to get info from traj._crdinfo (if traj has _crdinfo)
if given, use it. <cite>crdinfo</cite> needed to pass if you want to write force/velocity (netcdf)</p>
</div></blockquote>
<p class="last"><strong>options</strong> : str, additional cpptraj keywords</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<table border="1" class="docutils">
<colgroup>
<col width="68%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Format</th>
<th class="head">Extension</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Amber Trajectory</td>
<td>.crd</td>
</tr>
<tr class="row-odd"><td>Amber NetCDF</td>
<td>.nc</td>
</tr>
<tr class="row-even"><td>Amber Restart</td>
<td>.rst7</td>
</tr>
<tr class="row-odd"><td>Amber NetCDF</td>
<td>.ncrst</td>
</tr>
<tr class="row-even"><td>Charmm DCD</td>
<td>.dcd</td>
</tr>
<tr class="row-odd"><td>PDB</td>
<td>.pdb</td>
</tr>
<tr class="row-even"><td>Mol2</td>
<td>.mol2</td>
</tr>
<tr class="row-odd"><td>Scripps</td>
<td>.binpos</td>
</tr>
<tr class="row-even"><td>Gromacs</td>
<td>.trr</td>
</tr>
<tr class="row-odd"><td>SQM Input</td>
<td>.sqm</td>
</tr>
</tbody>
</table>
<p>&#8216;options&#8217; for writing to pdb format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dumpq</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">GB</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">parse</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">PARSE</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">vdw</span><span class="p">:</span>         <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">VDW</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">pdbres</span><span class="p">:</span>      <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">residue</span> <span class="n">names</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">pdbatom</span><span class="p">:</span>     <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">atom</span> <span class="n">names</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">pdbv3</span><span class="p">:</span>       <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">residue</span><span class="o">/</span><span class="n">atom</span> <span class="n">names</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">teradvance</span><span class="p">:</span>  <span class="n">Increment</span> <span class="n">record</span> <span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="c1"># for TER records (default no).&quot;</span>
<span class="n">terbyres</span><span class="p">:</span>    <span class="n">Print</span> <span class="n">TER</span> <span class="n">cards</span> <span class="n">based</span> <span class="n">on</span> <span class="n">residue</span> <span class="n">sequence</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">molecules</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">model</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">to</span> <span class="n">single</span> <span class="n">file</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">MODEL</span> <span class="n">records</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">multi</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">each</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">separate</span> <span class="n">files</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">chainid</span> <span class="o">&lt;</span><span class="n">c</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Write</span> <span class="n">character</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">chain</span> <span class="n">ID</span> <span class="n">column</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">sg</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">:</span>  <span class="n">Space</span> <span class="n">group</span> <span class="k">for</span> <span class="n">CRYST1</span> <span class="n">record</span><span class="p">,</span> <span class="n">only</span> <span class="k">if</span> <span class="n">box</span> <span class="n">coordinates</span> <span class="n">written</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">include_ep</span><span class="p">:</span>  <span class="n">Include</span> <span class="n">extra</span> <span class="n">points</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">conect</span><span class="p">:</span>      <span class="n">Write</span> <span class="n">CONECT</span> <span class="n">records</span> <span class="n">using</span> <span class="n">bond</span> <span class="n">information</span><span class="o">.</span><span class="s2">&quot;);</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/t.nc&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># write to amber netcdf file</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># write to multi pdb files (t.pdb.1, t.pdb.2, ...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/t.pdb&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># write all frames to single pdb file and each frame is seperated by &quot;MODEL&quot; word</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/t.pdb&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># write to DCD file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/test.dcd&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># write to netcdf file from 3D numpy array, need to provide Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/test_xyz.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/test_xyz.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># you can make a fake Topology to write xyz coordinates too</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_atoms</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">make_fake_topology</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s2">&quot;output/test_xyz_fake_top.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top2</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to amber netcdf format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">remdtraj</span><span class="p">:</span> <span class="n">Write</span> <span class="n">temperature</span> <span class="n">to</span> <span class="n">trajectory</span> <span class="p">(</span><span class="n">makes</span> <span class="n">REMD</span> <span class="n">trajectory</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">velocity</span><span class="p">:</span> <span class="n">Write</span> <span class="n">velocities</span> <span class="n">to</span> <span class="n">trajectory</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">force</span><span class="p">:</span> <span class="n">Write</span> <span class="n">forces</span> <span class="n">to</span> <span class="n">trajectory</span><span class="o">.</span><span class="s2">&quot;);</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to amber netcdf restart format(cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">novelocity</span><span class="p">:</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">write</span> <span class="n">velocities</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">notime</span><span class="p">:</span>     <span class="n">Do</span> <span class="ow">not</span> <span class="n">write</span> <span class="n">time</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">remdtraj</span><span class="p">:</span>   <span class="n">Write</span> <span class="n">temperature</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">time0</span><span class="p">:</span>      <span class="n">Time</span> <span class="k">for</span> <span class="n">first</span> <span class="n">frame</span> <span class="p">(</span><span class="n">default</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">dt</span><span class="p">:</span>         <span class="n">Time</span> <span class="n">step</span> <span class="k">for</span> <span class="n">subsequent</span> <span class="n">frames</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">time0</span><span class="o">+</span><span class="n">frame</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span> <span class="p">(</span><span class="n">default</span> <span class="mf">1.0</span><span class="p">)</span><span class="s2">&quot;);</span>
<span class="n">keepext</span>     <span class="n">Keep</span> <span class="n">filename</span> <span class="n">extension</span><span class="p">;</span> <span class="n">write</span> <span class="s1">&#39;&lt;name&gt;.&lt;num&gt;.&lt;ext&gt;&#39;</span> <span class="n">instead</span> <span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">myfile</span><span class="o">.</span><span class="mf">1.</span><span class="n">rst7</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to mol2 format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">single</span>   <span class="p">:</span> <span class="n">Write</span> <span class="n">to</span> <span class="n">a</span> <span class="n">single</span> <span class="n">file</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">multi</span>    <span class="p">:</span> <span class="n">Write</span> <span class="n">each</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">file</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="n">sybyltype</span><span class="p">:</span> <span class="n">Convert</span> <span class="n">Amber</span> <span class="n">atom</span> <span class="n">types</span> <span class="p">(</span><span class="k">if</span> <span class="n">present</span><span class="p">)</span> <span class="n">to</span> <span class="n">SYBYL</span> <span class="n">types</span><span class="o">.</span><span class="s2">&quot;);</span>
</pre></div>
</div>
<p>&#8216;options&#8217;  for other formats:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">please</span> <span class="n">check</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ambermd</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">doc12</span><span class="o">/</span><span class="n">Amber15</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.read_pickle">
<code class="descclassname">pytraj.io.</code><code class="descname">read_pickle</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.read_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pickled pandas object (or any other pickled object) from the specified
file path</p>
<p>Warning: Loading pickled data received from untrusted sources can be
unsafe. See: <a class="reference external" href="http://docs.python.org/2.7/library/pickle.html">http://docs.python.org/2.7/library/pickle.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>unpickled</strong> : type of object stored in file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.to_pickle">
<code class="descclassname">pytraj.io.</code><code class="descname">to_pickle</code><span class="sig-paren">(</span><em>obj</em>, <em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickle (serialize) object to input file path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>obj</strong> : any object</p>
<p><strong>path</strong> : string</p>
<blockquote class="last">
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.io.select_atoms">
<code class="descclassname">pytraj.io.</code><code class="descname">select_atoms</code><span class="sig-paren">(</span><em>mask</em>, <em>topology</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.io.select_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>return atom indices</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="s1">&#39;@CA&#39;</span><span class="p">)</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
</pre></div>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015-2016, pytraj developers.<br/>
      Last updated on Oct 14, 2016.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.<br/>
    </p>
  </div>
</footer>
  </body>
</html>