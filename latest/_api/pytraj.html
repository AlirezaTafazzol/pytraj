
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pytraj &mdash; pytraj 1.0.5.dev0+b4eb8de documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.5.dev0+b4eb8de',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="pytraj 1.0.5.dev0+b4eb8de documentation" href="../index.html" />
    <link rel="up" title="API" href="index.html" />
    <link rel="next" title="pytraj.io" href="pytraj.io.html" />
    <link rel="prev" title="API" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          pytraj</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.5.dev0+b4eb8de</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html">Trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../read_and_write.html">Read and Write</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modify_traj.html">Modify trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atom_mask_selection.html">Atom mask selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_slice.html">Fancy indexing of trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel.html">Parallel calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What&#8217;s new?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer guide for pytraj</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda.html">Use conda to manage different Python versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_viewer.html">Trajectory Viewer</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pytraj</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: API"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; API</span>
    </a>
  </li>
  <li>
    <a href="pytraj.io.html" title="Next Chapter: pytraj.io"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">pytraj.io &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/_api/pytraj.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="pytraj">
<h1>pytraj<a class="headerlink" href="#pytraj" title="Permalink to this headline">¶</a></h1>
<div class="custom-index container">
<script type="text/javascript" src='../_static/cindex.js'></script></div>
<span class="target" id="module-pytraj"></span><p>pytraj</p>
<dl class="function">
<dt id="pytraj.load">
<code class="descclassname">pytraj.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>mask=None</em>, <em>stride=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load" title="Permalink to this definition">¶</a></dt>
<dd><p>try loading and returning appropriate values. See example below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, Trajectory filename</p>
<p><strong>top</strong> : Topology filename or a Topology</p>
<p><strong>frame_indices</strong> : {None, array_like}, default None</p>
<blockquote>
<div><p>only load frames with given number given in frame_indices</p>
</div></blockquote>
<p><strong>stride</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if given, frame will be skip every <cite>stride</cite>.
Note: if bot frame_indices and stride are given, <cite>frame_indices</cite> will be ignored.</p>
</div></blockquote>
<p><strong>mask</strong> : {str, None}, default None</p>
<blockquote>
<div><p>if None: load coordinates for all atoms
if string, load coordinates for given atom mask</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.iterload" title="pytraj.iterload"><code class="xref py py-obj docutils literal"><span class="pre">iterload</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li>For further slicing options, see pytraj.TrajectoryIterator (created by <code class="docutils literal"><span class="pre">pytraj.iterload</span></code>)</li>
<li>Also see <cite>pytraj.iterload</cite> for loading a series of trajectories that don&#8217;t fit to
memory</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load netcdf file with given amber parm file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load mol2 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;traj.mol2&#39;</span><span class="p">)</span> <span class="c"># </span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load pdb file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;traj.pdb&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load given frame numbers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2_dry&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!@H=&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with frame slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># which is equal to:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with stride</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">21</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with stride for more than one filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">223</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with stride for more than one filename, and with mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.iterload">
<code class="descclassname">pytraj.</code><code class="descname">iterload</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterload" title="Permalink to this definition">¶</a></dt>
<dd><p>return TrajectoryIterator object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: {str, list-like of filenames, pattern}</strong></p>
<blockquote>
<div><p>input trajectory filename(s). You can use a single filename, a list of filenames
or a pattern.</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}</p>
<blockquote>
<div><p>input topology. If str, pytraj will load from disk to Topology first</p>
</div></blockquote>
<p><strong>frame_slice: tuple or list of tuple</strong></p>
<blockquote>
<div><p>specify start, stop, step for each trajectory you want to read.</p>
<p>cpptraj input:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">trajin</span> <span class="n">traj0</span><span class="o">.</span><span class="n">nc</span> <span class="mi">1</span> <span class="mi">10</span>
<span class="n">trajin</span> <span class="n">traj1</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>In pytraj, corresponding frame_slice=[(0, 10), (0, -1)]</p>
</div></blockquote>
<p><strong>stride</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if not None, trajectories will be strided.
Note: if both stride and frame_slice are not None, frame_slice will be ignored</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.TrajectoryIterator</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Unlike <cite>pytraj.load</cite>, you can not arbitarily set <cite>frame_indices</cite>. If you want to do
so, first load trajectories to TrajectoryIterator object, then do fancy slicing</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># register to load traj.nc from 0-th to 99-th frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s">&#39;prmtop&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)])</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do fancy indexing to load specific frames to memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load to disk with given mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s">&#39;!@H=&#39;</span><span class="p">]</span> 
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from a list of filenames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load all files with a given pattern (sorted)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;./traj*.nc&#39;</span><span class="p">,</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from a list of files with given frame step</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># for each file, only register to load from frame 0 to 9 (skip 10), skip every 2 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from frame 0 to 9 for `traj0.nc`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load all frames from `traj1.nc`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use stride, skip every 2 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_remd_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filenames</span><span class="p">,</span> <span class="n">topology_filename</span> <span class="o">=</span> <span class="n">get_remd_fn</span><span class="p">(</span><span class="s">&#39;remd_ala2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]</span>
<span class="go">[&#39;rem.nc.000&#39;, &#39;rem.nc.001&#39;, &#39;rem.nc.002&#39;, &#39;rem.nc.003&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">topology_filename</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_remd">
<code class="descclassname">pytraj.</code><code class="descname">load_remd</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>T='300.0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_remd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.iterload_remd">
<code class="descclassname">pytraj.</code><code class="descname">iterload_remd</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>T='300.0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterload_remd" title="Permalink to this definition">¶</a></dt>
<dd><p>Load temperature remd trajectory for single temperature.
Example: Suppose you have replica trajectoris remd.x.00{1-4}.
You want to load and extract only frames at 300 K, use this method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>top</strong> : {str, Topology}</p>
<p><strong>T</strong> : {float, str}, default=300.0</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.traj.TrajectoryCpptraj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_pdb_rcsb">
<code class="descclassname">pytraj.</code><code class="descname">load_pdb_rcsb</code><span class="sig-paren">(</span><em>pdbid</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_pdb_rcsb" title="Permalink to this definition">¶</a></dt>
<dd><p>load pdb file from rcsb website</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pdbid</strong> : str</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>io.loadpdb_rcsb(&#8220;2KOC&#8221;) # popular RNA hairpin</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_cpptraj_file">
<code class="descclassname">pytraj.</code><code class="descname">load_cpptraj_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_cpptraj_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str, name of cpptraj input file</p>
<blockquote class="last">
<div><p>(&#8220;cpptraj -i input.txt&#8221; &#8211;&gt; fname = &#8220;input.txt&#8221;)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_sample_data">
<code class="descclassname">pytraj.</code><code class="descname">load_sample_data</code><span class="sig-paren">(</span><em>data_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_sample_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return TrajectoryIterator instance for Ala3 or tz2 data</p>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>tz2 dataset</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">$AMBERHOME/AmberTools/test/cpptraj/</span><dd>explicit water, ortho box</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_ParmEd">
<code class="descclassname">pytraj.</code><code class="descname">load_ParmEd</code><span class="sig-paren">(</span><em>parmed_obj</em>, <em>as_traj=False</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_ParmEd" title="Permalink to this definition">¶</a></dt>
<dd><p>return pytraj&#8217;s Topology or Trajectory objects</p>
<p>parmed_obj : ParmEd&#8217;s Structure object
as_traj: bool, default False</p>
<blockquote>
<div>if True, return pytraj.trajectory.Trajectory
if False, return Topology</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">parmed</span> <span class="k">as</span> <span class="nn">pmd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">download_PDB</span><span class="p">(</span><span class="s">&quot;1l2y&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_ParmEd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_topology">
<code class="descclassname">pytraj.</code><code class="descname">load_topology</code><span class="sig-paren">(</span><em>filename</em>, <em>option=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>load Topology from a filename or from url or from ParmEd object. Adapted from cpptraj doc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, Amber prmtop, pdb, mol2, psf, cif, gromacs topology, sdf, tinker formats</p>
<p><strong>option</strong> : cpptraj options.</p>
<blockquote class="last">
<div><p>if filename is a pdb file, option = {&#8216;pqr&#8217;, &#8216;noconnect&#8217;}.</p>
<ul class="simple">
<li>pqr     : Read atomic charge/radius from occupancy/B-factor columns.</li>
<li>noconect: Do not read CONECT records if present.</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if cpptraj/pytraj does not support specific file format, you still can convert to PDB
file. cpptraj will do the bond guess based on distance.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># from a filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s">&quot;data/tz2.ortho.parm7&quot;</span><span class="p">)</span>
<span class="go">&lt;Topology: 5293 atoms, 1704 residues, 1692 mols, PBC with box type = ortho&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># read with option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s">&#39;1KX5.pdb&#39;</span><span class="p">,</span> <span class="s">&#39;bondsearch 0.2&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.write_parm">
<code class="descclassname">pytraj.</code><code class="descname">write_parm</code><span class="sig-paren">(</span><em>filename=None</em>, <em>top=None</em>, <em>format='amberparm'</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.write_parm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.save">
<code class="descclassname">pytraj.</code><code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>obj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.save" title="Permalink to this definition">¶</a></dt>
<dd><p>an universal method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : output filename</p>
<p><strong>obj</strong> : Topology or Trajetory-like</p>
<blockquote>
<div><p>if Topology, write a new Topology to disk
if Trajetory-like, write a trajectory to disk</p>
</div></blockquote>
<p class="last"><strong>*args, **kwd: additional options</strong></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../read_and_write.html#pytraj.write_traj" title="pytraj.write_traj"><code class="xref py py-obj docutils literal"><span class="pre">write_traj</span></code></a>, <a class="reference internal" href="#pytraj.write_parm" title="pytraj.write_parm"><code class="xref py py-obj docutils literal"><span class="pre">write_parm</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">Topology</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># save Topology to a new Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;output/prmtop&#39;</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s">&#39;output/prmtop&#39;</span><span class="p">),</span> <span class="n">pt</span><span class="o">.</span><span class="n">Topology</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># save TrajectoryIterator to disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;output/traj.nc&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;output/traj.nc&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">),</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.write_traj">
<code class="descclassname">pytraj.</code><code class="descname">write_traj</code><span class="sig-paren">(</span><em>filename=''</em>, <em>traj=None</em>, <em>format='infer'</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>overwrite=False</em>, <em>options=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.write_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>write Trajectory-like or iterable object to trajectory file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>traj</strong> : Trajectory-like or iterator that produces Frame or 3D ndarray with shape=(n_frames, n_atoms, 3)</p>
<p><strong>format</strong> : str, default &#8216;infer&#8217;</p>
<blockquote>
<div><p>if &#8216;inter&#8217;, detect format based on extension. If can not detect, use amber mdcdf format.</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default: None</p>
<p><strong>frame_indices: array-like or iterator that produces integer, default: None</strong></p>
<blockquote>
<div><p>If not None, only write output for given frame indices</p>
</div></blockquote>
<p><strong>overwrite: bool, default: False</strong></p>
<p class="last"><strong>options</strong> : str, additional cpptraj keywords</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<table border="1" class="docutils">
<colgroup>
<col width="68%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Format</th>
<th class="head">Extension</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Amber Trajectory</td>
<td>.crd</td>
</tr>
<tr class="row-odd"><td>Amber NetCDF</td>
<td>.nc</td>
</tr>
<tr class="row-even"><td>Amber Restart</td>
<td>.rst7</td>
</tr>
<tr class="row-odd"><td>Amber NetCDF</td>
<td>.ncrst</td>
</tr>
<tr class="row-even"><td>Charmm DCD</td>
<td>.dcd</td>
</tr>
<tr class="row-odd"><td>PDB</td>
<td>.pdb</td>
</tr>
<tr class="row-even"><td>Mol2</td>
<td>.mol2</td>
</tr>
<tr class="row-odd"><td>Scripps</td>
<td>.binpos</td>
</tr>
<tr class="row-even"><td>Gromacs</td>
<td>.trr</td>
</tr>
<tr class="row-odd"><td>SQM Input</td>
<td>.sqm</td>
</tr>
</tbody>
</table>
<p>&#8216;options&#8217; for writing to pdb format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">dumpq</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">GB</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">parse</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">PARSE</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">vdw</span><span class="p">:</span>         <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">VDW</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">pdbres</span><span class="p">:</span>      <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">residue</span> <span class="n">names</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">pdbatom</span><span class="p">:</span>     <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">atom</span> <span class="n">names</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">pdbv3</span><span class="p">:</span>       <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">residue</span><span class="o">/</span><span class="n">atom</span> <span class="n">names</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">teradvance</span><span class="p">:</span>  <span class="n">Increment</span> <span class="n">record</span> <span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="c"># for TER records (default no).&quot;</span>
<span class="n">terbyres</span><span class="p">:</span>    <span class="n">Print</span> <span class="n">TER</span> <span class="n">cards</span> <span class="n">based</span> <span class="n">on</span> <span class="n">residue</span> <span class="n">sequence</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">molecules</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">model</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">to</span> <span class="n">single</span> <span class="n">file</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">MODEL</span> <span class="n">records</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">multi</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">each</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">separate</span> <span class="n">files</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">chainid</span> <span class="o">&lt;</span><span class="n">c</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Write</span> <span class="n">character</span> <span class="s">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">chain</span> <span class="n">ID</span> <span class="n">column</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">sg</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">:</span>  <span class="n">Space</span> <span class="n">group</span> <span class="k">for</span> <span class="n">CRYST1</span> <span class="n">record</span><span class="p">,</span> <span class="n">only</span> <span class="k">if</span> <span class="n">box</span> <span class="n">coordinates</span> <span class="n">written</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">include_ep</span><span class="p">:</span>  <span class="n">Include</span> <span class="n">extra</span> <span class="n">points</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">conect</span><span class="p">:</span>      <span class="n">Write</span> <span class="n">CONECT</span> <span class="n">records</span> <span class="n">using</span> <span class="n">bond</span> <span class="n">information</span><span class="o">.</span><span class="s">&quot;);</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/t.nc&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span> <span class="c"># write to amber netcdf file</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write to multi pdb files (t.pdb.1, t.pdb.2, ...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/t.pdb&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s">&#39;multi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write all frames to single pdb file and each frame is seperated by &quot;MODEL&quot; word</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/t.pdb&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write to DCD file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test.dcd&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write to netcdf file from 3D numpy array, need to provide Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test_xyz.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test_xyz.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># you can make a fake Topology to write xyz coordinates too</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_atoms</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">make_fake_topology</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test_xyz_fake_top.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top2</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to amber netcdf format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">remdtraj</span><span class="p">:</span> <span class="n">Write</span> <span class="n">temperature</span> <span class="n">to</span> <span class="n">trajectory</span> <span class="p">(</span><span class="n">makes</span> <span class="n">REMD</span> <span class="n">trajectory</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">velocity</span><span class="p">:</span> <span class="n">Write</span> <span class="n">velocities</span> <span class="n">to</span> <span class="n">trajectory</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">force</span><span class="p">:</span> <span class="n">Write</span> <span class="n">forces</span> <span class="n">to</span> <span class="n">trajectory</span><span class="o">.</span><span class="s">&quot;);</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to amber netcdf restart format(cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">novelocity</span><span class="p">:</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">write</span> <span class="n">velocities</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">notime</span><span class="p">:</span>     <span class="n">Do</span> <span class="ow">not</span> <span class="n">write</span> <span class="n">time</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">remdtraj</span><span class="p">:</span>   <span class="n">Write</span> <span class="n">temperature</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">time0</span><span class="p">:</span>      <span class="n">Time</span> <span class="k">for</span> <span class="n">first</span> <span class="n">frame</span> <span class="p">(</span><span class="n">default</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">dt</span><span class="p">:</span>         <span class="n">Time</span> <span class="n">step</span> <span class="k">for</span> <span class="n">subsequent</span> <span class="n">frames</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">time0</span><span class="o">+</span><span class="n">frame</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span> <span class="p">(</span><span class="n">default</span> <span class="mf">1.0</span><span class="p">)</span><span class="s">&quot;);</span>
<span class="n">keepext</span>     <span class="n">Keep</span> <span class="n">filename</span> <span class="n">extension</span><span class="p">;</span> <span class="n">write</span> <span class="s">&#39;&lt;name&gt;.&lt;num&gt;.&lt;ext&gt;&#39;</span> <span class="n">instead</span> <span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">myfile</span><span class="o">.</span><span class="mf">1.</span><span class="n">rst7</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to mol2 format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">single</span>   <span class="p">:</span> <span class="n">Write</span> <span class="n">to</span> <span class="n">a</span> <span class="n">single</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">multi</span>    <span class="p">:</span> <span class="n">Write</span> <span class="n">each</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">sybyltype</span><span class="p">:</span> <span class="n">Convert</span> <span class="n">Amber</span> <span class="n">atom</span> <span class="n">types</span> <span class="p">(</span><span class="k">if</span> <span class="n">present</span><span class="p">)</span> <span class="n">to</span> <span class="n">SYBYL</span> <span class="n">types</span><span class="o">.</span><span class="s">&quot;);</span>
</pre></div>
</div>
<p>&#8216;options&#8217;  for other formats:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">please</span> <span class="n">check</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ambermd</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">doc12</span><span class="o">/</span><span class="n">Amber15</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.read_pickle">
<code class="descclassname">pytraj.</code><code class="descname">read_pickle</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.read_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pickled pandas object (or any other pickled object) from the specified
file path</p>
<p>Warning: Loading pickled data received from untrusted sources can be
unsafe. See: <a class="reference external" href="http://docs.python.org/2.7/library/pickle.html">http://docs.python.org/2.7/library/pickle.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>unpickled</strong> : type of object stored in file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.read_json">
<code class="descclassname">pytraj.</code><code class="descname">read_json</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.read_json" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>dict</strong> : python dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.to_pickle">
<code class="descclassname">pytraj.</code><code class="descname">to_pickle</code><span class="sig-paren">(</span><em>obj</em>, <em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickle (serialize) object to input file path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>obj</strong> : any object</p>
<p><strong>path</strong> : string</p>
<blockquote class="last">
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.to_json">
<code class="descclassname">pytraj.</code><code class="descname">to_json</code><span class="sig-paren">(</span><em>obj</em>, <em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.to_json" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>obj</strong> : any object</p>
<p><strong>path</strong> : string</p>
<blockquote class="last">
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.acorr">
<code class="descclassname">pytraj.</code><code class="descname">acorr</code><span class="sig-paren">(</span><em>data</em>, <em>dtype='ndarray'</em>, <em>option=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.acorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute autocorrelation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : 1d array-like</p>
<p><strong>dtype: return type, default &#8216;ndarray&#8217;</strong></p>
<p><strong>covar</strong> : bool, default True</p>
<p><strong>option</strong> : str</p>
<blockquote class="last">
<div><p>more cpptraj options</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Same as <cite>autocorr</cite> in cpptraj</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.bfactors">
<code class="descclassname">pytraj.</code><code class="descname">bfactors</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>byres=True</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.bfactors" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate pseudo bfactor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj: Trajectory-like</strong></p>
<p><strong>mask: str, mask</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">if dtype is &#8216;ndarray&#8217; (default), return a numpy array</p>
<p class="last">with shape=(n_atoms/n_residues, 2) ([atom_or_residue_idx, value])</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This is <strong>NOT</strong> getting bfactor from xray, but computing bfactor from simulation.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!:WAT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bfactor</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_bfactors</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">byres</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.align_principal_axis">
<code class="descclassname">pytraj.</code><code class="descname">align_principal_axis</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask='*'</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>mass=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.align_principal_axis" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p>apply for mutatble traj (Trajectory, Frame)</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.mindist">
<code class="descclassname">pytraj.</code><code class="descname">mindist</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.mindist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute mindist</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mindist</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA @H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rmsd_nofit">
<code class="descclassname">pytraj.</code><code class="descname">rmsd_nofit</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>mass=False</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rmsd_nofit" title="Permalink to this definition">¶</a></dt>
<dd><p>compute rmsd without fitting (translating and rotating)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str</p>
<p><strong>ref</strong> : Frame or int</p>
<p><strong>mass</strong> : bool, default False</p>
<blockquote>
<div><p>if True, use mass-weighted</p>
</div></blockquote>
<p><strong>frame_indices</strong> : 1D array-like, default None</p>
<blockquote class="last">
<div><p>if given, only perform calculation for those frames</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method is equal to pytraj.rmsd(traj, mask, ref, nofit=True, ...)</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.scale">
<code class="descclassname">pytraj.</code><code class="descname">scale</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.scale" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load to mutable trajectory by `load` method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do transform traj and return itself</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA x 1.2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.randomize_ions">
<code class="descclassname">pytraj.</code><code class="descname">randomize_ions</code><span class="sig-paren">(</span><em>traj</em>, <em>mask</em>, <em>around</em>, <em>by</em>, <em>overlap</em>, <em>seed=1</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.randomize_ions" title="Permalink to this definition">¶</a></dt>
<dd><p>randomize_ions for given Frame with Topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or a Frame</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">traj</span></code> must be mutable</p>
</div></blockquote>
<p><strong>mask</strong> : str</p>
<blockquote>
<div><p>cpptraj command</p>
</div></blockquote>
<p><strong>frame_indices</strong> : {None, array-like}, optional</p>
<p class="last"><strong>top</strong> : Topology, optional (only needed if <code class="docutils literal"><span class="pre">traj</span></code> does not have it)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">randomize_ions</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@Na+&#39;</span><span class="p">,</span> <span class="n">around</span><span class="o">=</span><span class="s">&#39;:1-16&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">113698</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.radgyr">
<code class="descclassname">pytraj.</code><code class="descname">radgyr</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>nomax=True</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.radgyr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute radius of gyration</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!:WAT&#39;</span><span class="p">,</span> <span class="n">nomax</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.search_neighbors">
<code class="descclassname">pytraj.</code><code class="descname">search_neighbors</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='dataset'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.search_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>search neighbors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><span class="xref std std-ref">pytraj.DatasetList</span>, is a list of atom index arrays for each frame.</p>
<p class="last">Those arrays might not have the same lenghth</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">search_neighbors</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:5&lt;@5.0&#39;</span><span class="p">)</span> <span class="c"># around residue 5 with 5.0 cutoff</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.set_dihedral">
<code class="descclassname">pytraj.</code><code class="descname">set_dihedral</code><span class="sig-paren">(</span><em>traj</em>, <em>resid='1'</em>, <em>dihedral_type=None</em>, <em>deg=0</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.set_dihedral" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">updated traj</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># make mutable traj by loading all frames to disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">set_dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resid</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="n">dihedral_type</span><span class="o">=</span><span class="s">&#39;phi&#39;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">set_dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resid</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dihedral_type</span><span class="o">=</span><span class="s">&#39;phi&#39;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.jcoupling">
<code class="descclassname">pytraj.</code><code class="descname">jcoupling</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>kfile=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.jcoupling" title="Permalink to this definition">¶</a></dt>
<dd><p>compute j-coupling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : any things that make <cite>frame_iter_master</cite> returning Frame object</p>
<p><strong>command</strong> : str, default &#8220;&#8221;</p>
<blockquote>
<div><p>cpptraj&#8217;s command/mask</p>
</div></blockquote>
<p><strong>kfile</strong> : str, default None, optional</p>
<blockquote>
<div><p>Dir for Karplus file. If &#8220;None&#8221;, use $AMBERHOME dir</p>
</div></blockquote>
<p class="last"><strong>dtype</strong> : str, {&#8216;dataset&#8217;, ...}, default &#8216;dataset&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_jcoupling</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1-12&#39;</span><span class="p">,</span> <span class="n">kfile</span><span class="o">=</span><span class="s">&#39;data/Karplus.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pairwise_distance">
<code class="descclassname">pytraj.</code><code class="descname">pairwise_distance</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask_1=''</em>, <em>mask_2=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pairwise_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>compute pairwise distance between atoms in mask_1 and atoms in mask_2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask_1: string or 1D array-like</strong></p>
<p><strong>mask_2: string or 1D array-like</strong></p>
<p><strong>...</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_1</strong> : numpy array, shape (n_frames, n_atom_1, n_atom_2)</p>
<p class="last"><strong>out_2</strong> : atom pairs, shape=(n_atom_1, n_atom_2, 2)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method is only fast for small number of atoms.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_pairwise_distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="s">&#39;@CB&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.transform">
<code class="descclassname">pytraj.</code><code class="descname">transform</code><span class="sig-paren">(</span><em>traj</em>, <em>by</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform pytraj.Trajectory by a series of cpptraj&#8217;s commands</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Mutable Trajectory</p>
<p><strong>by</strong> : list of cpptraj commands</p>
<p><strong>frame_indices</strong> : {None, array-like}, default None</p>
<blockquote>
<div><p>if not None, perform tranformation for specific frames.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">transformed Trajectory. Trajectory&#8217;s coordinates will be inplace-updated</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># perform &#39;autoimage&#39;, then &#39;rms&#39;, then &#39;center&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">traj</span><span class="p">[:],</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;autoimage&#39;</span><span class="p">,</span> <span class="s">&#39;rms&#39;</span><span class="p">,</span> <span class="s">&#39;center :1-5&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.timecorr">
<code class="descclassname">pytraj.</code><code class="descname">timecorr</code><span class="sig-paren">(</span><em>vec0</em>, <em>vec1</em>, <em>order=2</em>, <em>tstep=1.0</em>, <em>tcorr=10000.0</em>, <em>norm=False</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.timecorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute time correlation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>vec0</strong> : 2D array-like, shape=(n_frames, 3)</p>
<p><strong>vec1</strong> : 2D array-like, shape=(n_frames, 3)</p>
<p><strong>order</strong> : int, default 2</p>
<p><strong>tstep</strong> : float, default 1.</p>
<p><strong>tcorr</strong> : float, default 10000.</p>
<p class="last"><strong>norm</strong> : bool, default False</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.closest">
<code class="descclassname">pytraj.</code><code class="descname">closest</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask='*'</em>, <em>solvent_mask=None</em>, <em>n_solvents=10</em>, <em>frame_indices=None</em>, <em>dtype='iterator'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.closest" title="Permalink to this definition">¶</a></dt>
<dd><p>return either a new Trajectory or a frame iterator. Keep only <code class="docutils literal"><span class="pre">n_solvents</span></code> closest to mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like | list of Trajectory-like/frames | frame iterator | chunk iterator</p>
<p><strong>mask: str, default &#8216;*&#8217; (all solute atoms)</strong></p>
<p><strong>top</strong> : Topology-like object, default=None, optional</p>
<p><strong>dtype</strong> : {&#8216;iterator&#8217;, &#8216;trajectory&#8217;}, default &#8216;iterator&#8217;</p>
<blockquote>
<div><p>if &#8216;iterator&#8217;, return a tuple of Frame iterator and new Toplogy. &#8216;iterator&#8217; is good for streaming large trajectory.
if &#8216;trajectory&#8217;, return a new Trajectory.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>out</strong> : (check above)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># obtain new traj, keeping only closest 100 waters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># to residues 1 to 13 (index starts from 1) by distance to the first atom of water</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">n_solvents</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.atomicfluct">
<code class="descclassname">pytraj.</code><code class="descname">atomicfluct</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.atomicfluct" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">atomicfluct</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">array([[  5.        ,   0.61822273],</span>
<span class="go">       [ 16.        ,   0.5627449 ],</span>
<span class="go">       [ 40.        ,   0.53717119]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.autoimage">
<code class="descclassname">pytraj.</code><code class="descname">autoimage</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.autoimage" title="Permalink to this definition">¶</a></dt>
<dd><p>perform autoimage and return the coordinate-updated traj</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">autoimage</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.volume">
<code class="descclassname">pytraj.</code><code class="descname">volume</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>compute volume</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_volume</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.get_velocity">
<code class="descclassname">pytraj.</code><code class="descname">get_velocity</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.get_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>get velocity for specify frames with given mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask</strong> : str, default None (use all atoms), optional</p>
<blockquote>
<div><p>atom mask</p>
</div></blockquote>
<p><strong>frame_indices</strong> : iterable that produces integer, default None, optional</p>
<blockquote class="last">
<div><p>if not None, only get velocity for given frame indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Since pytraj has limited support for force and velocity info, if user wants to
load both from disk, should iterate the TrajectoryIterator (got by pytraj.iterload method)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytraj</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="n">forces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">velocities</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">topology_filename</span><span class="p">)</span>

<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
    <span class="n">forces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">force</span><span class="p">)</span>
    <span class="n">velocities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>

<span class="c"># Note: pytraj can efficiently load arbitary frame indices to memory</span>
<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]):</span> <span class="k">pass</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vels</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">get_velocity</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.diffusion">
<code class="descclassname">pytraj.</code><code class="descname">diffusion</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>tstep=1.0</em>, <em>individual=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>compute diffusion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterator</p>
<p><strong>mask</strong> : str, default &#8216;&#8217; (all atoms)</p>
<p><strong>tstep</strong> : float, time step between frames, default 1.0 ps</p>
<p><strong>individual</strong> : bool, default False</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : str, default &#8216;dataset&#8217;</p>
<p class="last"><strong>frame_indices</strong> : array or None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">diffusion</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span>
<span class="go">array([ 0.        ,  0.87027302,  1.64626022,  2.26262651,  2.98068114,</span>
<span class="go">        3.57075535,  4.07030655,  4.71894512,  5.42302306,  6.01310377])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.translate">
<code class="descclassname">pytraj.</code><code class="descname">translate</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>translate coordinate</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load to mutable trajectory by `load` method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do transform traj and return itself</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA x 120.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rdf">
<code class="descclassname">pytraj.</code><code class="descname">rdf</code><span class="sig-paren">(</span><em>traj=None</em>, <em>solvent_mask=':WAT&#64;O'</em>, <em>solute_mask=''</em>, <em>maximum=10.0</em>, <em>bin_spacing=0.5</em>, <em>image=True</em>, <em>density=0.033456</em>, <em>volume=False</em>, <em>center_solvent=False</em>, <em>center_solute=False</em>, <em>intramol=True</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rdf" title="Permalink to this definition">¶</a></dt>
<dd><p>compute radial distribtion function. Doc was adapted lightly from cpptraj doc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, require</p>
<p><strong>solvent_mask</strong> : solvent mask, default None, required</p>
<p><strong>bin_spacing</strong> : float, default 0.5, optional</p>
<blockquote>
<div><p>bin spacing</p>
</div></blockquote>
<p><strong>maximum</strong> : float, default 10., optional</p>
<blockquote>
<div><p>max bin value</p>
</div></blockquote>
<p><strong>solute_mask: str, default None, optional</strong></p>
<blockquote>
<div><p>if specified, calculate RDF of all atoms in solvent_mask to each atom in solute_mask</p>
</div></blockquote>
<p><strong>image</strong> : bool, default True, optional</p>
<blockquote>
<div><p>if False, do not image distance</p>
</div></blockquote>
<p><strong>density</strong> : float, default 0.033456 molecules / A^3, optional</p>
<p><strong>volume</strong> : determine density for normalization from average volume of input frames</p>
<p><strong>center_solvent</strong> : bool, default False, optional</p>
<blockquote>
<div><p>if True, calculate RDF from geometric center of atoms in solvent_mask to all atoms in solute_mask</p>
</div></blockquote>
<p><strong>center_solute</strong> : bool, default False, optional</p>
<blockquote>
<div><p>if True, calculate RDF from geometric center of atoms in solute_mask to all atoms in solvent_mask</p>
</div></blockquote>
<p><strong>intramol</strong> : bool, default True, optional</p>
<blockquote>
<div><p>if False, ignore intra-molecular distances</p>
</div></blockquote>
<p><strong>frame_indices</strong> : array-like, default None, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a tuple of bin_centers, rdf values</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>install <code class="docutils literal"><span class="pre">pytraj</span></code> and <code class="docutils literal"><span class="pre">libcpptraj</span></code> with openmp to speed up calculation</li>
<li>do not use this method with pytraj.pmap</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rdf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solvent_mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">bin_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.25,  0.75,  1.25, ...,  8.75,  9.25,  9.75])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([ 0.        ,  0.        ,  0.        , ...,  0.95620052,</span>
<span class="go">        0.95267934,  0.95135242])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use array-like mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rdf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solvent_mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">bin_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="n">atom_indices</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.molsurf">
<code class="descclassname">pytraj.</code><code class="descname">molsurf</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>probe=1.4</em>, <em>offset=0.0</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.molsurf" title="Permalink to this definition">¶</a></dt>
<dd><p>calc molsurf</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">molsurf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="go">array([ 458.51409637,  459.64784573,  456.54690793,  467.72939574,</span>
<span class="go">        462.45908781,  458.70327554,  454.40514806,  455.15015576,</span>
<span class="go">        468.70566447,  456.0058624 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">molsurf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!:WAT&#39;</span><span class="p">)</span>
<span class="go">array([ 1079.1395679 ,  1090.79759341,  1069.65127413,  1096.0810919 ,</span>
<span class="go">        1091.65862234,  1091.68906298,  1085.53105392,  1069.22510187,</span>
<span class="go">        1079.70803583,  1075.8151414 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.distance_rmsd">
<code class="descclassname">pytraj.</code><code class="descname">distance_rmsd</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.distance_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance rmsd between traj and reference</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterator that produces Frame</p>
<p><strong>ref</strong> : {int, Frame}, default 0 (1st Frame)</p>
<p><strong>mask</strong> : str</p>
<p><strong>top</strong> : Topology or str, optional, default None</p>
<p><strong>dtype</strong> : return dtype, default &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">1D ndarray if dtype is &#8216;ndarray&#8217; (default)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># compute distance_rmsd to last frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute distance_rmsd to first frame with mask = &#39;@CA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.get_average_frame">
<code class="descclassname">pytraj.</code><code class="descname">get_average_frame</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='frame'</em>, <em>autoimage=False</em>, <em>rmsfit=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.get_average_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>get mean structure for a given mask and given frame_indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask</strong> : None or str, default None (all atoms)</p>
<p><strong>frame_indices</strong> : iterable that produces integer, default None, optional</p>
<blockquote>
<div><p>frame indices</p>
</div></blockquote>
<p><strong>dtype: str, {&#8216;frame&#8217;, &#8216;traj&#8217;}, default &#8216;frame&#8217;</strong></p>
<blockquote>
<div><p>return type, either Frame (does not have Topology information) or &#8216;traj&#8217;</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote>
<div><p>if True, performa autoimage</p>
</div></blockquote>
<p><strong>rmsfit</strong> : object, {Frame, int, tuple, None}, default None</p>
<blockquote class="last">
<div><p>if rmsfit is not None, perform rms fit to reference.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if autoimage=True and having rmsfit, perform autoimage first and do rmsfit</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from whole traj, all atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from several frames, &#39;@CA&#39; atoms&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.superpose">
<code class="descclassname">pytraj.</code><code class="descname">superpose</code><span class="sig-paren">(</span><em>traj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.superpose" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.center_of_mass">
<code class="descclassname">pytraj.</code><code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>compute center of mass</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># compute center of mass residue 3 for first 2 frames.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">calc_center_of_mass</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">stop</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="s">&#39;:3&#39;</span><span class="p">)</span>
<span class="go">array([[-0.661702  ,  6.69124347,  3.35159413],</span>
<span class="go">       [ 0.5620708 ,  7.82263042, -0.72707798]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.watershell">
<code class="descclassname">pytraj.</code><code class="descname">watershell</code><span class="sig-paren">(</span><em>traj=None</em>, <em>solute_mask=''</em>, <em>solvent_mask=':WAT'</em>, <em>lower=3.4</em>, <em>upper=5.0</em>, <em>image=True</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.watershell" title="Permalink to this definition">¶</a></dt>
<dd><p>(adapted from cpptraj doc): Calculate numbers of waters in 1st and 2nd solvation shells
(defined by &lt;lower cut&gt; (default 3.4 Ang.) and &lt;upper cut&gt; (default 5.0 Ang.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>solute_mask: solute mask</strong></p>
<p><strong>solvent_mask: solvent mask</strong></p>
<p><strong>lower</strong> : double, default 3.4</p>
<blockquote>
<div><p>lower cut distance</p>
</div></blockquote>
<p><strong>upper</strong> : double, default 5.0</p>
<blockquote>
<div><p>upper cut distance</p>
</div></blockquote>
<p><strong>image</strong> : bool, defaul True</p>
<blockquote>
<div><p>do autoimage if True</p>
</div></blockquote>
<p><strong>dtype</strong> : return type, defaul &#8216;dataset&#8217;</p>
<p class="last"><strong>top</strong> : Topology, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">watershell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="s">&#39;!:WAT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">watershell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="s">&#39;!:WAT&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.xcorr">
<code class="descclassname">pytraj.</code><code class="descname">xcorr</code><span class="sig-paren">(</span><em>data0</em>, <em>data1</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.xcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute cross correlation between two datasets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data0 and data1: 1D-array like</strong></p>
<p class="last"><strong>dtype</strong> : return datatype, default &#8216;ndarray&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Same as <cite>corr</cite> in cpptraj</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.angle">
<code class="descclassname">pytraj.</code><code class="descname">angle</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>compute angle between two maskes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, list of Trajectory, list of Frames</p>
<p><strong>mask</strong> : str or array</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : return type, defaul &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1D ndarray if mask is a string</p>
<p class="last">2D ndarray, shape (n_atom_pairs, n_frames) if mask is a list of strings or an array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle for three atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1 @3 @10&#39;</span><span class="p">)</span>
<span class="go">array([  98.06193365,   95.75979717,  105.59626997,  107.64079091,</span>
<span class="go">         94.93516228,  102.06028369,  109.3479057 ,  110.11532478,</span>
<span class="go">        101.86104127,  110.48992512])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle for three groups of atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1,37,8 @2,4,6 @5,20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle between three residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1 :10 :20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate multiple angles between three residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># angle between residue 1, 10, 20, angle between residue 3, 20, 30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (when using atom string mask, index starts from 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;:1 :10 :20&#39;</span><span class="p">,</span> <span class="s">&#39;:3 :20 :30&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle for a series of atoms, using array for atom mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># angle between atom 1, 5, 8, distance between atom 4, 10, 20 (index starts from 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.atomiccorr">
<code class="descclassname">pytraj.</code><code class="descname">atomiccorr</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>cut=None</em>, <em>min_spacing=None</em>, <em>byres=True</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.atomiccorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute average correlations between the motion of atoms in mask.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : atom mask</p>
<p><strong>cut</strong> : {None, float}, default None</p>
<blockquote>
<div><p>if not None, only print correlations with absolute value greater than cut</p>
</div></blockquote>
<p><strong>min_spacing</strong> : {None, float}, default None</p>
<blockquote>
<div><p>if not None, only calculate correlations for motion vectors spaced min_spacing apart</p>
</div></blockquote>
<p><strong>byres</strong> : bool, default False</p>
<blockquote class="last">
<div><p>if False, compute atomic motion vetor
if True, Calculate motion vectors for entire residues (selected atoms in residues only).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.check_structure">
<code class="descclassname">pytraj.</code><code class="descname">check_structure</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>options=''</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.check_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>check if the structure is ok or not</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask: str, default all atoms</strong></p>
<p><strong>options</strong> : str, default &#8216;&#8217;</p>
<blockquote>
<div><p>extra cpptraj options</p>
</div></blockquote>
<p><strong>dtype</strong> : str, default &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : 1D-array</p>
<blockquote class="last">
<div><p>number of problems for each frame</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_rna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">failures</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">check_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.lowestcurve">
<code class="descclassname">pytraj.</code><code class="descname">lowestcurve</code><span class="sig-paren">(</span><em>data</em>, <em>points=10</em>, <em>step=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.lowestcurve" title="Permalink to this definition">¶</a></dt>
<dd><p>compute lowest curve for data</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.rmsd_perres">
<code class="descclassname">pytraj.</code><code class="descname">rmsd_perres</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>mass=False</em>, <em>resrange=None</em>, <em>perres_mask=None</em>, <em>perres_center=False</em>, <em>perres_invert=False</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rmsd_perres" title="Permalink to this definition">¶</a></dt>
<dd><p>superpose <code class="docutils literal"><span class="pre">traj</span></code> to <code class="docutils literal"><span class="pre">ref</span></code> with <cite>mask</cite>, then calculate nofit rms for residues
in <cite>resrange</cite> with given <cite>perresmask</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : pytraj.DatasetList, shape=(1+n_residues, n_frames)</p>
<blockquote class="last">
<div><p>out[0]: regular rmsd
out[1:]: perres rmsd for all given residues
<cite>out.values</cite> will return corresponding numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.dihedral">
<code class="descclassname">pytraj.</code><code class="descname">dihedral</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>compute dihedral angle between two maskes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, list of Trajectory, list of Frames</p>
<p><strong>mask</strong> : str or array</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : return type, defaul &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1D ndarray if mask is a string</p>
<p class="last">2D ndarray, shape (n_atom_pairs, n_frames) if mask is a list of strings or an array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for four atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1 @3 @10 @20&#39;</span><span class="p">)</span>
<span class="go">array([ 23.32244362,  23.5386922 ,  14.26831569,  14.58865946,</span>
<span class="go">        23.98675475,  26.18419185,   6.06982926,  13.57158505,</span>
<span class="go">        16.59013076,  29.99131573])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for four groups of atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1,37,8 @2,4,6 @5,20 @21,22&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for four residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1 :10 :20 :22&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate multiple dihedral angles for four residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># angle for residue 1, 10, 20, 30; angle between residue 3, 20, 30, 40</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (when using atom string mask, index starts from 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;:1 :10 :20 :30&#39;</span><span class="p">,</span> <span class="s">&#39;:3 :20 :30 :40&#39;</span><span class="p">])</span>
<span class="go">array([[-166.81829116, -160.19029669, -158.56560062, ..., -169.10064772,</span>
<span class="go">        -158.81655586, -165.28873555],</span>
<span class="go">       [  -0.60994639,    0.78261235,    1.86394369, ...,    1.21170489,</span>
<span class="go">          -1.16762607,   -3.08412049]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for a series of atoms, using array for atom mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># dihedral angle for atom 1, 5, 8, 10, dihedral for atom 4, 10, 20, 30 (index starts from 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.volmap">
<code class="descclassname">pytraj.</code><code class="descname">volmap</code><span class="sig-paren">(</span><em>traj</em>, <em>mask</em>, <em>grid_spacing</em>, <em>size=None</em>, <em>center=None</em>, <em>buffer=3.0</em>, <em>centermask='*'</em>, <em>radscale=1.36</em>, <em>peakcut=0.05</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.volmap" title="Permalink to this definition">¶</a></dt>
<dd><p>(combined with cpptraj doc) Grid data as a volumetric map, similar to the
volmap command in VMD. The density is calculated by treating each atom as a
3-dimensional Gaussian function whose standard deviation is equal to the van der Waals radius</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mask</strong> : {str, array-like}, default all atoms</p>
<blockquote>
<div><p>the atom selection from which to calculate the number density</p>
</div></blockquote>
<p><strong>grid_spacing</strong> : tuple, grid spacing in X-, Y-, Z-dimensions, require</p>
<p><strong>size</strong> : {None, tuple}, default None</p>
<blockquote>
<div><p>if tuple, size must have length of 3</p>
</div></blockquote>
<p><strong>center</strong> : {None, tuple}, default None</p>
<blockquote>
<div><p>if not None, center is tuple of (x, y, z) of center point</p>
</div></blockquote>
<p><strong>buffer</strong> : float, default 3.0 Angstrom</p>
<blockquote>
<div><p>buffer distance (Angstrom), by which the edges of the grid should clear every atom
of the centermask (or default mask if centermask is omitted) in every direction.
The buffer is ignored if the center and size are specified.</p>
</div></blockquote>
<p><strong>centermask</strong> : str</p>
<p><strong>radscale</strong> : float, default 1.36 (to match to VMD calculation)</p>
<blockquote>
<div><p>factor by which to scale radii (by devision)</p>
</div></blockquote>
<p class="last"><strong>peakcut</strong> : float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load all frames to memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do fitting and centering before perform volmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">mask</span><span class="o">=</span><span class="s">&#39;:1-13&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="s">&#39;:1-13 mass origin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">volmap</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">grid_spacing</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">buffer</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">centermask</span><span class="o">=</span><span class="s">&#39;!:1-13&#39;</span><span class="p">,</span> <span class="n">radscale</span><span class="o">=</span><span class="mf">1.36</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rotation_matrix">
<code class="descclassname">pytraj.</code><code class="descname">rotation_matrix</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>mass=False</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>with_rmsd=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute rotation matrix with/without rmsd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>ref</strong> : {int, Frame}, default 0 (first Frame)</p>
<blockquote>
<div><p>reference</p>
</div></blockquote>
<p><strong>mask</strong> : str, default all atoms</p>
<p><strong>mass</strong> : bool, default False</p>
<blockquote>
<div><p>if True, rmsfit with mass</p>
</div></blockquote>
<p><strong>frame_indices</strong> : {None, array-like}</p>
<blockquote>
<div><p>if not None, compute for given indices</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>with_rmsd</strong> : bool, default False</p>
<blockquote>
<div><ul class="simple">
<li>if False, return only rotation matrix.</li>
<li>if True, return rotation matrix and rmsd values</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : if with_rmsd=False, return numpy array, shape (n_frames, 3, 3)</p>
<blockquote class="last">
<div><p>if with_rmsd=True, return a tuple (mat, rmsd)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_rotation_matrix</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(101, 3, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rotate">
<code class="descclassname">pytraj.</code><code class="descname">rotate</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p><code class="docutils literal"><span class="pre">rotate</span></code> is an alias of <code class="docutils literal"><span class="pre">do_rotation</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load to mutable trajectory by `load` method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do transform traj and return itself</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;x 90&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rmsd">
<code class="descclassname">pytraj.</code><code class="descname">rmsd</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>ref_mask=''</em>, <em>nofit=False</em>, <em>mass=False</em>, <em>update_coordinate=True</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>compute rmsd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str or 1D array-like of string or 1D or 2D array-like</p>
<blockquote>
<div><p>Atom mask/indices</p>
</div></blockquote>
<p><strong>ref</strong> : {Frame, int}, default=0 (first frame)</p>
<blockquote>
<div><p>Reference frame or index.</p>
</div></blockquote>
<p><strong>ref_mask: str, optional</strong></p>
<blockquote>
<div><p>if given, use it instead of <cite>mask</cite></p>
</div></blockquote>
<p><strong>nofit</strong> : bool, default False</p>
<blockquote>
<div><p>if False, perform fitting (rotation and translation).
if <code class="docutils literal"><span class="pre">traj</span></code> is mutable, its coordinates will be updated
if True, not fitting.</p>
</div></blockquote>
<p><strong>mass</strong> : bool, default False</p>
<blockquote>
<div><p>if True, include mass</p>
</div></blockquote>
<p><strong>update_coordinate</strong> : bool, default True</p>
<blockquote>
<div><p>if True, coordinates will be updated. But this only apply to mutable Trajectory
if False (same as <cite>nomod</cite> in cpptraj), no modification</p>
</div></blockquote>
<p><strong>frame_indices</strong> : int 1D array-like, default None</p>
<blockquote>
<div><p>if not None, only compute rmsd for given frame indices</p>
</div></blockquote>
<p><strong>top</strong> : {Topology, str}, default None, optional</p>
<p class="last"><strong>dtype</strong> : return data type, default=&#8217;ndarray&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if <code class="docutils literal"><span class="pre">traj</span></code> is mutable and update_coordinate=True, its coordinates will be updated.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_trpcage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># all atoms, do fitting, using ref=traj[-3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># rmsd for 3 maskes, do fitting, using ref=traj[0] (defaul)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="s">&#39;@C&#39;</span><span class="p">,</span> <span class="s">&#39;:3-18@CA&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># rmsd to first frame, use mass &#39;:3-13&#39; but do not perorm fitting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;:3-13&#39;</span><span class="p">,</span> <span class="n">nofit</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use atom indices for mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span> <span class="n">nofit</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute rmsd (and align) with reference having different atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trpcage_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_trpcage</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tz2_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()[:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">trpcage_traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@1-10&#39;</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">tz2_traj</span><span class="p">,</span> <span class="n">ref_mask</span><span class="o">=</span><span class="s">&#39;@11-20&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">array([ 2.16203842,  2.28859396,  2.15817654, ...,  2.20767189,</span>
<span class="go">        2.30087764,  1.92654945])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.make_structure">
<code class="descclassname">pytraj.</code><code class="descname">make_structure</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.make_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.mean_structure">
<code class="descclassname">pytraj.</code><code class="descname">mean_structure</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='frame'</em>, <em>autoimage=False</em>, <em>rmsfit=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.mean_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>get mean structure for a given mask and given frame_indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask</strong> : None or str, default None (all atoms)</p>
<p><strong>frame_indices</strong> : iterable that produces integer, default None, optional</p>
<blockquote>
<div><p>frame indices</p>
</div></blockquote>
<p><strong>dtype: str, {&#8216;frame&#8217;, &#8216;traj&#8217;}, default &#8216;frame&#8217;</strong></p>
<blockquote>
<div><p>return type, either Frame (does not have Topology information) or &#8216;traj&#8217;</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote>
<div><p>if True, performa autoimage</p>
</div></blockquote>
<p><strong>rmsfit</strong> : object, {Frame, int, tuple, None}, default None</p>
<blockquote class="last">
<div><p>if rmsfit is not None, perform rms fit to reference.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if autoimage=True and having rmsfit, perform autoimage first and do rmsfit</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from whole traj, all atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from several frames, &#39;@CA&#39; atoms&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.center_of_geometry">
<code class="descclassname">pytraj.</code><code class="descname">center_of_geometry</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.replicate_cell">
<code class="descclassname">pytraj.</code><code class="descname">replicate_cell</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>direction='all'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.replicate_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>create a trajectory where the unit cell is replicated in 1 or more direction (up to 27)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or Frame iterator</p>
<p><strong>mask</strong> : str, default: &#8220;&#8221;</p>
<blockquote>
<div><p>if default, using all atoms
else: given mask</p>
</div></blockquote>
<p><strong>direction: {&#8216;all&#8217;, &#8216;dir&#8217;} or list/tuple of &lt;XYZ&gt; (below)</strong></p>
<blockquote>
<div><p>if &#8216;all&#8217;, replicate cell once in all possible directions
if &#8216;dir&#8217;, need to specify the direction with format &#8216;dir &lt;XYZ&gt;&#8217;, where each X (Y, Z)
is either 0, 1 or -1 (see example below)</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default: None</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>traj</strong> : pytraj.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;dir 001 dir 111&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;dir 001 dir 1-10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;dir 001 dir 1-10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># similiar usage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;001&#39;</span><span class="p">,</span> <span class="s">&#39;0-10&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;001&#39;</span><span class="p">,</span> <span class="s">&#39;0-10&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.strip">
<code class="descclassname">pytraj.</code><code class="descname">strip</code><span class="sig-paren">(</span><em>obj</em>, <em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>return a new Trajectory or FrameIterator or Topology with given mask.</p>
<p class="rubric">Notes</p>
<p>This method is trying to be smart. If you give it an in-memory Trajectory, it will
return a corresponding in-memory Trajectory. If you give it an out-of-memory TrajectoryIterator,
it will give you a corresponding FrameIterator object (out-of-memory). If you give it a Topology, it will
return a new stripped Topology.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">5293</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;!@CA&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># raise ValueError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">object must be either Trajectory or Topology</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.multivector">
<code class="descclassname">pytraj.</code><code class="descname">multivector</code><span class="sig-paren">(</span><em>traj</em>, <em>resrange</em>, <em>names</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.multivector" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>resrange</strong> : str, residue range</p>
<p><strong>names</strong> : {str, tuple of str}</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : str, default &#8216;dataset&#8217;</p>
<p class="last"><strong>frame_indices</strong> : {None, 1D array-like}, optional, default None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multivector</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1-5&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multivector</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1-5&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s">&#39;C N&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.surf">
<code class="descclassname">pytraj.</code><code class="descname">surf</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.surf" title="Permalink to this definition">¶</a></dt>
<dd><p>calc surf (LCPO method)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">surf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.distance">
<code class="descclassname">pytraj.</code><code class="descname">distance</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em>, <em>image=False</em>, <em>n_frames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance between two maskes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, list of Trajectory, list of Frames</p>
<p><strong>mask</strong> : str or a list of string or a 2D array-like of integers</p>
<p><strong>frame_indices</strong> : array-like, optional, default None</p>
<p><strong>dtype</strong> : return type, default &#8216;ndarray&#8217;</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>image</strong> : bool, default False</p>
<p><strong>n_frames</strong> : int, optional, default None</p>
<blockquote>
<div><p>only need to provide n_frames if <code class="docutils literal"><span class="pre">traj</span></code> does not have this info</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1D ndarray if mask is a string</p>
<p class="last">2D ndarray, shape (n_atom_pairs, n_frames) if mask is a list of strings or an array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Be careful with Topology. If your topology has Box info but your traj does not, you
would get weird output ([0.0, ...]). Make sure to use <cite>image=False</cite> in this method or
set_nobox for Topology.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance for two atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1 @3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance for two groups of atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1,37,8 @2,4,6&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance between two residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1 :10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate multiple distances between two residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># distance between residue 1 and 10, distance between residue 3 and 20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (when using atom string mask, index starts from 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;:1 :10&#39;</span><span class="p">,</span> <span class="s">&#39;:3 :20&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance for a series of atoms, using array for atom mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># distance between atom 1 and 5, distance between atom 4 and 10 (index starts from 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.multidihedral">
<code class="descclassname">pytraj.</code><code class="descname">multidihedral</code><span class="sig-paren">(</span><em>traj=None</em>, <em>dhtypes=None</em>, <em>resrange=None</em>, <em>define_new_type=None</em>, <em>range360=False</em>, <em>dtype='dataset'</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.multidihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>perform dihedral search</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like object</p>
<p><strong>dhtypes</strong> : dihedral type, default None</p>
<blockquote>
<div><p>if None, calculate all supported dihedrals</p>
</div></blockquote>
<p><strong>resrange</strong> : str | array-like</p>
<blockquote>
<div><p>residue range for searching. If <cite>resrange</cite> is string, use index starting with 1
(cpptraj convertion)
if <cite>resrange</cite> is array-like, use index starting from 0 (python convention)</p>
</div></blockquote>
<p><strong>define_new_type</strong> : str</p>
<blockquote>
<div><p>define new type for searching</p>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>if True: use 0-360</p>
</div></blockquote>
<p><strong>top</strong> : Topology | str, optional</p>
<blockquote>
<div><p>only need to have &#8216;top&#8217; if can not find it in <cite>traj</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.DatasetList (use <cite>values</cite> attribute to get raw <cite>numpy</cite> array)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Dataset lables show residue number in 1-based index</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;phi psi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1,3,5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;3-7&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pairdist">
<code class="descclassname">pytraj.</code><code class="descname">pairdist</code><span class="sig-paren">(</span><em>traj</em>, <em>mask='*'</em>, <em>mask2=''</em>, <em>delta=0.1</em>, <em>dtype='ndarray'</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pairdist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute pair distribution function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str, default all atoms</p>
<p><strong>delta</strong> : float, default 0.1</p>
<p><strong>dtype</strong> : str, default &#8216;ndarray&#8217;</p>
<blockquote>
<div><p>dtype of return data</p>
</div></blockquote>
<p class="last"><strong>top</strong> : Topology, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_pairdist</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pairwise_rmsd">
<code class="descclassname">pytraj.</code><code class="descname">pairwise_rmsd</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>metric='rms'</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>mat_type='full'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pairwise_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate pairwise rmsd with different metrics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable object</p>
<p><strong>mask</strong> : mask</p>
<blockquote>
<div><p>if mask is &#8220;&#8221;, use all atoms</p>
</div></blockquote>
<p><strong>metric</strong> : {&#8216;rms&#8217;, &#8216;dme&#8217;, &#8216;srmsd&#8217;, &#8216;nofit&#8217;}</p>
<blockquote>
<div><p>if &#8216;rms&#8217;, perform rms fit
if &#8216;dme&#8217;, use distance RMSD
if &#8216;srmsd&#8217;, use symmetry-corrected RMSD
if &#8216;nofit&#8217;, perform rmsd without fitting</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default=None</p>
<p><strong>dtype: ndarray</strong></p>
<blockquote>
<div><p>return type</p>
</div></blockquote>
<p><strong>mat_type</strong> : str, {&#8216;full&#8217;, &#8216;half&#8217;}</p>
<blockquote class="last">
<div><p>if &#8216;full&#8217;: return 2D array, shape=(n_frames, n_frames)
if &#8216;half&#8217;: return 1D array, shape=(n_frames*(n_frames-1)/2, )</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Install <code class="docutils literal"><span class="pre">libcpptraj</span></code> with <code class="docutils literal"><span class="pre">openmp</span></code> to get benefit from parallel</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate pairwise rmsd for all frames using CA atoms, use `dme` (distance RMSD)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># convert to numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;dme&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;ndarray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate pairwise rmsd for all frames using CA atoms, nofit for RMSD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># convert to numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;nofit&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;ndarray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate pairwise rmsd for all frames using CA atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># use symmetry-corrected RMSD, convert to numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;srmsd&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;ndarray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use different dtype</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;srmsd&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pca">
<code class="descclassname">pytraj.</code><code class="descname">pca</code><span class="sig-paren">(</span><em>traj</em>, <em>mask</em>, <em>n_vecs=2</em>, <em>fit=True</em>, <em>ref=None</em>, <em>ref_mask=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>perform PCA analysis by following below steps:</p>
<ul class="simple">
<li>(optional) perform rmsfit to reference if needed</li>
<li>compute covariance matrix</li>
<li>diagonalize the matrix to get eigenvectors and eigenvalues</li>
<li>perform projection of each frame with mask to each eigenvector</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>traj must be <code class="docutils literal"><span class="pre">pytraj.Trajectory</span></code>, which can be created by <code class="docutils literal"><span class="pre">pytraj.load</span></code> method.</p>
</div></blockquote>
<p><strong>mask</strong> : str</p>
<blockquote>
<div><p>atom mask for covariance matrix and projection</p>
</div></blockquote>
<p><strong>n_vecs</strong> : int, default 2</p>
<blockquote>
<div><p>number of eigenvectors. If user want to compute projection for all eigenvectors,
should specify n_vecs=-1 (or a negative number)</p>
</div></blockquote>
<p><strong>fit</strong> : bool, default True</p>
<blockquote>
<div><p>if True, perform fitting before compute covariance matrix
if False, no fitting (keep rotation and translation). In this case, <cite>pytraj</cite> will ignore <cite>ref</cite> argument.</p>
</div></blockquote>
<p><strong>ref</strong> : {None, Frame, int}, default None</p>
<blockquote>
<div><p>if None, trajectory will be superposed to average structure
if is Frame or integer value, trajectory will be superposed to given reference</p>
</div></blockquote>
<p><strong>ref_mask</strong> : {None, str}, default None (use <cite>mask</cite>)</p>
<blockquote>
<div><p>if None, use <cite>mask</cite> for fitting
if str, use this given mask for fitting</p>
</div></blockquote>
<p><strong>dtype</strong> : return datatype</p>
<p><strong>top</strong> : Topology, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">out1: projection_data, ndarray with shape=(n_vecs, n_frames)</p>
<p class="last">out2: tuple of (eigenvalues, eigenvectors)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()[:]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute pca for first and second modes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">n_vecs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get projection values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
<span class="go">array([[  4.93425131,  13.80002308,  20.61605835, ..., -57.92280579,</span>
<span class="go">        -61.25728607, -52.85142136],</span>
<span class="go">       [  4.03333616,  -6.9132452 , -14.53991318, ...,  -6.757936  ,</span>
<span class="go">          2.1086719 ,  -3.60922861]], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get eigenvalues for first 2 modes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
<span class="go">array([ 1399.36472919,   240.42342439])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute pca for all modes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">n_vecs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># does not perform fitting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># provide different mask for fitting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref_mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.projection">
<code class="descclassname">pytraj.</code><code class="descname">projection</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>eigenvalues=None</em>, <em>eigenvectors=None</em>, <em>scalar_type='covar'</em>, <em>average_coords=None</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>compute projection along given eigenvectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : atom mask, either string or array-like</p>
<p><strong>eigenvalues</strong> : 1D array-like</p>
<p><strong>eigenvectors</strong> : 2D array-like</p>
<p><strong>scalar_type</strong> : str, {&#8216;covar&#8217;, &#8216;mwcovar&#8217;, }, default &#8216;covar&#8217;</p>
<blockquote>
<div><p>make sure to provide correct scalar_type.
Note: not yet support &#8216;dihcovar&#8217; and &#8216;idea&#8217;</p>
</div></blockquote>
<p><strong>average_coords</strong> : 3D array-like, optional, default None</p>
<blockquote>
<div><p>average coordinates. If &#8216;None&#8217;, pytraj will compute mean_structure with given mask</p>
</div></blockquote>
<p><strong>frame_indices</strong> : array-like</p>
<blockquote>
<div><p>If not None, compute projection for given frames.</p>
</div></blockquote>
<p><strong>dtype</strong> : str, return data type, default &#8216;ndarray&#8217;</p>
<p><strong>top</strong> : Topology, optional, default None</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>projection_data</strong> : ndarray, shape=(n_vecs, n_frames)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">covar</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># since we compute covariance matrix, we need to specify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># scalar_type = &#39;covar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scalar_type</span> <span class="o">=</span> <span class="s">&#39;covar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="o">=</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="o">=</span><span class="n">eigenvectors</span><span class="p">,</span> <span class="n">scalar_type</span><span class="o">=</span><span class="n">scalar_type</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 101)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pucker">
<code class="descclassname">pytraj.</code><code class="descname">pucker</code><span class="sig-paren">(</span><em>traj=None</em>, <em>pucker_mask=(&quot;C1'&quot;</em>, <em>&quot;C2'&quot;</em>, <em>&quot;C3'&quot;</em>, <em>&quot;C4'&quot;</em>, <em>&quot;O4'&quot;)</em>, <em>resrange=None</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>range360=False</em>, <em>method='altona'</em>, <em>use_com=True</em>, <em>amplitude=False</em>, <em>offset=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pucker" title="Permalink to this definition">¶</a></dt>
<dd><p>compute pucker</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>pucker_mask</strong> : str</p>
<p><strong>resrange</strong> : None or array of int</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : str, return type</p>
<p><strong>range360: bool, use 360 or 180 scale</strong></p>
<p><strong>method</strong> : {&#8216;altona&#8217;, &#8216;cremer&#8217;}, default &#8216;altona&#8217;</p>
<p><strong>use_com</strong> : bool</p>
<p><strong>amplitude</strong> : bool, default False</p>
<p><strong>offset</strong> : None or float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dataset</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.principal_axes">
<code class="descclassname">pytraj.</code><code class="descname">principal_axes</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask='*'</em>, <em>dorotation=False</em>, <em>mass=True</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.principal_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>compute principal axes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str, default &#8216;*&#8217; (all atoms)</p>
<p><strong>mass: bool, defaul True</strong></p>
<p><strong>if `dorotation`, the system will be aligned along principal axes (apply for mutable system)</strong></p>
<p><strong>top</strong> : Topology, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_0</strong> : numpy array, shape=(n_frames, 3, 3)</p>
<p class="last">out_1: numpy array with shape=(n_frames, 3)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.native_contacts">
<code class="descclassname">pytraj.</code><code class="descname">native_contacts</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>mask2=''</em>, <em>ref=0</em>, <em>dtype='dataset'</em>, <em>distance=7.0</em>, <em>image=True</em>, <em>include_solvent=False</em>, <em>byres=False</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.native_contacts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute native contacts</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># use 1st frame as reference, don&#39;t need specify ref Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">native_contacts</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># explicitly specify reference, specify distance cutoff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">native_contacts</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use integer array for mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">native_contacts</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">mask2</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.dispatch">
<code class="descclassname">pytraj.</code><code class="descname">dispatch</code><span class="sig-paren">(</span><em>type cls</em>, <em>CpptrajState state</em>, <em>line</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.dispatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.iterchunk">
<code class="descclassname">pytraj.</code><code class="descname">iterchunk</code><span class="sig-paren">(</span><em>traj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterchunk" title="Permalink to this definition">¶</a></dt>
<dd><p>iterate <code class="docutils literal"><span class="pre">traj</span></code> by chunk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : TrajectoryIterator</p>
<p><strong>chunksize</strong> : int</p>
<blockquote>
<div><p>the number of frames in each chunk</p>
</div></blockquote>
<p><strong>start</strong> : int, default 0</p>
<blockquote>
<div><p>start frame to iterate</p>
</div></blockquote>
<p><strong>start</strong> : int, default -1 (last frame)</p>
<blockquote>
<div><p>stop frame</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote class="last">
<div><p>if True, do autoimage for chunk</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.TrajectoryIterator.iterchunk</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.iterframe">
<code class="descclassname">pytraj.</code><code class="descname">iterframe</code><span class="sig-paren">(</span><em>traj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterframe" title="Permalink to this definition">¶</a></dt>
<dd><p>create frame iterator with given indices, mask or some iter_options</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.TrajectoryIterator.iterframe</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
</pre></div>
</div>
<p># create frame iterator for given indices
&gt;&gt;&gt; for frame in pt.iterframe(traj, frame_indices=[0, 7, 3]): print(frame)
&lt;Frame with 5293 atoms&gt;
&lt;Frame with 5293 atoms&gt;
&lt;Frame with 5293 atoms&gt;</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># iterframe its self</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.select">
<code class="descclassname">pytraj.</code><code class="descname">select</code><span class="sig-paren">(</span><em>mask</em>, <em>topology</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.select" title="Permalink to this definition">¶</a></dt>
<dd><p>return atom indices</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.set_cpptraj_verbose">
<code class="descclassname">pytraj.</code><code class="descname">set_cpptraj_verbose</code><span class="sig-paren">(</span><em>cm=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.set_cpptraj_verbose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.show_versions">
<code class="descclassname">pytraj.</code><code class="descname">show_versions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.show_versions" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">show_versions</span><span class="p">()</span> 
</pre></div>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, pytraj developers.<br/>
      Last updated on Apr 24, 2016.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>