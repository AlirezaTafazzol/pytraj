
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pytraj &mdash; pytraj 1.0.5.dev0+e7e77e5 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.5.dev0+e7e77e5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="pytraj 1.0.5.dev0+e7e77e5 documentation" href="../index.html" />
    <link rel="up" title="API" href="index.html" />
    <link rel="prev" title="API" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          pytraj</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.5.dev0+e7e77e5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html">Trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../read_and_write.html">Read and Write</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modify_traj.html">Modify trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atom_mask_selection.html">Atom mask selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_slice.html">Fancy indexing of trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel.html">Parallel calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What&#8217;s new?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">Developer guide for pytraj</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda.html">Use conda to manage different Python versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_viewer.html">Trajectory Viewer</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pytraj</a><ul>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: API"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; API</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/_api/pytraj.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="pytraj">
<h1>pytraj<a class="headerlink" href="#pytraj" title="Permalink to this headline">¶</a></h1>
<div class="custom-index container">
<script type="text/javascript" src='../_static/cindex.js'></script></div>
<span class="target" id="module-pytraj"></span><p>pytraj</p>
<dl class="function">
<dt id="pytraj.load">
<code class="descclassname">pytraj.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>mask=None</em>, <em>stride=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load" title="Permalink to this definition">¶</a></dt>
<dd><p>try loading and returning appropriate values. See example below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, Trajectory filename</p>
<p><strong>top</strong> : Topology filename or a Topology</p>
<p><strong>frame_indices</strong> : {None, array_like}, default None</p>
<blockquote>
<div><p>only load frames with given number given in frame_indices</p>
</div></blockquote>
<p><strong>stride</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if given, frame will be skip every <cite>stride</cite>.
Note: if bot frame_indices and stride are given, <cite>frame_indices</cite> will be ignored.</p>
</div></blockquote>
<p><strong>mask</strong> : {str, None}, default None</p>
<blockquote>
<div><p>if None: load coordinates for all atoms
if string, load coordinates for given atom mask</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.iterload" title="pytraj.iterload"><code class="xref py py-obj docutils literal"><span class="pre">iterload</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li>For further slicing options, see pytraj.TrajectoryIterator (created by <code class="docutils literal"><span class="pre">pytraj.iterload</span></code>)</li>
<li>Also see <cite>pytraj.iterload</cite> for loading a series of trajectories that don&#8217;t fit to
memory</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load netcdf file with given amber parm file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load mol2 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;traj.mol2&#39;</span><span class="p">)</span> <span class="c"># </span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load pdb file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;traj.pdb&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load given frame numbers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2_dry&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!@H=&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with frame slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># which is equal to:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with stride</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">21</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with stride for more than one filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">223</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load with stride for more than one filename, and with mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.iterload">
<code class="descclassname">pytraj.</code><code class="descname">iterload</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterload" title="Permalink to this definition">¶</a></dt>
<dd><p>return TrajectoryIterator object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: {str, list-like of filenames, pattern}</strong></p>
<blockquote>
<div><p>input trajectory filename(s). You can use a single filename, a list of filenames
or a pattern.</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}</p>
<blockquote>
<div><p>input topology. If str, pytraj will load from disk to Topology first</p>
</div></blockquote>
<p><strong>frame_slice: tuple or list of tuple</strong></p>
<blockquote>
<div><p>specify start, stop, step for each trajectory you want to read.</p>
<p>cpptraj input:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">trajin</span> <span class="n">traj0</span><span class="o">.</span><span class="n">nc</span> <span class="mi">1</span> <span class="mi">10</span>
<span class="n">trajin</span> <span class="n">traj1</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>In pytraj, corresponding frame_slice=[(0, 10), (0, -1)]</p>
</div></blockquote>
<p><strong>stride</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if not None, trajectories will be strided.
Note: if both stride and frame_slice are not None, frame_slice will be ignored</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.TrajectoryIterator</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Unlike <cite>pytraj.load</cite>, you can not arbitarily set <cite>frame_indices</cite>. If you want to do
so, first load trajectories to TrajectoryIterator object, then do fancy slicing</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># register to load traj.nc from 0-th to 99-th frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s">&#39;prmtop&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)])</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do fancy indexing to load specific frames to memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load to disk with given mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s">&#39;!@H=&#39;</span><span class="p">]</span> 
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">,</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from a list of filenames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load all files with a given pattern (sorted)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;./traj*.nc&#39;</span><span class="p">,</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from a list of files with given frame step</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># for each file, only register to load from frame 0 to 9 (skip 10), skip every 2 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from frame 0 to 9 for `traj0.nc`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load all frames from `traj1.nc`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;traj0.nc&#39;</span><span class="p">,</span> <span class="s">&#39;traj1.nc&#39;</span><span class="p">],</span> <span class="s">&#39;2koc.parm7&#39;</span><span class="p">,</span> <span class="n">frame_slice</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span> 
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use stride, skip every 2 frames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_remd_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filenames</span><span class="p">,</span> <span class="n">topology_filename</span> <span class="o">=</span> <span class="n">get_remd_fn</span><span class="p">(</span><span class="s">&#39;remd_ala2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]</span>
<span class="go">[&#39;rem.nc.000&#39;, &#39;rem.nc.001&#39;, &#39;rem.nc.002&#39;, &#39;rem.nc.003&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">topology_filename</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_remd">
<code class="descclassname">pytraj.</code><code class="descname">load_remd</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>T='300.0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_remd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.iterload_remd">
<code class="descclassname">pytraj.</code><code class="descname">iterload_remd</code><span class="sig-paren">(</span><em>filename</em>, <em>top=None</em>, <em>T='300.0'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterload_remd" title="Permalink to this definition">¶</a></dt>
<dd><p>Load temperature remd trajectory for single temperature.
Example: Suppose you have replica trajectoris remd.x.00{1-4}.
You want to load and extract only frames at 300 K, use this method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>top</strong> : {str, Topology}</p>
<p><strong>T</strong> : {float, str}, default=300.0</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.traj.TrajectoryCpptraj</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_pdb_rcsb">
<code class="descclassname">pytraj.</code><code class="descname">load_pdb_rcsb</code><span class="sig-paren">(</span><em>pdbid</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_pdb_rcsb" title="Permalink to this definition">¶</a></dt>
<dd><p>load pdb file from rcsb website</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pdbid</strong> : str</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>io.loadpdb_rcsb(&#8220;2KOC&#8221;) # popular RNA hairpin</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_cpptraj_file">
<code class="descclassname">pytraj.</code><code class="descname">load_cpptraj_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_cpptraj_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str, name of cpptraj input file</p>
<blockquote class="last">
<div><p>(&#8220;cpptraj -i input.txt&#8221; &#8211;&gt; fname = &#8220;input.txt&#8221;)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_sample_data">
<code class="descclassname">pytraj.</code><code class="descname">load_sample_data</code><span class="sig-paren">(</span><em>data_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_sample_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return TrajectoryIterator instance for Ala3 or tz2 data</p>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>tz2 dataset</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">$AMBERHOME/AmberTools/test/cpptraj/</span><dd>explicit water, ortho box</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_ParmEd">
<code class="descclassname">pytraj.</code><code class="descname">load_ParmEd</code><span class="sig-paren">(</span><em>parmed_obj</em>, <em>as_traj=False</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_ParmEd" title="Permalink to this definition">¶</a></dt>
<dd><p>return pytraj&#8217;s Topology or Trajectory objects</p>
<p>parmed_obj : ParmEd&#8217;s Structure object
as_traj: bool, default False</p>
<blockquote>
<div>if True, return pytraj.trajectory.Trajectory
if False, return Topology</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">parmed</span> <span class="k">as</span> <span class="nn">pmd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">download_PDB</span><span class="p">(</span><span class="s">&quot;1l2y&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_ParmEd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.load_topology">
<code class="descclassname">pytraj.</code><code class="descname">load_topology</code><span class="sig-paren">(</span><em>filename</em>, <em>option=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.load_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>load Topology from a filename or from url or from ParmEd object. Adapted from cpptraj doc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, Amber prmtop, pdb, mol2, psf, cif, gromacs topology, sdf, tinker formats</p>
<p><strong>option</strong> : cpptraj options.</p>
<blockquote class="last">
<div><p>if filename is a pdb file, option = {&#8216;pqr&#8217;, &#8216;noconnect&#8217;}.</p>
<ul class="simple">
<li>pqr     : Read atomic charge/radius from occupancy/B-factor columns.</li>
<li>noconect: Do not read CONECT records if present.</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if cpptraj/pytraj does not support specific file format, you still can convert to PDB
file. cpptraj will do the bond guess based on distance.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># from a filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s">&quot;data/tz2.ortho.parm7&quot;</span><span class="p">)</span>
<span class="go">&lt;Topology: 5293 atoms, 1704 residues, 1692 mols, PBC with box type = ortho&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># read with option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s">&#39;1KX5.pdb&#39;</span><span class="p">,</span> <span class="s">&#39;bondsearch 0.2&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.write_parm">
<code class="descclassname">pytraj.</code><code class="descname">write_parm</code><span class="sig-paren">(</span><em>filename=None</em>, <em>top=None</em>, <em>format='amberparm'</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.write_parm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.save">
<code class="descclassname">pytraj.</code><code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>obj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.save" title="Permalink to this definition">¶</a></dt>
<dd><p>an universal method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : output filename</p>
<p><strong>obj</strong> : Topology or Trajetory-like</p>
<blockquote>
<div><p>if Topology, write a new Topology to disk
if Trajetory-like, write a trajectory to disk</p>
</div></blockquote>
<p class="last"><strong>*args, **kwd: additional options</strong></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../read_and_write.html#pytraj.write_traj" title="pytraj.write_traj"><code class="xref py py-obj docutils literal"><span class="pre">write_traj</span></code></a>, <a class="reference internal" href="#pytraj.write_parm" title="pytraj.write_parm"><code class="xref py py-obj docutils literal"><span class="pre">write_parm</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">Topology</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># save Topology to a new Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;output/prmtop&#39;</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="s">&#39;output/prmtop&#39;</span><span class="p">),</span> <span class="n">pt</span><span class="o">.</span><span class="n">Topology</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># save TrajectoryIterator to disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;output/traj.nc&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="s">&#39;output/traj.nc&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">),</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.write_traj">
<code class="descclassname">pytraj.</code><code class="descname">write_traj</code><span class="sig-paren">(</span><em>filename=''</em>, <em>traj=None</em>, <em>format='infer'</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>overwrite=False</em>, <em>options=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.write_traj" title="Permalink to this definition">¶</a></dt>
<dd><p>write Trajectory-like or iterable object to trajectory file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<p><strong>traj</strong> : Trajectory-like or iterator that produces Frame or 3D ndarray with shape=(n_frames, n_atoms, 3)</p>
<p><strong>format</strong> : str, default &#8216;infer&#8217;</p>
<blockquote>
<div><p>if &#8216;inter&#8217;, detect format based on extension. If can not detect, use amber mdcdf format.</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default: None</p>
<p><strong>frame_indices: array-like or iterator that produces integer, default: None</strong></p>
<blockquote>
<div><p>If not None, only write output for given frame indices</p>
</div></blockquote>
<p><strong>overwrite: bool, default: False</strong></p>
<p class="last"><strong>options</strong> : str, additional cpptraj keywords</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<table border="1" class="docutils">
<colgroup>
<col width="68%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Format</th>
<th class="head">Extension</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Amber Trajectory</td>
<td>.crd</td>
</tr>
<tr class="row-odd"><td>Amber NetCDF</td>
<td>.nc</td>
</tr>
<tr class="row-even"><td>Amber Restart</td>
<td>.rst7</td>
</tr>
<tr class="row-odd"><td>Amber NetCDF</td>
<td>.ncrst</td>
</tr>
<tr class="row-even"><td>Charmm DCD</td>
<td>.dcd</td>
</tr>
<tr class="row-odd"><td>PDB</td>
<td>.pdb</td>
</tr>
<tr class="row-even"><td>Mol2</td>
<td>.mol2</td>
</tr>
<tr class="row-odd"><td>Scripps</td>
<td>.binpos</td>
</tr>
<tr class="row-even"><td>Gromacs</td>
<td>.trr</td>
</tr>
<tr class="row-odd"><td>SQM Input</td>
<td>.sqm</td>
</tr>
</tbody>
</table>
<p>&#8216;options&#8217; for writing to pdb format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">dumpq</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">GB</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">parse</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">PARSE</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">vdw</span><span class="p">:</span>         <span class="n">Write</span> <span class="n">atom</span> <span class="n">charge</span><span class="o">/</span><span class="n">VDW</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">occupancy</span><span class="o">/</span><span class="n">B</span><span class="o">-</span><span class="n">factor</span> <span class="n">columns</span> <span class="p">(</span><span class="n">PQR</span> <span class="nb">format</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">pdbres</span><span class="p">:</span>      <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">residue</span> <span class="n">names</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">pdbatom</span><span class="p">:</span>     <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">atom</span> <span class="n">names</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">pdbv3</span><span class="p">:</span>       <span class="n">Use</span> <span class="n">PDB</span> <span class="n">V3</span> <span class="n">residue</span><span class="o">/</span><span class="n">atom</span> <span class="n">names</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">teradvance</span><span class="p">:</span>  <span class="n">Increment</span> <span class="n">record</span> <span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="c"># for TER records (default no).&quot;</span>
<span class="n">terbyres</span><span class="p">:</span>    <span class="n">Print</span> <span class="n">TER</span> <span class="n">cards</span> <span class="n">based</span> <span class="n">on</span> <span class="n">residue</span> <span class="n">sequence</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">molecules</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">model</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">to</span> <span class="n">single</span> <span class="n">file</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">MODEL</span> <span class="n">records</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">multi</span><span class="p">:</span>       <span class="n">Write</span> <span class="n">each</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">separate</span> <span class="n">files</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">chainid</span> <span class="o">&lt;</span><span class="n">c</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Write</span> <span class="n">character</span> <span class="s">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">chain</span> <span class="n">ID</span> <span class="n">column</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">sg</span> <span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="p">:</span>  <span class="n">Space</span> <span class="n">group</span> <span class="k">for</span> <span class="n">CRYST1</span> <span class="n">record</span><span class="p">,</span> <span class="n">only</span> <span class="k">if</span> <span class="n">box</span> <span class="n">coordinates</span> <span class="n">written</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">include_ep</span><span class="p">:</span>  <span class="n">Include</span> <span class="n">extra</span> <span class="n">points</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">conect</span><span class="p">:</span>      <span class="n">Write</span> <span class="n">CONECT</span> <span class="n">records</span> <span class="n">using</span> <span class="n">bond</span> <span class="n">information</span><span class="o">.</span><span class="s">&quot;);</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/t.nc&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span> <span class="c"># write to amber netcdf file</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write to multi pdb files (t.pdb.1, t.pdb.2, ...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/t.pdb&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s">&#39;multi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write all frames to single pdb file and each frame is seperated by &quot;MODEL&quot; word</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/t.pdb&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write to DCD file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test.dcd&quot;</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># write to netcdf file from 3D numpy array, need to provide Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test_xyz.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test_xyz.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># you can make a fake Topology to write xyz coordinates too</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_atoms</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">make_fake_topology</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">write_traj</span><span class="p">(</span><span class="s">&quot;output/test_xyz_fake_top.nc&quot;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top2</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to amber netcdf format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">remdtraj</span><span class="p">:</span> <span class="n">Write</span> <span class="n">temperature</span> <span class="n">to</span> <span class="n">trajectory</span> <span class="p">(</span><span class="n">makes</span> <span class="n">REMD</span> <span class="n">trajectory</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">velocity</span><span class="p">:</span> <span class="n">Write</span> <span class="n">velocities</span> <span class="n">to</span> <span class="n">trajectory</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">force</span><span class="p">:</span> <span class="n">Write</span> <span class="n">forces</span> <span class="n">to</span> <span class="n">trajectory</span><span class="o">.</span><span class="s">&quot;);</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to amber netcdf restart format(cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">novelocity</span><span class="p">:</span> <span class="n">Do</span> <span class="ow">not</span> <span class="n">write</span> <span class="n">velocities</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">notime</span><span class="p">:</span>     <span class="n">Do</span> <span class="ow">not</span> <span class="n">write</span> <span class="n">time</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">remdtraj</span><span class="p">:</span>   <span class="n">Write</span> <span class="n">temperature</span> <span class="n">to</span> <span class="n">restart</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">time0</span><span class="p">:</span>      <span class="n">Time</span> <span class="k">for</span> <span class="n">first</span> <span class="n">frame</span> <span class="p">(</span><span class="n">default</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">dt</span><span class="p">:</span>         <span class="n">Time</span> <span class="n">step</span> <span class="k">for</span> <span class="n">subsequent</span> <span class="n">frames</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">time0</span><span class="o">+</span><span class="n">frame</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span> <span class="p">(</span><span class="n">default</span> <span class="mf">1.0</span><span class="p">)</span><span class="s">&quot;);</span>
<span class="n">keepext</span>     <span class="n">Keep</span> <span class="n">filename</span> <span class="n">extension</span><span class="p">;</span> <span class="n">write</span> <span class="s">&#39;&lt;name&gt;.&lt;num&gt;.&lt;ext&gt;&#39;</span> <span class="n">instead</span> <span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="n">myfile</span><span class="o">.</span><span class="mf">1.</span><span class="n">rst7</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;options&#8217; for writing to mol2 format (cptraj manual):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">single</span>   <span class="p">:</span> <span class="n">Write</span> <span class="n">to</span> <span class="n">a</span> <span class="n">single</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">multi</span>    <span class="p">:</span> <span class="n">Write</span> <span class="n">each</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">file</span><span class="o">.</span><span class="s">&quot;</span>
<span class="n">sybyltype</span><span class="p">:</span> <span class="n">Convert</span> <span class="n">Amber</span> <span class="n">atom</span> <span class="n">types</span> <span class="p">(</span><span class="k">if</span> <span class="n">present</span><span class="p">)</span> <span class="n">to</span> <span class="n">SYBYL</span> <span class="n">types</span><span class="o">.</span><span class="s">&quot;);</span>
</pre></div>
</div>
<p>&#8216;options&#8217;  for other formats:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">please</span> <span class="n">check</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ambermd</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">doc12</span><span class="o">/</span><span class="n">Amber15</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.read_pickle">
<code class="descclassname">pytraj.</code><code class="descname">read_pickle</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.read_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pickled pandas object (or any other pickled object) from the specified
file path</p>
<p>Warning: Loading pickled data received from untrusted sources can be
unsafe. See: <a class="reference external" href="http://docs.python.org/2.7/library/pickle.html">http://docs.python.org/2.7/library/pickle.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>unpickled</strong> : type of object stored in file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.read_json">
<code class="descclassname">pytraj.</code><code class="descname">read_json</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.read_json" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>dict</strong> : python dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.to_pickle">
<code class="descclassname">pytraj.</code><code class="descname">to_pickle</code><span class="sig-paren">(</span><em>obj</em>, <em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickle (serialize) object to input file path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>obj</strong> : any object</p>
<p><strong>path</strong> : string</p>
<blockquote class="last">
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.to_json">
<code class="descclassname">pytraj.</code><code class="descname">to_json</code><span class="sig-paren">(</span><em>obj</em>, <em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.to_json" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>obj</strong> : any object</p>
<p><strong>path</strong> : string</p>
<blockquote class="last">
<div><p>File path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.multidihedral">
<code class="descclassname">pytraj.</code><code class="descname">multidihedral</code><span class="sig-paren">(</span><em>traj=None</em>, <em>dhtypes=None</em>, <em>resrange=None</em>, <em>define_new_type=None</em>, <em>range360=False</em>, <em>dtype='dataset'</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.multidihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>perform dihedral search</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like object</p>
<p><strong>dhtypes</strong> : dihedral type, default None</p>
<blockquote>
<div><p>if None, calculate all supported dihedrals</p>
</div></blockquote>
<p><strong>resrange</strong> : str | array-like</p>
<blockquote>
<div><p>residue range for searching. If <cite>resrange</cite> is string, use index starting with 1
(cpptraj convertion)
if <cite>resrange</cite> is array-like, use index starting from 0 (python convention)</p>
</div></blockquote>
<p><strong>define_new_type</strong> : str</p>
<blockquote>
<div><p>define new type for searching</p>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>if True: use 0-360</p>
</div></blockquote>
<p><strong>top</strong> : Topology | str, optional</p>
<blockquote>
<div><p>only need to have &#8216;top&#8217; if can not find it in <cite>traj</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.DatasetList (use <cite>values</cite> attribute to get raw <cite>numpy</cite> array)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Dataset lables show residue number in 1-based index</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;phi psi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1,3,5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;3-7&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.set_dihedral">
<code class="descclassname">pytraj.</code><code class="descname">set_dihedral</code><span class="sig-paren">(</span><em>traj</em>, <em>resid='1'</em>, <em>dihedral_type=None</em>, <em>deg=0</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.set_dihedral" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">updated traj</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># make mutable traj by loading all frames to disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">set_dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resid</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="n">dihedral_type</span><span class="o">=</span><span class="s">&#39;phi&#39;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">set_dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resid</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dihedral_type</span><span class="o">=</span><span class="s">&#39;phi&#39;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rdf">
<code class="descclassname">pytraj.</code><code class="descname">rdf</code><span class="sig-paren">(</span><em>traj=None</em>, <em>solvent_mask=':WAT&#64;O'</em>, <em>solute_mask=''</em>, <em>maximum=10.0</em>, <em>bin_spacing=0.5</em>, <em>image=True</em>, <em>density=0.033456</em>, <em>volume=False</em>, <em>center_solvent=False</em>, <em>center_solute=False</em>, <em>intramol=True</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rdf" title="Permalink to this definition">¶</a></dt>
<dd><p>compute radial distribtion function. Doc was adapted lightly from cpptraj doc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, require</p>
<p><strong>solvent_mask</strong> : solvent mask, default None, required</p>
<p><strong>bin_spacing</strong> : float, default 0.5, optional</p>
<blockquote>
<div><p>bin spacing</p>
</div></blockquote>
<p><strong>maximum</strong> : float, default 10., optional</p>
<blockquote>
<div><p>max bin value</p>
</div></blockquote>
<p><strong>solute_mask: str, default None, optional</strong></p>
<blockquote>
<div><p>if specified, calculate RDF of all atoms in solvent_mask to each atom in solute_mask</p>
</div></blockquote>
<p><strong>image</strong> : bool, default True, optional</p>
<blockquote>
<div><p>if False, do not image distance</p>
</div></blockquote>
<p><strong>density</strong> : float, default 0.033456 molecules / A^3, optional</p>
<p><strong>volume</strong> : determine density for normalization from average volume of input frames</p>
<p><strong>center_solvent</strong> : bool, default False, optional</p>
<blockquote>
<div><p>if True, calculate RDF from geometric center of atoms in solvent_mask to all atoms in solute_mask</p>
</div></blockquote>
<p><strong>center_solute</strong> : bool, default False, optional</p>
<blockquote>
<div><p>if True, calculate RDF from geometric center of atoms in solute_mask to all atoms in solvent_mask</p>
</div></blockquote>
<p><strong>intramol</strong> : bool, default True, optional</p>
<blockquote>
<div><p>if False, ignore intra-molecular distances</p>
</div></blockquote>
<p><strong>frame_indices</strong> : array-like, default None, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a tuple of bin_centers, rdf values</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>install <code class="docutils literal"><span class="pre">pytraj</span></code> and <code class="docutils literal"><span class="pre">libcpptraj</span></code> with openmp to speed up calculation</li>
<li>do not use this method with pytraj.pmap</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rdf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solvent_mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">bin_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0.25,  0.75,  1.25, ...,  8.75,  9.25,  9.75])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([ 0.        ,  0.        ,  0.        , ...,  0.95620052,</span>
<span class="go">        0.95267934,  0.95135242])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use array-like mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rdf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solvent_mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">bin_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="n">atom_indices</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.search_neighbors">
<code class="descclassname">pytraj.</code><code class="descname">search_neighbors</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='dataset'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.search_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>search neighbors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><span class="xref std std-ref">pytraj.DatasetList</span>, is a list of atom index arrays for each frame.</p>
<p class="last">Those arrays might not have the same lenghth</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">search_neighbors</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:5&lt;@5.0&#39;</span><span class="p">)</span> <span class="c"># around residue 5 with 5.0 cutoff</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.distance_rmsd">
<code class="descclassname">pytraj.</code><code class="descname">distance_rmsd</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.distance_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance rmsd between traj and reference</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterator that produces Frame</p>
<p><strong>ref</strong> : {int, Frame}, default 0 (1st Frame)</p>
<p><strong>mask</strong> : str</p>
<p><strong>top</strong> : Topology or str, optional, default None</p>
<p><strong>dtype</strong> : return dtype, default &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">1D ndarray if dtype is &#8216;ndarray&#8217; (default)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># compute distance_rmsd to last frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute distance_rmsd to first frame with mask = &#39;@CA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.superpose">
<code class="descclassname">pytraj.</code><code class="descname">superpose</code><span class="sig-paren">(</span><em>traj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.superpose" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.replicate_cell">
<code class="descclassname">pytraj.</code><code class="descname">replicate_cell</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>direction='all'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.replicate_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>create a trajectory where the unit cell is replicated in 1 or more direction (up to 27)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or Frame iterator</p>
<p><strong>mask</strong> : str, default: &#8220;&#8221;</p>
<blockquote>
<div><p>if default, using all atoms
else: given mask</p>
</div></blockquote>
<p><strong>direction: {&#8216;all&#8217;, &#8216;dir&#8217;} or list/tuple of &lt;XYZ&gt; (below)</strong></p>
<blockquote>
<div><p>if &#8216;all&#8217;, replicate cell once in all possible directions
if &#8216;dir&#8217;, need to specify the direction with format &#8216;dir &lt;XYZ&gt;&#8217;, where each X (Y, Z)
is either 0, 1 or -1 (see example below)</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default: None</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>traj</strong> : pytraj.Trajectory</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;dir 001 dir 111&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;dir 001 dir 1-10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&#39;dir 001 dir 1-10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># similiar usage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;001&#39;</span><span class="p">,</span> <span class="s">&#39;0-10&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">replicate_cell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;001&#39;</span><span class="p">,</span> <span class="s">&#39;0-10&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.angle">
<code class="descclassname">pytraj.</code><code class="descname">angle</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>compute angle between two maskes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, list of Trajectory, list of Frames</p>
<p><strong>mask</strong> : str or array</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : return type, defaul &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1D ndarray if mask is a string</p>
<p class="last">2D ndarray, shape (n_atom_pairs, n_frames) if mask is a list of strings or an array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle for three atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1 @3 @10&#39;</span><span class="p">)</span>
<span class="go">array([  98.06193365,   95.75979717,  105.59626997,  107.64079091,</span>
<span class="go">         94.93516228,  102.06028369,  109.3479057 ,  110.11532478,</span>
<span class="go">        101.86104127,  110.48992512])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle for three groups of atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1,37,8 @2,4,6 @5,20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle between three residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1 :10 :20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate multiple angles between three residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># angle between residue 1, 10, 20, angle between residue 3, 20, 30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (when using atom string mask, index starts from 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;:1 :10 :20&#39;</span><span class="p">,</span> <span class="s">&#39;:3 :20 :30&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate angle for a series of atoms, using array for atom mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># angle between atom 1, 5, 8, distance between atom 4, 10, 20 (index starts from 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.distance">
<code class="descclassname">pytraj.</code><code class="descname">distance</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em>, <em>image=False</em>, <em>n_frames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>compute distance between two maskes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, list of Trajectory, list of Frames</p>
<p><strong>mask</strong> : str or a list of string or a 2D array-like of integers</p>
<p><strong>frame_indices</strong> : array-like, optional, default None</p>
<p><strong>dtype</strong> : return type, default &#8216;ndarray&#8217;</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>image</strong> : bool, default False</p>
<p><strong>n_frames</strong> : int, optional, default None</p>
<blockquote>
<div><p>only need to provide n_frames if <code class="docutils literal"><span class="pre">traj</span></code> does not have this info</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1D ndarray if mask is a string</p>
<p class="last">2D ndarray, shape (n_atom_pairs, n_frames) if mask is a list of strings or an array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Be careful with Topology. If your topology has Box info but your traj does not, you
would get weird output ([0.0, ...]). Make sure to use <cite>image=False</cite> in this method or
set_nobox for Topology.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance for two atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1 @3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance for two groups of atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1,37,8 @2,4,6&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance between two residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1 :10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate multiple distances between two residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># distance between residue 1 and 10, distance between residue 3 and 20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (when using atom string mask, index starts from 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;:1 :10&#39;</span><span class="p">,</span> <span class="s">&#39;:3 :20&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate distance for a series of atoms, using array for atom mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># distance between atom 1 and 5, distance between atom 4 and 10 (index starts from 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.volume">
<code class="descclassname">pytraj.</code><code class="descname">volume</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>compute volume</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_volume</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rotation_matrix">
<code class="descclassname">pytraj.</code><code class="descname">rotation_matrix</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>mass=False</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>with_rmsd=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>compute rotation matrix with/without rmsd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>ref</strong> : {int, Frame}, default 0 (first Frame)</p>
<blockquote>
<div><p>reference</p>
</div></blockquote>
<p><strong>mask</strong> : str, default all atoms</p>
<p><strong>mass</strong> : bool, default False</p>
<blockquote>
<div><p>if True, rmsfit with mass</p>
</div></blockquote>
<p><strong>frame_indices</strong> : {None, array-like}</p>
<blockquote>
<div><p>if not None, compute for given indices</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>with_rmsd</strong> : bool, default False</p>
<blockquote>
<div><ul class="simple">
<li>if False, return only rotation matrix.</li>
<li>if True, return rotation matrix and rmsd values</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : if with_rmsd=False, return numpy array, shape (n_frames, 3, 3)</p>
<blockquote class="last">
<div><p>if with_rmsd=True, return a tuple (mat, rmsd)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_rotation_matrix</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(101, 3, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.projection">
<code class="descclassname">pytraj.</code><code class="descname">projection</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>eigenvalues=None</em>, <em>eigenvectors=None</em>, <em>scalar_type='covar'</em>, <em>average_coords=None</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>compute projection along given eigenvectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : atom mask, either string or array-like</p>
<p><strong>eigenvalues</strong> : 1D array-like</p>
<p><strong>eigenvectors</strong> : 2D array-like</p>
<p><strong>scalar_type</strong> : str, {&#8216;covar&#8217;, &#8216;mwcovar&#8217;, }, default &#8216;covar&#8217;</p>
<blockquote>
<div><p>make sure to provide correct scalar_type.
Note: not yet support &#8216;dihcovar&#8217; and &#8216;idea&#8217;</p>
</div></blockquote>
<p><strong>average_coords</strong> : 3D array-like, optional, default None</p>
<blockquote>
<div><p>average coordinates. If &#8216;None&#8217;, pytraj will compute mean_structure with given mask</p>
</div></blockquote>
<p><strong>frame_indices</strong> : array-like</p>
<blockquote>
<div><p>If not None, compute projection for given frames.</p>
</div></blockquote>
<p><strong>dtype</strong> : str, return data type, default &#8216;ndarray&#8217;</p>
<p><strong>top</strong> : Topology, optional, default None</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>projection_data</strong> : ndarray, shape=(n_vecs, n_frames)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">covar</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># since we compute covariance matrix, we need to specify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># scalar_type = &#39;covar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scalar_type</span> <span class="o">=</span> <span class="s">&#39;covar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="o">=</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="o">=</span><span class="n">eigenvectors</span><span class="p">,</span> <span class="n">scalar_type</span><span class="o">=</span><span class="n">scalar_type</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 101)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.principal_axes">
<code class="descclassname">pytraj.</code><code class="descname">principal_axes</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask='*'</em>, <em>dorotation=False</em>, <em>mass=True</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.principal_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>compute principal axes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str, default &#8216;*&#8217; (all atoms)</p>
<p><strong>mass: bool, defaul True</strong></p>
<p><strong>if `dorotation`, the system will be aligned along principal axes (apply for mutable system)</strong></p>
<p><strong>top</strong> : Topology, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_0</strong> : numpy array, shape=(n_frames, 3, 3)</p>
<p class="last">out_1: numpy array with shape=(n_frames, 3)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.grid">
<code class="descclassname">pytraj.</code><code class="descname">grid</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>top=None</em>, <em>dtype='dataset'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.multivector">
<code class="descclassname">pytraj.</code><code class="descname">multivector</code><span class="sig-paren">(</span><em>traj</em>, <em>resrange</em>, <em>names</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.multivector" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>resrange</strong> : str, residue range</p>
<p><strong>names</strong> : {str, tuple of str}</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : str, default &#8216;dataset&#8217;</p>
<p class="last"><strong>frame_indices</strong> : {None, 1D array-like}, optional, default None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multivector</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1-5&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multivector</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1-5&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s">&#39;C N&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.mindist">
<code class="descclassname">pytraj.</code><code class="descname">mindist</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.mindist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute mindist</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mindist</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA @H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.closest">
<code class="descclassname">pytraj.</code><code class="descname">closest</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask='*'</em>, <em>solvent_mask=None</em>, <em>n_solvents=10</em>, <em>frame_indices=None</em>, <em>dtype='iterator'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.closest" title="Permalink to this definition">¶</a></dt>
<dd><p>return either a new Trajectory or a frame iterator. Keep only <code class="docutils literal"><span class="pre">n_solvents</span></code> closest to mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like | list of Trajectory-like/frames | frame iterator | chunk iterator</p>
<p><strong>mask: str, default &#8216;*&#8217; (all solute atoms)</strong></p>
<p><strong>top</strong> : Topology-like object, default=None, optional</p>
<p><strong>dtype</strong> : {&#8216;iterator&#8217;, &#8216;trajectory&#8217;}, default &#8216;iterator&#8217;</p>
<blockquote>
<div><p>if &#8216;iterator&#8217;, return a tuple of Frame iterator and new Toplogy. &#8216;iterator&#8217; is good for streaming large trajectory.
if &#8216;trajectory&#8217;, return a new Trajectory.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>out</strong> : (check above)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># obtain new traj, keeping only closest 100 waters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># to residues 1 to 13 (index starts from 1) by distance to the first atom of water</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">n_solvents</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rotate">
<code class="descclassname">pytraj.</code><code class="descname">rotate</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p><code class="docutils literal"><span class="pre">rotate</span></code> is an alias of <code class="docutils literal"><span class="pre">do_rotation</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load to mutable trajectory by `load` method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do transform traj and return itself</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;x 90&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.center_of_geometry">
<code class="descclassname">pytraj.</code><code class="descname">center_of_geometry</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.volmap">
<code class="descclassname">pytraj.</code><code class="descname">volmap</code><span class="sig-paren">(</span><em>traj</em>, <em>mask</em>, <em>grid_spacing</em>, <em>size=None</em>, <em>center=None</em>, <em>buffer=3.0</em>, <em>centermask='*'</em>, <em>radscale=1.36</em>, <em>peakcut=0.05</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.volmap" title="Permalink to this definition">¶</a></dt>
<dd><p>(combined with cpptraj doc) Grid data as a volumetric map, similar to the
volmap command in VMD. The density is calculated by treating each atom as a
3-dimensional Gaussian function whose standard deviation is equal to the van der Waals radius</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mask</strong> : {str, array-like}, default all atoms</p>
<blockquote>
<div><p>the atom selection from which to calculate the number density</p>
</div></blockquote>
<p><strong>grid_spacing</strong> : tuple, grid spacing in X-, Y-, Z-dimensions, require</p>
<p><strong>size</strong> : {None, tuple}, default None</p>
<blockquote>
<div><p>if tuple, size must have length of 3</p>
</div></blockquote>
<p><strong>center</strong> : {None, tuple}, default None</p>
<blockquote>
<div><p>if not None, center is tuple of (x, y, z) of center point</p>
</div></blockquote>
<p><strong>buffer</strong> : float, default 3.0 Angstrom</p>
<blockquote>
<div><p>buffer distance (Angstrom), by which the edges of the grid should clear every atom
of the centermask (or default mask if centermask is omitted) in every direction.
The buffer is ignored if the center and size are specified.</p>
</div></blockquote>
<p><strong>centermask</strong> : str</p>
<p><strong>radscale</strong> : float, default 1.36 (to match to VMD calculation)</p>
<blockquote>
<div><p>factor by which to scale radii (by devision)</p>
</div></blockquote>
<p class="last"><strong>peakcut</strong> : float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load all frames to memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do fitting and centering before perform volmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">mask</span><span class="o">=</span><span class="s">&#39;:1-13&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="s">&#39;:1-13 mass origin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">volmap</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;:WAT@O&#39;</span><span class="p">,</span> <span class="n">grid_spacing</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">buffer</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">centermask</span><span class="o">=</span><span class="s">&#39;!:1-13&#39;</span><span class="p">,</span> <span class="n">radscale</span><span class="o">=</span><span class="mf">1.36</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.atomiccorr">
<code class="descclassname">pytraj.</code><code class="descname">atomiccorr</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>cut=None</em>, <em>min_spacing=None</em>, <em>byres=True</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.atomiccorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute average correlations between the motion of atoms in mask.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : atom mask</p>
<p><strong>cut</strong> : {None, float}, default None</p>
<blockquote>
<div><p>if not None, only print correlations with absolute value greater than cut</p>
</div></blockquote>
<p><strong>min_spacing</strong> : {None, float}, default None</p>
<blockquote>
<div><p>if not None, only calculate correlations for motion vectors spaced min_spacing apart</p>
</div></blockquote>
<p><strong>byres</strong> : bool, default False</p>
<blockquote class="last">
<div><p>if False, compute atomic motion vetor
if True, Calculate motion vectors for entire residues (selected atoms in residues only).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.strip">
<code class="descclassname">pytraj.</code><code class="descname">strip</code><span class="sig-paren">(</span><em>obj</em>, <em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>return a new Trajectory or FrameIterator or Topology with given mask.</p>
<p class="rubric">Notes</p>
<p>This method is trying to be smart. If you give it an in-memory Trajectory, it will
return a corresponding in-memory Trajectory. If you give it an out-of-memory TrajectoryIterator,
it will give you a corresponding FrameIterator object (out-of-memory). If you give it a Topology, it will
return a new stripped Topology.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">5293</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;!@CA&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="s">&#39;!@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># raise ValueError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">object must be either Trajectory or Topology</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.jcoupling">
<code class="descclassname">pytraj.</code><code class="descname">jcoupling</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>kfile=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.jcoupling" title="Permalink to this definition">¶</a></dt>
<dd><p>compute j-coupling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : any things that make <cite>frame_iter_master</cite> returning Frame object</p>
<p><strong>command</strong> : str, default &#8220;&#8221;</p>
<blockquote>
<div><p>cpptraj&#8217;s command/mask</p>
</div></blockquote>
<p><strong>kfile</strong> : str, default None, optional</p>
<blockquote>
<div><p>Dir for Karplus file. If &#8220;None&#8221;, use $AMBERHOME dir</p>
</div></blockquote>
<p class="last"><strong>dtype</strong> : str, {&#8216;dataset&#8217;, ...}, default &#8216;dataset&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_jcoupling</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1-12&#39;</span><span class="p">,</span> <span class="n">kfile</span><span class="o">=</span><span class="s">&#39;data/Karplus.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.autoimage">
<code class="descclassname">pytraj.</code><code class="descname">autoimage</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.autoimage" title="Permalink to this definition">¶</a></dt>
<dd><p>perform autoimage and return the coordinate-updated traj</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">autoimage</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.acorr">
<code class="descclassname">pytraj.</code><code class="descname">acorr</code><span class="sig-paren">(</span><em>data</em>, <em>dtype='ndarray'</em>, <em>option=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.acorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute autocorrelation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : 1d array-like</p>
<p><strong>dtype: return type, default &#8216;ndarray&#8217;</strong></p>
<p><strong>covar</strong> : bool, default True</p>
<p><strong>option</strong> : str</p>
<blockquote class="last">
<div><p>more cpptraj options</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Same as <cite>autocorr</cite> in cpptraj</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.dihedral">
<code class="descclassname">pytraj.</code><code class="descname">dihedral</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>compute dihedral angle between two maskes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like, list of Trajectory, list of Frames</p>
<p><strong>mask</strong> : str or array</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : return type, defaul &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1D ndarray if mask is a string</p>
<p class="last">2D ndarray, shape (n_atom_pairs, n_frames) if mask is a list of strings or an array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for four atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1 @3 @10 @20&#39;</span><span class="p">)</span>
<span class="go">array([ 23.32244362,  23.5386922 ,  14.26831569,  14.58865946,</span>
<span class="go">        23.98675475,  26.18419185,   6.06982926,  13.57158505,</span>
<span class="go">        16.59013076,  29.99131573])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for four groups of atoms, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@1,37,8 @2,4,6 @5,20 @21,22&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for four residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1 :10 :20 :22&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate multiple dihedral angles for four residues, using amber mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># angle for residue 1, 10, 20, 30; angle between residue 3, 20, 30, 40</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (when using atom string mask, index starts from 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;:1 :10 :20 :30&#39;</span><span class="p">,</span> <span class="s">&#39;:3 :20 :30 :40&#39;</span><span class="p">])</span>
<span class="go">array([[-166.81829116, -160.19029669, -158.56560062, ..., -169.10064772,</span>
<span class="go">        -158.81655586, -165.28873555],</span>
<span class="go">       [  -0.60994639,    0.78261235,    1.86394369, ...,    1.21170489,</span>
<span class="go">          -1.16762607,   -3.08412049]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate dihedral angle for a series of atoms, using array for atom mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># dihedral angle for atom 1, 5, 8, 10, dihedral for atom 4, 10, 20, 30 (index starts from 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">dihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.timecorr">
<code class="descclassname">pytraj.</code><code class="descname">timecorr</code><span class="sig-paren">(</span><em>vec0</em>, <em>vec1</em>, <em>order=2</em>, <em>tstep=1.0</em>, <em>tcorr=10000.0</em>, <em>norm=False</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.timecorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute time correlation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>vec0</strong> : 2D array-like, shape=(n_frames, 3)</p>
<p><strong>vec1</strong> : 2D array-like, shape=(n_frames, 3)</p>
<p><strong>order</strong> : int, default 2</p>
<p><strong>tstep</strong> : float, default 1.</p>
<p><strong>tcorr</strong> : float, default 10000.</p>
<p class="last"><strong>norm</strong> : bool, default False</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.randomize_ions">
<code class="descclassname">pytraj.</code><code class="descname">randomize_ions</code><span class="sig-paren">(</span><em>traj</em>, <em>mask</em>, <em>around</em>, <em>by</em>, <em>overlap</em>, <em>seed=1</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.randomize_ions" title="Permalink to this definition">¶</a></dt>
<dd><p>randomize_ions for given Frame with Topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or a Frame</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">traj</span></code> must be mutable</p>
</div></blockquote>
<p><strong>mask</strong> : str</p>
<blockquote>
<div><p>cpptraj command</p>
</div></blockquote>
<p><strong>frame_indices</strong> : {None, array-like}, optional</p>
<p class="last"><strong>top</strong> : Topology, optional (only needed if <code class="docutils literal"><span class="pre">traj</span></code> does not have it)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">randomize_ions</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@Na+&#39;</span><span class="p">,</span> <span class="n">around</span><span class="o">=</span><span class="s">&#39;:1-16&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">113698</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.native_contacts">
<code class="descclassname">pytraj.</code><code class="descname">native_contacts</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>mask2=''</em>, <em>ref=0</em>, <em>dtype='dataset'</em>, <em>distance=7.0</em>, <em>image=True</em>, <em>include_solvent=False</em>, <em>byres=False</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.native_contacts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute native contacts</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># use 1st frame as reference, don&#39;t need specify ref Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">native_contacts</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># explicitly specify reference, specify distance cutoff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">native_contacts</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use integer array for mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">native_contacts</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">mask2</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.scale">
<code class="descclassname">pytraj.</code><code class="descname">scale</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.scale" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load to mutable trajectory by `load` method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do transform traj and return itself</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA x 1.2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.center_of_mass">
<code class="descclassname">pytraj.</code><code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>compute center of mass</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># compute center of mass residue 3 for first 2 frames.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">calc_center_of_mass</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">stop</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="s">&#39;:3&#39;</span><span class="p">)</span>
<span class="go">array([[-0.661702  ,  6.69124347,  3.35159413],</span>
<span class="go">       [ 0.5620708 ,  7.82263042, -0.72707798]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.get_average_frame">
<code class="descclassname">pytraj.</code><code class="descname">get_average_frame</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='frame'</em>, <em>autoimage=False</em>, <em>rmsfit=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.get_average_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>get mean structure for a given mask and given frame_indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask</strong> : None or str, default None (all atoms)</p>
<p><strong>frame_indices</strong> : iterable that produces integer, default None, optional</p>
<blockquote>
<div><p>frame indices</p>
</div></blockquote>
<p><strong>dtype: str, {&#8216;frame&#8217;, &#8216;traj&#8217;}, default &#8216;frame&#8217;</strong></p>
<blockquote>
<div><p>return type, either Frame (does not have Topology information) or &#8216;traj&#8217;</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote>
<div><p>if True, performa autoimage</p>
</div></blockquote>
<p><strong>rmsfit</strong> : object, {Frame, int, tuple, None}, default None</p>
<blockquote class="last">
<div><p>if rmsfit is not None, perform rms fit to reference.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if autoimage=True and having rmsfit, perform autoimage first and do rmsfit</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from whole traj, all atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from several frames, &#39;@CA&#39; atoms&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.molsurf">
<code class="descclassname">pytraj.</code><code class="descname">molsurf</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>probe=1.4</em>, <em>offset=0.0</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.molsurf" title="Permalink to this definition">¶</a></dt>
<dd><p>calc molsurf</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">molsurf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="go">array([ 458.51409637,  459.64784573,  456.54690793,  467.72939574,</span>
<span class="go">        462.45908781,  458.70327554,  454.40514806,  455.15015576,</span>
<span class="go">        468.70566447,  456.0058624 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">molsurf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!:WAT&#39;</span><span class="p">)</span>
<span class="go">array([ 1079.1395679 ,  1090.79759341,  1069.65127413,  1096.0810919 ,</span>
<span class="go">        1091.65862234,  1091.68906298,  1085.53105392,  1069.22510187,</span>
<span class="go">        1079.70803583,  1075.8151414 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.atomicfluct">
<code class="descclassname">pytraj.</code><code class="descname">atomicfluct</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.atomicfluct" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">atomicfluct</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">array([[  5.        ,   0.61822273],</span>
<span class="go">       [ 16.        ,   0.5627449 ],</span>
<span class="go">       [ 40.        ,   0.53717119]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rmsd_nofit">
<code class="descclassname">pytraj.</code><code class="descname">rmsd_nofit</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>mass=False</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rmsd_nofit" title="Permalink to this definition">¶</a></dt>
<dd><p>compute rmsd without fitting (translating and rotating)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str</p>
<p><strong>ref</strong> : Frame or int</p>
<p><strong>mass</strong> : bool, default False</p>
<blockquote>
<div><p>if True, use mass-weighted</p>
</div></blockquote>
<p><strong>frame_indices</strong> : 1D array-like, default None</p>
<blockquote class="last">
<div><p>if given, only perform calculation for those frames</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method is equal to pytraj.rmsd(traj, mask, ref, nofit=True, ...)</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.mean_structure">
<code class="descclassname">pytraj.</code><code class="descname">mean_structure</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>frame_indices=None</em>, <em>dtype='frame'</em>, <em>autoimage=False</em>, <em>rmsfit=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.mean_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>get mean structure for a given mask and given frame_indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask</strong> : None or str, default None (all atoms)</p>
<p><strong>frame_indices</strong> : iterable that produces integer, default None, optional</p>
<blockquote>
<div><p>frame indices</p>
</div></blockquote>
<p><strong>dtype: str, {&#8216;frame&#8217;, &#8216;traj&#8217;}, default &#8216;frame&#8217;</strong></p>
<blockquote>
<div><p>return type, either Frame (does not have Topology information) or &#8216;traj&#8217;</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote>
<div><p>if True, performa autoimage</p>
</div></blockquote>
<p><strong>rmsfit</strong> : object, {Frame, int, tuple, None}, default None</p>
<blockquote class="last">
<div><p>if rmsfit is not None, perform rms fit to reference.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if autoimage=True and having rmsfit, perform autoimage first and do rmsfit</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from whole traj, all atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure from several frames, &#39;@CA&#39; atoms&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get average structure but do autoimage and rmsfit to 1st Frame.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">mean_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pucker">
<code class="descclassname">pytraj.</code><code class="descname">pucker</code><span class="sig-paren">(</span><em>traj=None</em>, <em>pucker_mask=(&quot;C1'&quot;</em>, <em>&quot;C2'&quot;</em>, <em>&quot;C3'&quot;</em>, <em>&quot;C4'&quot;</em>, <em>&quot;O4'&quot;)</em>, <em>resrange=None</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>range360=False</em>, <em>method='altona'</em>, <em>use_com=True</em>, <em>amplitude=False</em>, <em>offset=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pucker" title="Permalink to this definition">¶</a></dt>
<dd><p>compute pucker</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>pucker_mask</strong> : str</p>
<p><strong>resrange</strong> : None or array of int</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : str, return type</p>
<p><strong>range360: bool, use 360 or 180 scale</strong></p>
<p><strong>method</strong> : {&#8216;altona&#8217;, &#8216;cremer&#8217;}, default &#8216;altona&#8217;</p>
<p><strong>use_com</strong> : bool</p>
<p><strong>amplitude</strong> : bool, default False</p>
<p><strong>offset</strong> : None or float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dataset</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.diffusion">
<code class="descclassname">pytraj.</code><code class="descname">diffusion</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>tstep=1.0</em>, <em>individual=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>compute diffusion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterator</p>
<p><strong>mask</strong> : str, default &#8216;&#8217; (all atoms)</p>
<p><strong>tstep</strong> : float, time step between frames, default 1.0 ps</p>
<p><strong>individual</strong> : bool, default False</p>
<p><strong>top</strong> : Topology, optional</p>
<p><strong>dtype</strong> : str, default &#8216;dataset&#8217;</p>
<p class="last"><strong>frame_indices</strong> : array or None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">diffusion</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span>
<span class="go">array([ 0.        ,  0.87027302,  1.64626022,  2.26262651,  2.98068114,</span>
<span class="go">        3.57075535,  4.07030655,  4.71894512,  5.42302306,  6.01310377])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.get_velocity">
<code class="descclassname">pytraj.</code><code class="descname">get_velocity</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.get_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>get velocity for specify frames with given mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask</strong> : str, default None (use all atoms), optional</p>
<blockquote>
<div><p>atom mask</p>
</div></blockquote>
<p><strong>frame_indices</strong> : iterable that produces integer, default None, optional</p>
<blockquote class="last">
<div><p>if not None, only get velocity for given frame indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Since pytraj has limited support for force and velocity info, if user wants to
load both from disk, should iterate the TrajectoryIterator (got by pytraj.iterload method)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytraj</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="n">forces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">velocities</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">topology_filename</span><span class="p">)</span>

<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
    <span class="n">forces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">force</span><span class="p">)</span>
    <span class="n">velocities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>

<span class="c"># Note: pytraj can efficiently load arbitary frame indices to memory</span>
<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]):</span> <span class="k">pass</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vels</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">get_velocity</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pairwise_rmsd">
<code class="descclassname">pytraj.</code><code class="descname">pairwise_rmsd</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>metric='rms'</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>mat_type='full'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pairwise_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate pairwise rmsd with different metrics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable object</p>
<p><strong>mask</strong> : mask</p>
<blockquote>
<div><p>if mask is &#8220;&#8221;, use all atoms</p>
</div></blockquote>
<p><strong>metric</strong> : {&#8216;rms&#8217;, &#8216;dme&#8217;, &#8216;srmsd&#8217;, &#8216;nofit&#8217;}</p>
<blockquote>
<div><p>if &#8216;rms&#8217;, perform rms fit
if &#8216;dme&#8217;, use distance RMSD
if &#8216;srmsd&#8217;, use symmetry-corrected RMSD
if &#8216;nofit&#8217;, perform rmsd without fitting</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default=None</p>
<p><strong>dtype: ndarray</strong></p>
<blockquote>
<div><p>return type</p>
</div></blockquote>
<p><strong>mat_type</strong> : str, {&#8216;full&#8217;, &#8216;half&#8217;}</p>
<blockquote class="last">
<div><p>if &#8216;full&#8217;: return 2D array, shape=(n_frames, n_frames)
if &#8216;half&#8217;: return 1D array, shape=(n_frames*(n_frames-1)/2, )</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Install <code class="docutils literal"><span class="pre">libcpptraj</span></code> with <code class="docutils literal"><span class="pre">openmp</span></code> to get benefit from parallel</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate pairwise rmsd for all frames using CA atoms, use `dme` (distance RMSD)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># convert to numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;dme&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;ndarray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate pairwise rmsd for all frames using CA atoms, nofit for RMSD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># convert to numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;nofit&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;ndarray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># calculate pairwise rmsd for all frames using CA atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># use symmetry-corrected RMSD, convert to numpy array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;srmsd&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;ndarray&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use different dtype</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_np</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pairwise_rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;@CA&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s">&quot;srmsd&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pairwise_distance">
<code class="descclassname">pytraj.</code><code class="descname">pairwise_distance</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask_1=''</em>, <em>mask_2=''</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pairwise_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>compute pairwise distance between atoms in mask_1 and atoms in mask_2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterable that produces Frame</p>
<p><strong>mask_1: string or 1D array-like</strong></p>
<p><strong>mask_2: string or 1D array-like</strong></p>
<p><strong>...</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_1</strong> : numpy array, shape (n_frames, n_atom_1, n_atom_2)</p>
<p class="last"><strong>out_2</strong> : atom pairs, shape=(n_atom_1, n_atom_2, 2)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method is only fast for small number of atoms.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_pairwise_distance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="s">&#39;@CB&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.bfactors">
<code class="descclassname">pytraj.</code><code class="descname">bfactors</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>byres=True</em>, <em>top=None</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.bfactors" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate pseudo bfactor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj: Trajectory-like</strong></p>
<p><strong>mask: str, mask</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">if dtype is &#8216;ndarray&#8217; (default), return a numpy array</p>
<p class="last">with shape=(n_atoms/n_residues, 2) ([atom_or_residue_idx, value])</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This is <strong>NOT</strong> getting bfactor from xray, but computing bfactor from simulation.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!:WAT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bfactor</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_bfactors</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">byres</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rmsd">
<code class="descclassname">pytraj.</code><code class="descname">rmsd</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>ref_mask=''</em>, <em>nofit=False</em>, <em>mass=False</em>, <em>update_coordinate=True</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>compute rmsd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str or 1D array-like of string or 1D or 2D array-like</p>
<blockquote>
<div><p>Atom mask/indices</p>
</div></blockquote>
<p><strong>ref</strong> : {Frame, int}, default=0 (first frame)</p>
<blockquote>
<div><p>Reference frame or index.</p>
</div></blockquote>
<p><strong>ref_mask: str, optional</strong></p>
<blockquote>
<div><p>if given, use it instead of <cite>mask</cite></p>
</div></blockquote>
<p><strong>nofit</strong> : bool, default False</p>
<blockquote>
<div><p>if False, perform fitting (rotation and translation).
if <code class="docutils literal"><span class="pre">traj</span></code> is mutable, its coordinates will be updated
if True, not fitting.</p>
</div></blockquote>
<p><strong>mass</strong> : bool, default False</p>
<blockquote>
<div><p>if True, include mass</p>
</div></blockquote>
<p><strong>update_coordinate</strong> : bool, default True</p>
<blockquote>
<div><p>if True, coordinates will be updated. But this only apply to mutable Trajectory
if False (same as <cite>nomod</cite> in cpptraj), no modification</p>
</div></blockquote>
<p><strong>frame_indices</strong> : int 1D array-like, default None</p>
<blockquote>
<div><p>if not None, only compute rmsd for given frame indices</p>
</div></blockquote>
<p><strong>top</strong> : {Topology, str}, default None, optional</p>
<p class="last"><strong>dtype</strong> : return data type, default=&#8217;ndarray&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if <code class="docutils literal"><span class="pre">traj</span></code> is mutable and update_coordinate=True, its coordinates will be updated.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_trpcage</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># all atoms, do fitting, using ref=traj[-3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># rmsd for 3 maskes, do fitting, using ref=traj[0] (defaul)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="s">&#39;@C&#39;</span><span class="p">,</span> <span class="s">&#39;:3-18@CA&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># rmsd to first frame, use mass &#39;:3-13&#39; but do not perorm fitting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;:3-13&#39;</span><span class="p">,</span> <span class="n">nofit</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># use atom indices for mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span> <span class="n">nofit</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute rmsd (and align) with reference having different atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trpcage_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_trpcage</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tz2_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()[:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">trpcage_traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@1-10&#39;</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">tz2_traj</span><span class="p">,</span> <span class="n">ref_mask</span><span class="o">=</span><span class="s">&#39;@11-20&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">array([ 2.16203842,  2.28859396,  2.15817654, ...,  2.20767189,</span>
<span class="go">        2.30087764,  1.92654945])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.lowestcurve">
<code class="descclassname">pytraj.</code><code class="descname">lowestcurve</code><span class="sig-paren">(</span><em>data</em>, <em>points=10</em>, <em>step=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.lowestcurve" title="Permalink to this definition">¶</a></dt>
<dd><p>compute lowest curve for data</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.align_principal_axis">
<code class="descclassname">pytraj.</code><code class="descname">align_principal_axis</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask='*'</em>, <em>top=None</em>, <em>frame_indices=None</em>, <em>mass=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.align_principal_axis" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p>apply for mutatble traj (Trajectory, Frame)</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.radgyr">
<code class="descclassname">pytraj.</code><code class="descname">radgyr</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em>, <em>nomax=True</em>, <em>frame_indices=None</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.radgyr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute radius of gyration</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!:WAT&#39;</span><span class="p">,</span> <span class="n">nomax</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.surf">
<code class="descclassname">pytraj.</code><code class="descname">surf</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>dtype='ndarray'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.surf" title="Permalink to this definition">¶</a></dt>
<dd><p>calc surf (LCPO method)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">surf</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.pairdist">
<code class="descclassname">pytraj.</code><code class="descname">pairdist</code><span class="sig-paren">(</span><em>traj</em>, <em>mask='*'</em>, <em>mask2=''</em>, <em>delta=0.1</em>, <em>dtype='ndarray'</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pairdist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute pair distribution function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask</strong> : str, default all atoms</p>
<p><strong>delta</strong> : float, default 0.1</p>
<p><strong>dtype</strong> : str, default &#8216;ndarray&#8217;</p>
<blockquote>
<div><p>dtype of return data</p>
</div></blockquote>
<p class="last"><strong>top</strong> : Topology, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">calc_pairdist</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.transform">
<code class="descclassname">pytraj.</code><code class="descname">transform</code><span class="sig-paren">(</span><em>traj</em>, <em>by</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>transform pytraj.Trajectory by a series of cpptraj&#8217;s commands</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Mutable Trajectory</p>
<p><strong>by</strong> : list of cpptraj commands</p>
<p><strong>frame_indices</strong> : {None, array-like}, default None</p>
<blockquote>
<div><p>if not None, perform tranformation for specific frames.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">transformed Trajectory. Trajectory&#8217;s coordinates will be inplace-updated</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># perform &#39;autoimage&#39;, then &#39;rms&#39;, then &#39;center&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">traj</span><span class="p">[:],</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;autoimage&#39;</span><span class="p">,</span> <span class="s">&#39;rms&#39;</span><span class="p">,</span> <span class="s">&#39;center :1-5&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.watershell">
<code class="descclassname">pytraj.</code><code class="descname">watershell</code><span class="sig-paren">(</span><em>traj=None</em>, <em>solute_mask=''</em>, <em>solvent_mask=':WAT'</em>, <em>lower=3.4</em>, <em>upper=5.0</em>, <em>image=True</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.watershell" title="Permalink to this definition">¶</a></dt>
<dd><p>(adapted from cpptraj doc): Calculate numbers of waters in 1st and 2nd solvation shells
(defined by &lt;lower cut&gt; (default 3.4 Ang.) and &lt;upper cut&gt; (default 5.0 Ang.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>solute_mask: solute mask</strong></p>
<p><strong>solvent_mask: solvent mask</strong></p>
<p><strong>lower</strong> : double, default 3.4</p>
<blockquote>
<div><p>lower cut distance</p>
</div></blockquote>
<p><strong>upper</strong> : double, default 5.0</p>
<blockquote>
<div><p>upper cut distance</p>
</div></blockquote>
<p><strong>image</strong> : bool, defaul True</p>
<blockquote>
<div><p>do autoimage if True</p>
</div></blockquote>
<p><strong>dtype</strong> : return type, defaul &#8216;dataset&#8217;</p>
<p class="last"><strong>top</strong> : Topology, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">watershell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="s">&#39;!:WAT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">watershell</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">solute_mask</span><span class="o">=</span><span class="s">&#39;!:WAT&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.make_structure">
<code class="descclassname">pytraj.</code><code class="descname">make_structure</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.make_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.pca">
<code class="descclassname">pytraj.</code><code class="descname">pca</code><span class="sig-paren">(</span><em>traj</em>, <em>mask</em>, <em>n_vecs=2</em>, <em>fit=True</em>, <em>ref=None</em>, <em>ref_mask=None</em>, <em>dtype='ndarray'</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>perform PCA analysis by following below steps:</p>
<ul class="simple">
<li>(optional) perform rmsfit to reference if needed</li>
<li>compute covariance matrix</li>
<li>diagonalize the matrix to get eigenvectors and eigenvalues</li>
<li>perform projection of each frame with mask to each eigenvector</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory</p>
<blockquote>
<div><p>traj must be <code class="docutils literal"><span class="pre">pytraj.Trajectory</span></code>, which can be created by <code class="docutils literal"><span class="pre">pytraj.load</span></code> method.</p>
</div></blockquote>
<p><strong>mask</strong> : str</p>
<blockquote>
<div><p>atom mask for covariance matrix and projection</p>
</div></blockquote>
<p><strong>n_vecs</strong> : int, default 2</p>
<blockquote>
<div><p>number of eigenvectors. If user want to compute projection for all eigenvectors,
should specify n_vecs=-1 (or a negative number)</p>
</div></blockquote>
<p><strong>fit</strong> : bool, default True</p>
<blockquote>
<div><p>if True, perform fitting before compute covariance matrix
if False, no fitting (keep rotation and translation). In this case, <cite>pytraj</cite> will ignore <cite>ref</cite> argument.</p>
</div></blockquote>
<p><strong>ref</strong> : {None, Frame, int}, default None</p>
<blockquote>
<div><p>if None, trajectory will be superposed to average structure
if is Frame or integer value, trajectory will be superposed to given reference</p>
</div></blockquote>
<p><strong>ref_mask</strong> : {None, str}, default None (use <cite>mask</cite>)</p>
<blockquote>
<div><p>if None, use <cite>mask</cite> for fitting
if str, use this given mask for fitting</p>
</div></blockquote>
<p><strong>dtype</strong> : return datatype</p>
<p><strong>top</strong> : Topology, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">out1: projection_data, ndarray with shape=(n_vecs, n_frames)</p>
<p class="last">out2: tuple of (eigenvalues, eigenvectors)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()[:]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute pca for first and second modes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">n_vecs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get projection values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
<span class="go">array([[  4.93425131,  13.80002308,  20.61605835, ..., -57.92280579,</span>
<span class="go">        -61.25728607, -52.85142136],</span>
<span class="go">       [  4.03333616,  -6.9132452 , -14.53991318, ...,  -6.757936  ,</span>
<span class="go">          2.1086719 ,  -3.60922861]], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get eigenvalues for first 2 modes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
<span class="go">array([ 1399.36472919,   240.42342439])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># compute pca for all modes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pca_data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">n_vecs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># does not perform fitting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># provide different mask for fitting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;!@H=&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref_mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.translate">
<code class="descclassname">pytraj.</code><code class="descname">translate</code><span class="sig-paren">(</span><em>traj=None</em>, <em>command=''</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>translate coordinate</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load to mutable trajectory by `load` method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do transform traj and return itself</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA x 120.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.xcorr">
<code class="descclassname">pytraj.</code><code class="descname">xcorr</code><span class="sig-paren">(</span><em>data0</em>, <em>data1</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.xcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>compute cross correlation between two datasets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data0 and data1: 1D-array like</strong></p>
<p class="last"><strong>dtype</strong> : return datatype, default &#8216;ndarray&#8217;</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Same as <cite>corr</cite> in cpptraj</p>
</dd></dl>

<dl class="function">
<dt id="pytraj.check_structure">
<code class="descclassname">pytraj.</code><code class="descname">check_structure</code><span class="sig-paren">(</span><em>traj</em>, <em>mask=''</em>, <em>options=''</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='ndarray'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.check_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>check if the structure is ok or not</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>mask: str, default all atoms</strong></p>
<p><strong>options</strong> : str, default &#8216;&#8217;</p>
<blockquote>
<div><p>extra cpptraj options</p>
</div></blockquote>
<p><strong>dtype</strong> : str, default &#8216;ndarray&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : 1D-array</p>
<blockquote class="last">
<div><p>number of problems for each frame</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_rna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">failures</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">check_structure</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.center">
<code class="descclassname">pytraj.</code><code class="descname">center</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>center='box'</em>, <em>mass=False</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.center" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or Frame iterator</p>
<p><strong>mask</strong> : str, mask</p>
<p><strong>center</strong> : str, {&#8216;box&#8217;, &#8216;origin&#8217;}</p>
<p><strong>mass</strong> : bool, default: False</p>
<blockquote>
<div><p>if True, use mass weighted</p>
</div></blockquote>
<p><strong>top</strong> : Topology, optional, default: None</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">updated traj</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../modify_traj.html#pytraj.translate" title="pytraj.translate"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.translate</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load all frames to memory so we can &#39;mutate&#39; them</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># all atoms, center to box center (x/2, y/2, z/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># center at origin, use @CA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="s">&#39;origin&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># center to box center, use mass weighted</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;:1&#39;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.rmsd_perres">
<code class="descclassname">pytraj.</code><code class="descname">rmsd_perres</code><span class="sig-paren">(</span><em>traj=None</em>, <em>mask=''</em>, <em>ref=0</em>, <em>mass=False</em>, <em>resrange=None</em>, <em>perres_mask=None</em>, <em>perres_center=False</em>, <em>perres_invert=False</em>, <em>frame_indices=None</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.rmsd_perres" title="Permalink to this definition">¶</a></dt>
<dd><p>superpose <code class="docutils literal"><span class="pre">traj</span></code> to <code class="docutils literal"><span class="pre">ref</span></code> with <cite>mask</cite>, then calculate nofit rms for residues
in <cite>resrange</cite> with given <cite>perresmask</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : pytraj.DatasetList, shape=(1+n_residues, n_frames)</p>
<blockquote class="last">
<div><p>out[0]: regular rmsd
out[1:]: perres rmsd for all given residues
<cite>out.values</cite> will return corresponding numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_multidihedral">
<code class="descclassname">pytraj.</code><code class="descname">calc_multidihedral</code><span class="sig-paren">(</span><em>traj=None</em>, <em>dhtypes=None</em>, <em>resrange=None</em>, <em>define_new_type=None</em>, <em>range360=False</em>, <em>dtype='dataset'</em>, <em>top=None</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_multidihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>perform dihedral search</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like object</p>
<p><strong>dhtypes</strong> : dihedral type, default None</p>
<blockquote>
<div><p>if None, calculate all supported dihedrals</p>
</div></blockquote>
<p><strong>resrange</strong> : str | array-like</p>
<blockquote>
<div><p>residue range for searching. If <cite>resrange</cite> is string, use index starting with 1
(cpptraj convertion)
if <cite>resrange</cite> is array-like, use index starting from 0 (python convention)</p>
</div></blockquote>
<p><strong>define_new_type</strong> : str</p>
<blockquote>
<div><p>define new type for searching</p>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>if True: use 0-360</p>
</div></blockquote>
<p><strong>top</strong> : Topology | str, optional</p>
<blockquote>
<div><p>only need to have &#8216;top&#8217; if can not find it in <cite>traj</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pytraj.DatasetList (use <cite>values</cite> attribute to get raw <cite>numpy</cite> array)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Dataset lables show residue number in 1-based index</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&#39;phi psi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;1,3,5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&#39;3-7&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dhtypes</span><span class="o">=</span><span class="s">&#39;phi psi&#39;</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_phi">
<code class="descclassname">pytraj.</code><code class="descname">calc_phi</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_phi" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_psi">
<code class="descclassname">pytraj.</code><code class="descname">calc_psi</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_psi" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_chip">
<code class="descclassname">pytraj.</code><code class="descname">calc_chip</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_chip" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_omega">
<code class="descclassname">pytraj.</code><code class="descname">calc_omega</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_omega" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_alpha">
<code class="descclassname">pytraj.</code><code class="descname">calc_alpha</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_alpha" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_beta">
<code class="descclassname">pytraj.</code><code class="descname">calc_beta</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_beta" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_gamma">
<code class="descclassname">pytraj.</code><code class="descname">calc_gamma</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_gamma" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_delta">
<code class="descclassname">pytraj.</code><code class="descname">calc_delta</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_delta" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_epsilon">
<code class="descclassname">pytraj.</code><code class="descname">calc_epsilon</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_zeta">
<code class="descclassname">pytraj.</code><code class="descname">calc_zeta</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_zeta" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_nu1">
<code class="descclassname">pytraj.</code><code class="descname">calc_nu1</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_nu1" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_nu2">
<code class="descclassname">pytraj.</code><code class="descname">calc_nu2</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_nu2" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.calc_chin">
<code class="descclassname">pytraj.</code><code class="descname">calc_chin</code><span class="sig-paren">(</span><em>traj=None</em>, <em>resrange=''</em>, <em>range360=False</em>, <em>top=None</em>, <em>dtype='dataset'</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.calc_chin" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or anything that makes iterframe_master(traj) return Frame</p>
<p><strong>resrange</strong> : string or iterable, cpptraj resrange, default &#8220;&#8221;</p>
<blockquote>
<div><p>if resrange is a string, use index of 1-based
if resrange is a python sequence (range, list, array, ...),</p>
<blockquote>
<div><p>use index of 0-based</p>
</div></blockquote>
</div></blockquote>
<p><strong>range360</strong> : bool, default False</p>
<blockquote>
<div><p>use -180/180 or 0/360</p>
</div></blockquote>
<p><strong>top</strong> : {str, Topology}, optional, default None</p>
<p><strong>frame_indices</strong> : {None, 1D array-like}, default None</p>
<blockquote class="last">
<div><p>if not None, only compute for given indices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj.dihedral_</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_psi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">range360</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_chip</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="s">&quot;3-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">resrange</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">all_actions</span> <span class="k">as</span> <span class="n">pyca</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi0</span> <span class="o">=</span> <span class="n">pyca</span><span class="o">.</span><span class="n">calc_multidihedral</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="s">&quot;phi&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">calc_phi</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dataset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">aa_eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">phi0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aa_eq</span><span class="p">(</span><span class="n">phi0</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">phi1</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.nastruct">
<code class="descclassname">pytraj.</code><code class="descname">nastruct</code><span class="sig-paren">(</span><em>traj=None</em>, <em>ref=0</em>, <em>resrange=None</em>, <em>resmap=None</em>, <em>hbcut=3.5</em>, <em>frame_indices=None</em>, <em>pucker_method='altona'</em>, <em>dtype='nupars'</em>, <em>groove_3dna=True</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.nastruct" title="Permalink to this definition">¶</a></dt>
<dd><p>compute nucleic acid parameters. (adapted from cpptraj doc)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like</p>
<p><strong>ref</strong> : {Frame, int}, default 0 (first frame)</p>
<p><strong>resrange</strong> : None, str or array-like of integers</p>
<p><strong>resmap</strong> : residue map, example: &#8216;AF2:A&#8217;</p>
<p><strong>hbcut</strong> : float, default=3.5 Angstrong</p>
<blockquote>
<div><p>Distance cutoff for determining basepair hbond</p>
</div></blockquote>
<p><strong>pucker_method</strong> : str, {&#8216;altona&#8217;, &#8216;cremer&#8217;}, default &#8216;altona&#8217;</p>
<blockquote>
<div><p>&#8216;altona&#8217; : Use method of Altona &amp; Sundaralingam to calculate sugar pucker
&#8216;cremer&#8217; : Use method of Cremer and Pople to calculate sugar pucker&#8217;</p>
</div></blockquote>
<p><strong>frame_indices</strong> : array-like, default None (all frames)</p>
<p><strong>groove_3dna</strong> : bool, default True</p>
<blockquote>
<div><p>if True, major and minor groove will match 3DNA&#8217;s output.</p>
</div></blockquote>
<p><strong>dtype</strong> : str, {&#8216;nupars&#8217;, &#8216;cpptraj_dataset&#8217;}, default &#8216;nupars&#8217;</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : nupars object. One can assess different values (major groove width, xdips values</p>
<p class="last">...) by accessing its attribute. See example below.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_rna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">nastruct</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">groove_3dna</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]</span> 
<span class="go">[&#39;buckle&#39;, &#39;minor&#39;, &#39;major&#39;, &#39;xdisp&#39;, &#39;stagger&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get minor groove width values for each pairs for each snapshot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># data.minor is a tuple, first value is a list of basepairs, seconda value is</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># numpy array, shape=(n_frames, n_pairs)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">minor</span> 
<span class="go">([&#39;1G16C&#39;, &#39;2G15C&#39;, &#39;3G14C&#39;, &#39;4C13G&#39;, &#39;5G12C&#39;, &#39;6C11G&#39;, &#39;7C10G&#39;, &#39;8C9G&#39;],</span>
<span class="go"> array([[ 13.32927036,  13.403409  ,  13.57159901, ...,  13.26655865,</span>
<span class="go">         13.43054485,  13.4557209 ],</span>
<span class="go">       [ 13.32002068,  13.45918751,  13.63253593, ...,  13.27066231,</span>
<span class="go">         13.42743683,  13.53450871],</span>
<span class="go">       [ 13.34087658,  13.53778553,  13.57062435, ...,  13.29017353,</span>
<span class="go">         13.38542843,  13.46101475]]))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">twist</span> 
<span class="go">([&#39;1G16C-2G15C&#39;, &#39;2G15C-3G14C&#39;, &#39;3G14C-4C13G&#39;, &#39;4C13G-5G12C&#39;, &#39;5G12C-6C11G&#39;, &#39;6C11G-7C10G&#39;, &#39;7C10G-8C9G&#39;],</span>
<span class="go">array([[ 34.77773666,  33.98158646,  30.18647003, ...,  35.14608765,</span>
<span class="go">         33.9628334 ,  33.13056946],</span>
<span class="go">       [ 33.39176178,  32.68476105,  28.36385536, ...,  36.59774399,</span>
<span class="go">         30.20827484,  26.48732948],</span>
<span class="go">       [ 36.20665359,  32.58955002,  27.47707367, ...,  33.42843246,</span>
<span class="go">         30.90047073,  33.73724365]]))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># change dtype</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">nastruct</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;cpptraj_dataset&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.esander">
<code class="descclassname">pytraj.</code><code class="descname">esander</code><span class="sig-paren">(</span><em>traj=None</em>, <em>prmtop=None</em>, <em>igb=8</em>, <em>mm_options=None</em>, <em>qm_options=None</em>, <em>mode=None</em>, <em>dtype='dict'</em>, <em>frame_indices=None</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.esander" title="Permalink to this definition">¶</a></dt>
<dd><p>energy decomposition by calling <cite>libsander</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : Trajectory-like or iterables that produce Frame</p>
<blockquote>
<div><p>if <cite>traj</cite> does not hold Topology information, <cite>top</cite> must be provided</p>
</div></blockquote>
<p><strong>prmtop</strong> : str or Structure from ParmEd, default=None, optional</p>
<blockquote>
<div><p>To avoid any unexpected error, you should always provide original topology
filename. If prmtop is None, pytraj will load Topology from traj.top.filename.</p>
<ul class="simple">
<li>why do you need to load additional topology filename? Because cpptraj and sander
use different Topology object, can not convert from one to another.</li>
</ul>
</div></blockquote>
<p><strong>igb</strong> : GB model, default=8 (GB-Neck2)</p>
<blockquote>
<div><p>If specify <cite>mm_options</cite>, this <cite>igb</cite> input will be ignored</p>
</div></blockquote>
<p><strong>mm_options</strong> : InputOptions from <cite>sander</cite>, default=None, optional</p>
<blockquote>
<div><p>if <cite>mm_options</cite> is None, use <cite>gas_input</cite> with given igb.
If <cite>mm_options</cite> is not None, use this</p>
</div></blockquote>
<p><strong>qm_options</strong> : InputOptions from <cite>sander</cite> for QMMM, optional</p>
<p><strong>mode</strong> : str, default=None, optional</p>
<blockquote>
<div><p>if mode=&#8217;minimal&#8217;, get only &#8216;bond&#8217;, &#8216;angle&#8217;, &#8216;dihedral&#8217; and &#8216;total&#8217; energies</p>
</div></blockquote>
<p><strong>top</strong> : pytraj.Topology or str, default=None, optional</p>
<blockquote>
<div><p>only need to specify this <code class="docutils literal"><span class="pre">top</span></code> if <code class="docutils literal"><span class="pre">traj</span></code> does not hold Topology</p>
</div></blockquote>
<p><strong>dtype</strong> : str, {&#8216;dict&#8217;, &#8216;dataset&#8217;, &#8216;ndarray&#8217;, &#8216;dataframe&#8217;}, default=&#8217;dict&#8217;</p>
<blockquote>
<div><p>return data type</p>
</div></blockquote>
<p><strong>frame_indices</strong> : None or 1D array-like, default None</p>
<blockquote>
<div><p>if not None, only perform calculation for given frames</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dict of energies (to be used with DataFrame) or DatasetList</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method does not work with <cite>pytraj.pmap</cite> when you specify mm_options and
qm_options. Use <cite>pytraj.pmap_mpi</cite> with MPI instead.</p>
<p>Work with <code class="docutils literal"><span class="pre">pytraj.pmap</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">pt</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">esander</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">igb</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Will NOT work with <code class="docutils literal"><span class="pre">pytraj.pmap</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sander</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">sander</span><span class="o">.</span><span class="n">gas_input</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">pt</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">esander</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">mm_options</span><span class="o">=</span><span class="n">inp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Why? Because Python need to pickle each object to send to different cores and Python
does not know how to pickle mm_options from sander.gas_input(8).</p>
<p>This works with <code class="docutils literal"><span class="pre">pytraj.pmap_mpi</span></code> because pytraj explicitly create <code class="docutils literal"><span class="pre">mm_options</span></code>
in each core without pickling.</p>
<p class="rubric">Examples</p>
<p>Examples are adapted from $AMBERHOME/test/sanderapi</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># GB energy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">esander</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">igb</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;gb&#39;</span><span class="p">]</span>
<span class="go">array([-92.88577683])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;bond&#39;</span><span class="p">]</span>
<span class="go">array([ 5.59350521])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># PME</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">amberhome</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sander</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">amberhome</span><span class="p">,</span> <span class="s">&quot;test/4096wat/prmtop&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rstfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">amberhome</span><span class="p">,</span> <span class="s">&quot;test/4096wat/eq1.x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">rstfile</span><span class="p">,</span> <span class="n">topfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">sander</span><span class="o">.</span><span class="n">pme_input</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span><span class="o">.</span><span class="n">cut</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">esander</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">traj</span><span class="p">,</span> <span class="n">mm_options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span><span class="p">[</span><span class="s">&#39;vdw&#39;</span><span class="p">]</span>
<span class="go">array([ 6028.95167558])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># GB + QMMM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">amberhome</span><span class="p">,</span> <span class="s">&quot;test/qmmm2/lysine_PM3_qmgb2/prmtop&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rstfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">amberhome</span><span class="p">,</span> <span class="s">&quot;test/qmmm2/lysine_PM3_qmgb2/lysine.crd&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">rstfile</span><span class="p">,</span> <span class="n">topfile</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">sander</span><span class="o">.</span><span class="n">gas_input</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span><span class="o">.</span><span class="n">cut</span> <span class="o">=</span> <span class="mf">99.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span><span class="o">.</span><span class="n">ifqnt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm_options</span> <span class="o">=</span> <span class="n">sander</span><span class="o">.</span><span class="n">qm_input</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm_options</span><span class="o">.</span><span class="n">iqmatoms</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm_options</span><span class="o">.</span><span class="n">qm_theory</span> <span class="o">=</span> <span class="s">&quot;PM3&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm_options</span><span class="o">.</span><span class="n">qmcharge</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm_options</span><span class="o">.</span><span class="n">qmgb</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm_options</span><span class="o">.</span><span class="n">adjust_q</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">esander</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="n">traj</span><span class="p">,</span> <span class="n">mm_options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span> <span class="n">qm_options</span><span class="o">=</span><span class="n">qm_options</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span><span class="p">[</span><span class="s">&#39;bond&#39;</span><span class="p">]</span>
<span class="go">array([ 0.00160733])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span><span class="p">[</span><span class="s">&#39;scf&#39;</span><span class="p">]</span>
<span class="go">array([-11.92177575])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># passing options to `pytraj.pmap`: need to pass string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp_str</span> <span class="o">=</span> <span class="s">&#39;mm_options = sander.pme_input()&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">esander</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">mm_options</span><span class="o">=</span><span class="n">inp_str</span><span class="p">,</span> <span class="n">n_cores</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edict</span><span class="p">[</span><span class="s">&#39;dihedral&#39;</span><span class="p">]</span>
<span class="go">array([ 126.39307126,  127.0460586 ,  137.26793522,  125.30521069,</span>
<span class="go">        125.25110884,  137.69287326,  125.78280543,  125.14530517,</span>
<span class="go">        118.41540102,  128.73535036])</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="pytraj.Atom">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">Atom</code><a class="headerlink" href="#pytraj.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.core</span> <span class="k">import</span> <span class="n">Atom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># name, type, charge, mass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="s">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="s">&#39;1.0&#39;</span><span class="p">,</span> <span class="n">resid</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.atomic_number" title="pytraj.Atom.atomic_number"><code class="xref py py-obj docutils literal"><span class="pre">atomic_number</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.chain" title="pytraj.Atom.chain"><code class="xref py py-obj docutils literal"><span class="pre">chain</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.charge" title="pytraj.Atom.charge"><code class="xref py py-obj docutils literal"><span class="pre">charge</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.element" title="pytraj.Atom.element"><code class="xref py py-obj docutils literal"><span class="pre">element</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.gb_radius" title="pytraj.Atom.gb_radius"><code class="xref py py-obj docutils literal"><span class="pre">gb_radius</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.index" title="pytraj.Atom.index"><code class="xref py py-obj docutils literal"><span class="pre">index</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.mass" title="pytraj.Atom.mass"><code class="xref py py-obj docutils literal"><span class="pre">mass</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.molnum" title="pytraj.Atom.molnum"><code class="xref py py-obj docutils literal"><span class="pre">molnum</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.n_bonds" title="pytraj.Atom.n_bonds"><code class="xref py py-obj docutils literal"><span class="pre">n_bonds</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.name" title="pytraj.Atom.name"><code class="xref py py-obj docutils literal"><span class="pre">name</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.resid" title="pytraj.Atom.resid"><code class="xref py py-obj docutils literal"><span class="pre">resid</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.resname" title="pytraj.Atom.resname"><code class="xref py py-obj docutils literal"><span class="pre">resname</span></code></a></td>
<td>resname: object</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.type" title="pytraj.Atom.type"><code class="xref py py-obj docutils literal"><span class="pre">type</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.bonded_indices" title="pytraj.Atom.bonded_indices"><code class="xref py py-obj docutils literal"><span class="pre">bonded_indices</span></code></a>(self)</td>
<td>get bond indices that <cite>self</cite> bonds to</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.copy" title="pytraj.Atom.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Atom.is_bonded_to" title="pytraj.Atom.is_bonded_to"><code class="xref py py-obj docutils literal"><span class="pre">is_bonded_to</span></code></a>(self,&nbsp;int&nbsp;idx)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Atom.set_mol" title="pytraj.Atom.set_mol"><code class="xref py py-obj docutils literal"><span class="pre">set_mol</span></code></a>(self,&nbsp;int&nbsp;mol_num)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pytraj.Atom.atomic_number">
<code class="descname">atomic_number</code><a class="headerlink" href="#pytraj.Atom.atomic_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Atom.bonded_indices">
<code class="descname">bonded_indices</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Atom.bonded_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>get bond indices that <cite>self</cite> bonds to</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.chain">
<code class="descname">chain</code><a class="headerlink" href="#pytraj.Atom.chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.charge">
<code class="descname">charge</code><a class="headerlink" href="#pytraj.Atom.charge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Atom.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Atom.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.element">
<code class="descname">element</code><a class="headerlink" href="#pytraj.Atom.element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.gb_radius">
<code class="descname">gb_radius</code><a class="headerlink" href="#pytraj.Atom.gb_radius" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.index">
<code class="descname">index</code><a class="headerlink" href="#pytraj.Atom.index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Atom.is_bonded_to">
<code class="descname">is_bonded_to</code><span class="sig-paren">(</span><em>self</em>, <em>int idx</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Atom.is_bonded_to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.mass">
<code class="descname">mass</code><a class="headerlink" href="#pytraj.Atom.mass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.molnum">
<code class="descname">molnum</code><a class="headerlink" href="#pytraj.Atom.molnum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.n_bonds">
<code class="descname">n_bonds</code><a class="headerlink" href="#pytraj.Atom.n_bonds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.name">
<code class="descname">name</code><a class="headerlink" href="#pytraj.Atom.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.resid">
<code class="descname">resid</code><a class="headerlink" href="#pytraj.Atom.resid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.resname">
<code class="descname">resname</code><a class="headerlink" href="#pytraj.Atom.resname" title="Permalink to this definition">¶</a></dt>
<dd><p>resname: object</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Atom.set_mol">
<code class="descname">set_mol</code><span class="sig-paren">(</span><em>self</em>, <em>int mol_num</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Atom.set_mol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Atom.type">
<code class="descname">type</code><a class="headerlink" href="#pytraj.Atom.type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.Residue">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">Residue</code><a class="headerlink" href="#pytraj.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Residue</span><span class="p">(</span><span class="s">&#39;ALA&#39;</span><span class="p">,</span> <span class="n">resid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">icode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">chainID</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Residue.first_atom_index" title="pytraj.Residue.first_atom_index"><code class="xref py py-obj docutils literal"><span class="pre">first_atom_index</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Residue.index" title="pytraj.Residue.index"><code class="xref py py-obj docutils literal"><span class="pre">index</span></code></a></td>
<td>shortcut of original_resid</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Residue.last_atom_index" title="pytraj.Residue.last_atom_index"><code class="xref py py-obj docutils literal"><span class="pre">last_atom_index</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Residue.n_atoms" title="pytraj.Residue.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Residue.name" title="pytraj.Residue.name"><code class="xref py py-obj docutils literal"><span class="pre">name</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Residue.original_resid" title="pytraj.Residue.original_resid"><code class="xref py py-obj docutils literal"><span class="pre">original_resid</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Residue.is_solvent" title="pytraj.Residue.is_solvent"><code class="xref py py-obj docutils literal"><span class="pre">is_solvent</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Residue.ntype" title="pytraj.Residue.ntype"><code class="xref py py-obj docutils literal"><span class="pre">ntype</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Residue.set_last_atom" title="pytraj.Residue.set_last_atom"><code class="xref py py-obj docutils literal"><span class="pre">set_last_atom</span></code></a>(self,&nbsp;int&nbsp;i)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pytraj.Residue.first_atom_index">
<code class="descname">first_atom_index</code><a class="headerlink" href="#pytraj.Residue.first_atom_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Residue.index">
<code class="descname">index</code><a class="headerlink" href="#pytraj.Residue.index" title="Permalink to this definition">¶</a></dt>
<dd><p>shortcut of original_resid</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Residue.is_solvent">
<code class="descname">is_solvent</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Residue.is_solvent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Residue.last_atom_index">
<code class="descname">last_atom_index</code><a class="headerlink" href="#pytraj.Residue.last_atom_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Residue.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.Residue.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Residue.name">
<code class="descname">name</code><a class="headerlink" href="#pytraj.Residue.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Residue.ntype">
<code class="descname">ntype</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Residue.ntype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Residue.original_resid">
<code class="descname">original_resid</code><a class="headerlink" href="#pytraj.Residue.original_resid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Residue.set_last_atom">
<code class="descname">set_last_atom</code><span class="sig-paren">(</span><em>self</em>, <em>int i</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Residue.set_last_atom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.Molecule">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">Molecule</code><a class="headerlink" href="#pytraj.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Molecule.begin_atom" title="pytraj.Molecule.begin_atom"><code class="xref py py-obj docutils literal"><span class="pre">begin_atom</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Molecule.end_atom" title="pytraj.Molecule.end_atom"><code class="xref py py-obj docutils literal"><span class="pre">end_atom</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Molecule.n_atoms" title="pytraj.Molecule.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Molecule.is_solvent" title="pytraj.Molecule.is_solvent"><code class="xref py py-obj docutils literal"><span class="pre">is_solvent</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Molecule.set_first" title="pytraj.Molecule.set_first"><code class="xref py py-obj docutils literal"><span class="pre">set_first</span></code></a>(self,&nbsp;int&nbsp;begin)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Molecule.set_last" title="pytraj.Molecule.set_last"><code class="xref py py-obj docutils literal"><span class="pre">set_last</span></code></a>(self,&nbsp;int&nbsp;last)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Molecule.set_no_solvent" title="pytraj.Molecule.set_no_solvent"><code class="xref py py-obj docutils literal"><span class="pre">set_no_solvent</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Molecule.set_solvent" title="pytraj.Molecule.set_solvent"><code class="xref py py-obj docutils literal"><span class="pre">set_solvent</span></code></a>(self)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pytraj.Molecule.begin_atom">
<code class="descname">begin_atom</code><a class="headerlink" href="#pytraj.Molecule.begin_atom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Molecule.end_atom">
<code class="descname">end_atom</code><a class="headerlink" href="#pytraj.Molecule.end_atom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Molecule.is_solvent">
<code class="descname">is_solvent</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Molecule.is_solvent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Molecule.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.Molecule.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Molecule.set_first">
<code class="descname">set_first</code><span class="sig-paren">(</span><em>self</em>, <em>int begin</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Molecule.set_first" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Molecule.set_last">
<code class="descname">set_last</code><span class="sig-paren">(</span><em>self</em>, <em>int last</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Molecule.set_last" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Molecule.set_no_solvent">
<code class="descname">set_no_solvent</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Molecule.set_no_solvent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Molecule.set_solvent">
<code class="descname">set_solvent</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Molecule.set_solvent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.Topology">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">Topology</code><a class="headerlink" href="#pytraj.Topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.angle_indices" title="pytraj.Topology.angle_indices"><code class="xref py py-obj docutils literal"><span class="pre">angle_indices</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.angles" title="pytraj.Topology.angles"><code class="xref py py-obj docutils literal"><span class="pre">angles</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.atom_names" title="pytraj.Topology.atom_names"><code class="xref py py-obj docutils literal"><span class="pre">atom_names</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.atomlist" title="pytraj.Topology.atomlist"><code class="xref py py-obj docutils literal"><span class="pre">atomlist</span></code></a></td>
<td>return a copy of a list of atoms. If the Topology is large, this method calling</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.atoms" title="pytraj.Topology.atoms"><code class="xref py py-obj docutils literal"><span class="pre">atoms</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.bond_indices" title="pytraj.Topology.bond_indices"><code class="xref py py-obj docutils literal"><span class="pre">bond_indices</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.bonds" title="pytraj.Topology.bonds"><code class="xref py py-obj docutils literal"><span class="pre">bonds</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.box" title="pytraj.Topology.box"><code class="xref py py-obj docutils literal"><span class="pre">box</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.charge" title="pytraj.Topology.charge"><code class="xref py py-obj docutils literal"><span class="pre">charge</span></code></a></td>
<td>return a copy of atom charges (numpy 1D array)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.dihedral_indices" title="pytraj.Topology.dihedral_indices"><code class="xref py py-obj docutils literal"><span class="pre">dihedral_indices</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.dihedrals" title="pytraj.Topology.dihedrals"><code class="xref py py-obj docutils literal"><span class="pre">dihedrals</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.filename" title="pytraj.Topology.filename"><code class="xref py py-obj docutils literal"><span class="pre">filename</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.mass" title="pytraj.Topology.mass"><code class="xref py py-obj docutils literal"><span class="pre">mass</span></code></a></td>
<td>return a copy of atom masses (numpy 1D array)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.moleculelist" title="pytraj.Topology.moleculelist"><code class="xref py py-obj docutils literal"><span class="pre">moleculelist</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.mols" title="pytraj.Topology.mols"><code class="xref py py-obj docutils literal"><span class="pre">mols</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.n_atoms" title="pytraj.Topology.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.n_mols" title="pytraj.Topology.n_mols"><code class="xref py py-obj docutils literal"><span class="pre">n_mols</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.n_residues" title="pytraj.Topology.n_residues"><code class="xref py py-obj docutils literal"><span class="pre">n_residues</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.n_solvents" title="pytraj.Topology.n_solvents"><code class="xref py py-obj docutils literal"><span class="pre">n_solvents</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.residue_names" title="pytraj.Topology.residue_names"><code class="xref py py-obj docutils literal"><span class="pre">residue_names</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.residuelist" title="pytraj.Topology.residuelist"><code class="xref py py-obj docutils literal"><span class="pre">residuelist</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.residues" title="pytraj.Topology.residues"><code class="xref py py-obj docutils literal"><span class="pre">residues</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.vdw_radii" title="pytraj.Topology.vdw_radii"><code class="xref py py-obj docutils literal"><span class="pre">vdw_radii</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code></td>
<td>intended to use with Frame indexing: atm = top(<a class="reference external" href="mailto:'&#37;&#52;&#48;CA">'<span>&#64;</span>CA</a>&#8216;) (for internal use)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.add_angles" title="pytraj.Topology.add_angles"><code class="xref py py-obj docutils literal"><span class="pre">add_angles</span></code></a></td>
<td>add angle for a group of 3 atoms.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.add_atom" title="pytraj.Topology.add_atom"><code class="xref py py-obj docutils literal"><span class="pre">add_atom</span></code></a>(self,&nbsp;Atom&nbsp;atom,&nbsp;Residue&nbsp;residue)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.add_bonds" title="pytraj.Topology.add_bonds"><code class="xref py py-obj docutils literal"><span class="pre">add_bonds</span></code></a></td>
<td>add bond for pairs of atoms.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.add_dihedrals" title="pytraj.Topology.add_dihedrals"><code class="xref py py-obj docutils literal"><span class="pre">add_dihedrals</span></code></a></td>
<td>add dihedral for a group of 4 atoms.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.atom" title="pytraj.Topology.atom"><code class="xref py py-obj docutils literal"><span class="pre">atom</span></code></a>(self,&nbsp;int&nbsp;idx)</td>
<td>return an Atom based on idx. Update this Atom will update Topology.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.atom_indices" title="pytraj.Topology.atom_indices"><code class="xref py py-obj docutils literal"><span class="pre">atom_indices</span></code></a>(self,&nbsp;mask,&nbsp;*args,&nbsp;**kwd)</td>
<td>return atom indices with given mask</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.copy" title="pytraj.Topology.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>(self,&nbsp;*args)</td>
<td>return a copy of &#8216;self&#8217; or copy from &#8216;other&#8217; to &#8216;self&#8217;</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.from_dict" title="pytraj.Topology.from_dict"><code class="xref py py-obj docutils literal"><span class="pre">from_dict</span></code></a>(type&nbsp;cls,&nbsp;dict_data)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.has_box" title="pytraj.Topology.has_box"><code class="xref py py-obj docutils literal"><span class="pre">has_box</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.indices_bonded_to" title="pytraj.Topology.indices_bonded_to"><code class="xref py py-obj docutils literal"><span class="pre">indices_bonded_to</span></code></a>(self,&nbsp;atom_name)</td>
<td>return indices of the number of atoms that each atom bonds to</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.is_empty" title="pytraj.Topology.is_empty"><code class="xref py py-obj docutils literal"><span class="pre">is_empty</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.join" title="pytraj.Topology.join"><code class="xref py py-obj docutils literal"><span class="pre">join</span></code></a>(self,&nbsp;Topology&nbsp;top)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.load" title="pytraj.Topology.load"><code class="xref py py-obj docutils literal"><span class="pre">load</span></code></a>(self,&nbsp;string&nbsp;filename)</td>
<td>loading Topology from filename. This is for internal use. Should <code class="docutils literal"><span class="pre">pytraj.load_topology</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.residue" title="pytraj.Topology.residue"><code class="xref py py-obj docutils literal"><span class="pre">residue</span></code></a>(self,&nbsp;int&nbsp;idx,&nbsp;bool&nbsp;atom=False)</td>
<td>if atom is True, get full list of atoms for idx-th residue. This will be very slow</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.save" title="pytraj.Topology.save"><code class="xref py py-obj docutils literal"><span class="pre">save</span></code></a>(self[,&nbsp;filename,&nbsp;format])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.select" title="pytraj.Topology.select"><code class="xref py py-obj docutils literal"><span class="pre">select</span></code></a>(self,&nbsp;mask)</td>
<td>return AtomMask object</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.set_distance_mask_reference" title="pytraj.Topology.set_distance_mask_reference"><code class="xref py py-obj docutils literal"><span class="pre">set_distance_mask_reference</span></code></a>(self,&nbsp;Frame&nbsp;frame)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.set_integer_mask" title="pytraj.Topology.set_integer_mask"><code class="xref py py-obj docutils literal"><span class="pre">set_integer_mask</span></code></a>(self,&nbsp;AtomMask&nbsp;atm,&nbsp;...)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.set_nobox" title="pytraj.Topology.set_nobox"><code class="xref py py-obj docutils literal"><span class="pre">set_nobox</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.set_solvent" title="pytraj.Topology.set_solvent"><code class="xref py py-obj docutils literal"><span class="pre">set_solvent</span></code></a>(self,&nbsp;mask)</td>
<td>set <code class="docutils literal"><span class="pre">mask</span></code> as solvent</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.simplify" title="pytraj.Topology.simplify"><code class="xref py py-obj docutils literal"><span class="pre">simplify</span></code></a>(self)</td>
<td>get a light version (immutable) of Topology for fast iterating</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.start_new_mol" title="pytraj.Topology.start_new_mol"><code class="xref py py-obj docutils literal"><span class="pre">start_new_mol</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.strip" title="pytraj.Topology.strip"><code class="xref py py-obj docutils literal"><span class="pre">strip</span></code></a>(self,&nbsp;mask[,&nbsp;copy])</td>
<td>strip atoms with given mask</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.summary" title="pytraj.Topology.summary"><code class="xref py py-obj docutils literal"><span class="pre">summary</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.to_dataframe" title="pytraj.Topology.to_dataframe"><code class="xref py py-obj docutils literal"><span class="pre">to_dataframe</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Topology.to_dict" title="pytraj.Topology.to_dict"><code class="xref py py-obj docutils literal"><span class="pre">to_dict</span></code></a>(self)</td>
<td>convert Topology to Python dict</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Topology.to_parmed" title="pytraj.Topology.to_parmed"><code class="xref py py-obj docutils literal"><span class="pre">to_parmed</span></code></a>(self)</td>
<td>try to load to ParmEd&#8217;s Structure</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pytraj.Topology.add_angles">
<code class="descname">add_angles</code><a class="headerlink" href="#pytraj.Topology.add_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>add angle for a group of 3 atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>indices</strong> : 2D array_like (must have buffer interface),</p>
<blockquote class="last">
<div><p>shape=(n_atoms, 3)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.add_atom">
<code class="descname">add_atom</code><span class="sig-paren">(</span><em>self</em>, <em>Atom atom</em>, <em>Residue residue</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.add_atom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.add_bonds">
<code class="descname">add_bonds</code><a class="headerlink" href="#pytraj.Topology.add_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>add bond for pairs of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>bond_indices</strong> : 2D array_like (must have buffer interface)</p>
<blockquote class="last">
<div><p>shape=(n_atoms, 2)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.add_dihedrals">
<code class="descname">add_dihedrals</code><a class="headerlink" href="#pytraj.Topology.add_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>add dihedral for a group of 4 atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>indices</strong> : 2D array_like (must have buffer interface),</p>
<blockquote class="last">
<div><p>shape=(n_atoms, 3)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.angle_indices">
<code class="descname">angle_indices</code><a class="headerlink" href="#pytraj.Topology.angle_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.angles">
<code class="descname">angles</code><a class="headerlink" href="#pytraj.Topology.angles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.atom">
<code class="descname">atom</code><span class="sig-paren">(</span><em>self</em>, <em>int idx</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.atom" title="Permalink to this definition">¶</a></dt>
<dd><p>return an Atom based on idx. Update this Atom will update Topology.
Make this method private for now.</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.atom_indices">
<code class="descname">atom_indices</code><span class="sig-paren">(</span><em>self</em>, <em>mask</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.atom_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>return atom indices with given mask
To be the same as cpptraj/Ambertools: we mask indexing starts from 1
but the return list/array use 0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mask</strong> : str</p>
<blockquote>
<div><p>Atom mask</p>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>&#8212;&#8212;</strong></p>
<p class="last"><strong>indices</strong> : Python array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.atom_names">
<code class="descname">atom_names</code><a class="headerlink" href="#pytraj.Topology.atom_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.atomlist">
<code class="descname">atomlist</code><a class="headerlink" href="#pytraj.Topology.atomlist" title="Permalink to this definition">¶</a></dt>
<dd><p>return a copy of a list of atoms. If the Topology is large, this method calling
is every expensive. Make sure to save atomlist.</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#pytraj.Topology.atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.bond_indices">
<code class="descname">bond_indices</code><a class="headerlink" href="#pytraj.Topology.bond_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#pytraj.Topology.bonds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.box">
<code class="descname">box</code><a class="headerlink" href="#pytraj.Topology.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.charge">
<code class="descname">charge</code><a class="headerlink" href="#pytraj.Topology.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>return a copy of atom charges (numpy 1D array)</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>self</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>return a copy of &#8216;self&#8217; or copy from &#8216;other&#8217; to &#8216;self&#8217;
TODO : add more doc</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.dihedral_indices">
<code class="descname">dihedral_indices</code><a class="headerlink" href="#pytraj.Topology.dihedral_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.dihedrals">
<code class="descname">dihedrals</code><a class="headerlink" href="#pytraj.Topology.dihedrals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.filename">
<code class="descname">filename</code><a class="headerlink" href="#pytraj.Topology.filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.from_dict">
<code class="descname">from_dict</code><span class="sig-paren">(</span><em>type cls</em>, <em>dict_data</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.from_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.has_box">
<code class="descname">has_box</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.has_box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.indices_bonded_to">
<code class="descname">indices_bonded_to</code><span class="sig-paren">(</span><em>self</em>, <em>atom_name</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.indices_bonded_to" title="Permalink to this definition">¶</a></dt>
<dd><p>return indices of the number of atoms that each atom bonds to</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_name</strong> : name of the atom</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.is_empty">
<code class="descname">is_empty</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.is_empty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.join">
<code class="descname">join</code><span class="sig-paren">(</span><em>self</em>, <em>Topology top</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.join" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>self</em>, <em>string filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.load" title="Permalink to this definition">¶</a></dt>
<dd><p>loading Topology from filename. This is for internal use. Should <code class="docutils literal"><span class="pre">pytraj.load_topology</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.mass">
<code class="descname">mass</code><a class="headerlink" href="#pytraj.Topology.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>return a copy of atom masses (numpy 1D array)</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.moleculelist">
<code class="descname">moleculelist</code><a class="headerlink" href="#pytraj.Topology.moleculelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.mols">
<code class="descname">mols</code><a class="headerlink" href="#pytraj.Topology.mols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.Topology.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.n_mols">
<code class="descname">n_mols</code><a class="headerlink" href="#pytraj.Topology.n_mols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.n_residues">
<code class="descname">n_residues</code><a class="headerlink" href="#pytraj.Topology.n_residues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.n_solvents">
<code class="descname">n_solvents</code><a class="headerlink" href="#pytraj.Topology.n_solvents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.residue">
<code class="descname">residue</code><span class="sig-paren">(</span><em>self</em>, <em>int idx</em>, <em>bool atom=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.residue" title="Permalink to this definition">¶</a></dt>
<dd><p>if atom is True, get full list of atoms for idx-th residue. This will be very slow
if atom is False, get ()</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.residue_names">
<code class="descname">residue_names</code><a class="headerlink" href="#pytraj.Topology.residue_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.residuelist">
<code class="descname">residuelist</code><a class="headerlink" href="#pytraj.Topology.residuelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.residues">
<code class="descname">residues</code><a class="headerlink" href="#pytraj.Topology.residues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>self</em>, <em>filename=None</em>, <em>format='AMBERPARM'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.select">
<code class="descname">select</code><span class="sig-paren">(</span><em>self</em>, <em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.select" title="Permalink to this definition">¶</a></dt>
<dd><p>return AtomMask object</p>
<p class="rubric">Notes</p>
<p>support openmp for distance-based atommask selction</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atm</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;@CA&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atm</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">atm</span><span class="p">)</span>
<span class="go">array([  1.94667955e-07,   2.54596866e+00,   4.22333034e+00, ...,</span>
<span class="go">         4.97189564e+00,   5.53947712e+00,   4.83201237e+00])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.set_distance_mask_reference">
<code class="descname">set_distance_mask_reference</code><span class="sig-paren">(</span><em>self</em>, <em>Frame frame</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.set_distance_mask_reference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.set_integer_mask">
<code class="descname">set_integer_mask</code><span class="sig-paren">(</span><em>self</em>, <em>AtomMask atm</em>, <em>Frame frame=&lt;???&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.set_integer_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.set_nobox">
<code class="descname">set_nobox</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.set_nobox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.set_solvent">
<code class="descname">set_solvent</code><span class="sig-paren">(</span><em>self</em>, <em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.set_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>set <code class="docutils literal"><span class="pre">mask</span></code> as solvent</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.simplify">
<code class="descname">simplify</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>get a light version (immutable) of Topology for fast iterating</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.start_new_mol">
<code class="descname">start_new_mol</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.start_new_mol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.strip">
<code class="descname">strip</code><span class="sig-paren">(</span><em>self</em>, <em>mask</em>, <em>copy=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>strip atoms with given mask</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.summary">
<code class="descname">summary</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.summary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.to_dataframe">
<code class="descname">to_dataframe</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Topology.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>convert Topology to Python dict</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Topology.to_parmed">
<code class="descname">to_parmed</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Topology.to_parmed" title="Permalink to this definition">¶</a></dt>
<dd><p>try to load to ParmEd&#8217;s Structure</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Topology.vdw_radii">
<code class="descname">vdw_radii</code><a class="headerlink" href="#pytraj.Topology.vdw_radii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.Frame">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">Frame</code><a class="headerlink" href="#pytraj.Frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A snapshot of trajectory, hodling coordinates, unicell (box), vector (optional), force (optional), ...
This class is for internal use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n_atoms</strong> : int, default=0</p>
<blockquote>
<div><p>create a new Frame with n_atoms</p>
</div></blockquote>
<p><strong>frame</strong> : a Frame, default=None</p>
<blockquote>
<div><p>make a copy from <cite>frame</cite></p>
</div></blockquote>
<p><strong>atommask</strong> : AtomMask, default=None</p>
<blockquote class="last">
<div><p>make a copy from <cite>frame</cite> with atommask</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># create an empty Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Frame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># create a Frame with 304 atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="mi">304</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">304</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># create an empty Frame then append coordinate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Frame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">append_xyz</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>
<span class="go">&lt;Frame with 223 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">==</span> <span class="n">f0</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># copy from other Frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># create a Frame as a pointer (does not own any memory), used for fast iterating</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">f0</span><span class="o">.</span><span class="n">xyz</span><span class="p">,</span> <span class="n">_as_ptr</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">==</span> <span class="n">f0</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.box" title="pytraj.Frame.box"><code class="xref py py-obj docutils literal"><span class="pre">box</span></code></a></td>
<td>unitcell</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.coordinates" title="pytraj.Frame.coordinates"><code class="xref py py-obj docutils literal"><span class="pre">coordinates</span></code></a></td>
<td>return a copy of Frame&#8217;s coordinates</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.force" title="pytraj.Frame.force"><code class="xref py py-obj docutils literal"><span class="pre">force</span></code></a></td>
<td>force, default None</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.mass" title="pytraj.Frame.mass"><code class="xref py py-obj docutils literal"><span class="pre">mass</span></code></a></td>
<td>return mass array</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.n_atoms" title="pytraj.Frame.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.n_frames" title="pytraj.Frame.n_frames"><code class="xref py py-obj docutils literal"><span class="pre">n_frames</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.shape" title="pytraj.Frame.shape"><code class="xref py py-obj docutils literal"><span class="pre">shape</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.size" title="pytraj.Frame.size"><code class="xref py py-obj docutils literal"><span class="pre">size</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.temperature" title="pytraj.Frame.temperature"><code class="xref py py-obj docutils literal"><span class="pre">temperature</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.time" title="pytraj.Frame.time"><code class="xref py py-obj docutils literal"><span class="pre">time</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.top" title="pytraj.Frame.top"><code class="xref py py-obj docutils literal"><span class="pre">top</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.velocity" title="pytraj.Frame.velocity"><code class="xref py py-obj docutils literal"><span class="pre">velocity</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.xyz" title="pytraj.Frame.xyz"><code class="xref py py-obj docutils literal"><span class="pre">xyz</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.append_xyz" title="pytraj.Frame.append_xyz"><code class="xref py py-obj docutils literal"><span class="pre">append_xyz</span></code></a>(self,&nbsp;__Pyx_memviewslice&nbsp;xyz)</td>
<td>append 3D array and return itself</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.atom" title="pytraj.Frame.atom"><code class="xref py py-obj docutils literal"><span class="pre">atom</span></code></a>(self,&nbsp;int&nbsp;atomnum)</td>
<td>return xyz coordinates of idx-th atom</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.center_of_geometry" title="pytraj.Frame.center_of_geometry"><code class="xref py py-obj docutils literal"><span class="pre">center_of_geometry</span></code></a>(self,&nbsp;AtomMask&nbsp;atmask)</td>
<td>return Vec3 storing center of geometry</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.center_of_mass" title="pytraj.Frame.center_of_mass"><code class="xref py py-obj docutils literal"><span class="pre">center_of_mass</span></code></a>(self,&nbsp;AtomMask&nbsp;atmask)</td>
<td>return Vec3 storing center of mass</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.copy" title="pytraj.Frame.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>(self)</td>
<td>return a deep copy of Frame</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.has_box" title="pytraj.Frame.has_box"><code class="xref py py-obj docutils literal"><span class="pre">has_box</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.has_force" title="pytraj.Frame.has_force"><code class="xref py py-obj docutils literal"><span class="pre">has_force</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.has_velocity" title="pytraj.Frame.has_velocity"><code class="xref py py-obj docutils literal"><span class="pre">has_velocity</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.is_" title="pytraj.Frame.is_"><code class="xref py py-obj docutils literal"><span class="pre">is_</span></code></a>(self,&nbsp;Frame&nbsp;other)</td>
<td>check if Frame is itself or not</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.rmsd" title="pytraj.Frame.rmsd"><code class="xref py py-obj docutils literal"><span class="pre">rmsd</span></code></a>(self,&nbsp;Frame&nbsp;frame,&nbsp;AtomMask&nbsp;atommask=None)</td>
<td>Calculate rmsd betwen two frames</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.rmsd_nofit" title="pytraj.Frame.rmsd_nofit"><code class="xref py py-obj docutils literal"><span class="pre">rmsd_nofit</span></code></a>(self,&nbsp;Frame&nbsp;frame,&nbsp;bool&nbsp;mass=False)</td>
<td>Calculate rmsd betwen two frames without fitting</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.rmsfit" title="pytraj.Frame.rmsfit"><code class="xref py py-obj docutils literal"><span class="pre">rmsfit</span></code></a>(self[,&nbsp;ref])</td>
<td>do the fitting to reference Frame by rotation and translation</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.set_mass" title="pytraj.Frame.set_mass"><code class="xref py py-obj docutils literal"><span class="pre">set_mass</span></code></a>(self,&nbsp;Topology&nbsp;top)</td>
<td>set mass for Frame, requires a Topology</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.set_nobox" title="pytraj.Frame.set_nobox"><code class="xref py py-obj docutils literal"><span class="pre">set_nobox</span></code></a>(self)</td>
<td>set nobox</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.strip" title="pytraj.Frame.strip"><code class="xref py py-obj docutils literal"><span class="pre">strip</span></code></a>(self,&nbsp;AtomMask&nbsp;atm)</td>
<td>strip</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Frame.swap_atoms" title="pytraj.Frame.swap_atoms"><code class="xref py py-obj docutils literal"><span class="pre">swap_atoms</span></code></a></td>
<td>swap coordinates for an array of atom pairs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Frame.to_ndarray" title="pytraj.Frame.to_ndarray"><code class="xref py py-obj docutils literal"><span class="pre">to_ndarray</span></code></a>(self)</td>
<td>return a ndarray as a view of Frame&#8217;s coordinates</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.Frame.append_xyz">
<code class="descname">append_xyz</code><span class="sig-paren">(</span><em>self</em>, <em>__Pyx_memviewslice xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.append_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>append 3D array and return itself</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.atom">
<code class="descname">atom</code><span class="sig-paren">(</span><em>self</em>, <em>int atomnum</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.atom" title="Permalink to this definition">¶</a></dt>
<dd><p>return xyz coordinates of idx-th atom</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">array(&#39;d&#39;, [0.27399998903274536, 11.727999687194824, 8.701000213623047])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.box">
<code class="descname">box</code><a class="headerlink" href="#pytraj.Frame.box" title="Permalink to this definition">¶</a></dt>
<dd><p>unitcell</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.center_of_geometry">
<code class="descname">center_of_geometry</code><span class="sig-paren">(</span><em>self</em>, <em>AtomMask atmask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>return Vec3 storing center of geometry</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.center_of_mass">
<code class="descname">center_of_mass</code><span class="sig-paren">(</span><em>self</em>, <em>AtomMask atmask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>return Vec3 storing center of mass</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.coordinates">
<code class="descname">coordinates</code><a class="headerlink" href="#pytraj.Frame.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>return a copy of Frame&#8217;s coordinates</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>return a deep copy of Frame</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.force">
<code class="descname">force</code><a class="headerlink" href="#pytraj.Frame.force" title="Permalink to this definition">¶</a></dt>
<dd><p>force, default None</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.has_box">
<code class="descname">has_box</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.has_box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Frame.has_force">
<code class="descname">has_force</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.has_force" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Frame.has_velocity">
<code class="descname">has_velocity</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.has_velocity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Frame.is_">
<code class="descname">is_</code><span class="sig-paren">(</span><em>self</em>, <em>Frame other</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.is_" title="Permalink to this definition">¶</a></dt>
<dd><p>check if Frame is itself or not</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.mass">
<code class="descname">mass</code><a class="headerlink" href="#pytraj.Frame.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>return mass array</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.Frame.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.n_frames">
<code class="descname">n_frames</code><a class="headerlink" href="#pytraj.Frame.n_frames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Frame.rmsd">
<code class="descname">rmsd</code><span class="sig-paren">(</span><em>self</em>, <em>Frame frame</em>, <em>AtomMask atommask=None</em>, <em>mask=None</em>, <em>top=None</em>, <em>bool mass=False</em>, <em>get_mvv=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate rmsd betwen two frames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>frame</strong> : Frame instance</p>
<p><strong>mass</strong> : bool, default = False</p>
<p><strong>get_mvv</strong> : bool</p>
<blockquote class="last">
<div><p>if True: return rmsd, Matrix_3x3, Vec3, Vec3
if False: return rmsd</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.rmsd_nofit">
<code class="descname">rmsd_nofit</code><span class="sig-paren">(</span><em>self</em>, <em>Frame frame</em>, <em>bool mass=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.rmsd_nofit" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate rmsd betwen two frames without fitting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>frame</strong> : Frame instance</p>
<p class="last"><strong>mass</strong> : bool, default = False</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.rmsfit">
<code class="descname">rmsfit</code><span class="sig-paren">(</span><em>self</em>, <em>ref=None</em>, <em>AtomMask atm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.rmsfit" title="Permalink to this definition">¶</a></dt>
<dd><p>do the fitting to reference Frame by rotation and translation</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.set_mass">
<code class="descname">set_mass</code><span class="sig-paren">(</span><em>self</em>, <em>Topology top</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.set_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>set mass for Frame, requires a Topology</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Frame.set_nobox">
<code class="descname">set_nobox</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.set_nobox" title="Permalink to this definition">¶</a></dt>
<dd><p>set nobox</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">box</span>
<span class="go">&lt;Box: ortho, (x, y, z, alpha, beta, gamma) = (35.262779662258, 41.845547679864616, 36.16862952899312, 90.0, 90.0, 90.0)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">set_nobox</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">box</span>
<span class="go">&lt;Box: nobox, (x, y, z, alpha, beta, gamma) = (0.0, 0.0, 0.0, 0.0, 0.0, 0.0)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.shape">
<code class="descname">shape</code><a class="headerlink" href="#pytraj.Frame.shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.size">
<code class="descname">size</code><a class="headerlink" href="#pytraj.Frame.size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Frame.strip">
<code class="descname">strip</code><span class="sig-paren">(</span><em>self</em>, <em>AtomMask atm</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>strip</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atm: AtomMask</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.swap_atoms">
<code class="descname">swap_atoms</code><a class="headerlink" href="#pytraj.Frame.swap_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>swap coordinates for an array of atom pairs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>int_view: 2D-int array-like, shape=(2, n_atoms)</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.temperature">
<code class="descname">temperature</code><a class="headerlink" href="#pytraj.Frame.temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.time">
<code class="descname">time</code><a class="headerlink" href="#pytraj.Frame.time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Frame.to_ndarray">
<code class="descname">to_ndarray</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Frame.to_ndarray" title="Permalink to this definition">¶</a></dt>
<dd><p>return a ndarray as a view of Frame&#8217;s coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.top">
<code class="descname">top</code><a class="headerlink" href="#pytraj.Frame.top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.velocity">
<code class="descname">velocity</code><a class="headerlink" href="#pytraj.Frame.velocity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Frame.xyz">
<code class="descname">xyz</code><a class="headerlink" href="#pytraj.Frame.xyz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.AtomMask">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">AtomMask</code><a class="headerlink" href="#pytraj.AtomMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AtomMask.indices" title="pytraj.AtomMask.indices"><code class="xref py py-obj docutils literal"><span class="pre">indices</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.AtomMask.mask_string" title="pytraj.AtomMask.mask_string"><code class="xref py py-obj docutils literal"><span class="pre">mask_string</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AtomMask.n_atoms" title="pytraj.AtomMask.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.AtomMask.n_selected" title="pytraj.AtomMask.n_selected"><code class="xref py py-obj docutils literal"><span class="pre">n_selected</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AtomMask.add_atom" title="pytraj.AtomMask.add_atom"><code class="xref py py-obj docutils literal"><span class="pre">add_atom</span></code></a>(self,&nbsp;int&nbsp;atom_num)</td>
<td>add atom index and sort</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.AtomMask.add_atom_range" title="pytraj.AtomMask.add_atom_range"><code class="xref py py-obj docutils literal"><span class="pre">add_atom_range</span></code></a>(self,&nbsp;int&nbsp;begin,&nbsp;int&nbsp;end)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AtomMask.add_atoms" title="pytraj.AtomMask.add_atoms"><code class="xref py py-obj docutils literal"><span class="pre">add_atoms</span></code></a>(self,&nbsp;vector[int]&nbsp;v)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.AtomMask.add_selected_indices" title="pytraj.AtomMask.add_selected_indices"><code class="xref py py-obj docutils literal"><span class="pre">add_selected_indices</span></code></a>(self,&nbsp;arr0)</td>
<td>add atom index without sorting</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AtomMask.invert_mask" title="pytraj.AtomMask.invert_mask"><code class="xref py py-obj docutils literal"><span class="pre">invert_mask</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.AtomMask.is_empty" title="pytraj.AtomMask.is_empty"><code class="xref py py-obj docutils literal"><span class="pre">is_empty</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AtomMask.mask_expression" title="pytraj.AtomMask.mask_expression"><code class="xref py py-obj docutils literal"><span class="pre">mask_expression</span></code></a>(self)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.AtomMask.selected_indices" title="pytraj.AtomMask.selected_indices"><code class="xref py py-obj docutils literal"><span class="pre">selected_indices</span></code></a>(self)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.AtomMask.add_atom">
<code class="descname">add_atom</code><span class="sig-paren">(</span><em>self</em>, <em>int atom_num</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>add atom index and sort</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.add_atom_range">
<code class="descname">add_atom_range</code><span class="sig-paren">(</span><em>self</em>, <em>int begin</em>, <em>int end</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.add_atom_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.add_atoms">
<code class="descname">add_atoms</code><span class="sig-paren">(</span><em>self</em>, <em>vector[int] v</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.add_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.add_selected_indices">
<code class="descname">add_selected_indices</code><span class="sig-paren">(</span><em>self</em>, <em>arr0</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.add_selected_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>add atom index without sorting</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.AtomMask.add_atom" title="pytraj.AtomMask.add_atom"><code class="xref py py-obj docutils literal"><span class="pre">add_atom</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.AtomMask.indices">
<code class="descname">indices</code><a class="headerlink" href="#pytraj.AtomMask.indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.invert_mask">
<code class="descname">invert_mask</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.invert_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.is_empty">
<code class="descname">is_empty</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.is_empty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.mask_expression">
<code class="descname">mask_expression</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.mask_expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.AtomMask.mask_string">
<code class="descname">mask_string</code><a class="headerlink" href="#pytraj.AtomMask.mask_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.AtomMask.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.AtomMask.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.AtomMask.n_selected">
<code class="descname">n_selected</code><a class="headerlink" href="#pytraj.AtomMask.n_selected" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.AtomMask.selected_indices">
<code class="descname">selected_indices</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AtomMask.selected_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.Trajectory">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">Trajectory</code><span class="sig-paren">(</span><em>filename=None</em>, <em>top=None</em>, <em>xyz=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Simple in-memory Trajectory. It has only information about 3D coordinates
and unitcells (no time, no velocity, no force, ...)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: str, trajectory filename</strong></p>
<p><strong>top</strong> : Topology</p>
<p><strong>xyz: 3D-array</strong></p>
<blockquote class="last">
<div><p>if filename is not given, pytraj will construct Trajectory from given
Topology and given xyz array.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from filename and topology name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># load from a list of filenames</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">([</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">],</span> <span class="n">tn</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># load from 3D array-like</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj_1</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># get new Trajectory with only CA atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="p">[</span><span class="s">&#39;@CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">array([[  3.970048 ,   7.6400076,  10.1610562]])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># iterate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.n_atoms" title="pytraj.Trajectory.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.n_frames" title="pytraj.Trajectory.n_frames"><code class="xref py py-obj docutils literal"><span class="pre">n_frames</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.shape" title="pytraj.Trajectory.shape"><code class="xref py py-obj docutils literal"><span class="pre">shape</span></code></a></td>
<td>(n_frames, n_atoms, 3)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.top" title="pytraj.Trajectory.top"><code class="xref py py-obj docutils literal"><span class="pre">top</span></code></a></td>
<td>Topology (having info about atom, residue, ...)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.topology" title="pytraj.Trajectory.topology"><code class="xref py py-obj docutils literal"><span class="pre">topology</span></code></a></td>
<td>Topology (having info about atom, residue, ...)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.unitcells" title="pytraj.Trajectory.unitcells"><code class="xref py py-obj docutils literal"><span class="pre">unitcells</span></code></a></td>
<td>return 2D ndarray, shape=(n_frames, 6)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.xyz" title="pytraj.Trajectory.xyz"><code class="xref py py-obj docutils literal"><span class="pre">xyz</span></code></a></td>
<td>Trajectory&#8217;s coordinates, shape=(n_frames, n_frames, 3), dtype=&#8217;f8&#8217;</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code>(*args,&nbsp;**kwd)</td>
<td>shortcut of <code class="docutils literal"><span class="pre">iterframe</span></code> method</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.align_principal_axis" title="pytraj.Trajectory.align_principal_axis"><code class="xref py py-obj docutils literal"><span class="pre">align_principal_axis</span></code></a>([command])</td>
<td>align principal axis</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.append" title="pytraj.Trajectory.append"><code class="xref py py-obj docutils literal"><span class="pre">append</span></code></a>(other)</td>
<td>other: xyz, Frame, Trajectory, ...</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.append_xyz" title="pytraj.Trajectory.append_xyz"><code class="xref py py-obj docutils literal"><span class="pre">append_xyz</span></code></a>(xyz)</td>
<td>append 3D numpy array</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.at" title="pytraj.Trajectory.at"><code class="xref py py-obj docutils literal"><span class="pre">at</span></code></a>(index)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.autoimage" title="pytraj.Trajectory.autoimage"><code class="xref py py-obj docutils literal"><span class="pre">autoimage</span></code></a>([command])</td>
<td>perform autoimage</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.center" title="pytraj.Trajectory.center"><code class="xref py py-obj docutils literal"><span class="pre">center</span></code></a>([command])</td>
<td>do centering</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.copy" title="pytraj.Trajectory.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>()</td>
<td>return a deep copy of trajectory</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.from_iterable" title="pytraj.Trajectory.from_iterable"><code class="xref py py-obj docutils literal"><span class="pre">from_iterable</span></code></a>(iterables[,&nbsp;top])</td>
<td>create a new Trajectory from iterable (produce Frame)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.iterframe" title="pytraj.Trajectory.iterframe"><code class="xref py py-obj docutils literal"><span class="pre">iterframe</span></code></a>([start,&nbsp;stop,&nbsp;step,&nbsp;mask,&nbsp;...])</td>
<td>iterate trajectory with given frame_indices or given (start, stop, step)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.load" title="pytraj.Trajectory.load"><code class="xref py py-obj docutils literal"><span class="pre">load</span></code></a>([filename])</td>
<td>load file or files. This is for internal use. User should always use</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.reverse" title="pytraj.Trajectory.reverse"><code class="xref py py-obj docutils literal"><span class="pre">reverse</span></code></a>()</td>
<td>reverse Trajectory</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.rmsfit" title="pytraj.Trajectory.rmsfit"><code class="xref py py-obj docutils literal"><span class="pre">rmsfit</span></code></a>(*args,&nbsp;**kwd)</td>
<td>do the fitting to reference Frame by rotation and translation</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.rotate" title="pytraj.Trajectory.rotate"><code class="xref py py-obj docutils literal"><span class="pre">rotate</span></code></a>([command])</td>
<td>do rotation</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.save" title="pytraj.Trajectory.save"><code class="xref py py-obj docutils literal"><span class="pre">save</span></code></a>([filename,&nbsp;overwrite])</td>
<td>write trajectory to disk with given format.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.scale" title="pytraj.Trajectory.scale"><code class="xref py py-obj docutils literal"><span class="pre">scale</span></code></a>([command])</td>
<td>do scaling</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.strip" title="pytraj.Trajectory.strip"><code class="xref py py-obj docutils literal"><span class="pre">strip</span></code></a>(mask)</td>
<td>strip atoms with given mask</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.superpose" title="pytraj.Trajectory.superpose"><code class="xref py py-obj docutils literal"><span class="pre">superpose</span></code></a>([mask,&nbsp;ref,&nbsp;frame_indices,&nbsp;mass])</td>
<td>do the fitting to reference Frame by rotation and translation</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.Trajectory.transform" title="pytraj.Trajectory.transform"><code class="xref py py-obj docutils literal"><span class="pre">transform</span></code></a>(commands[,&nbsp;frame_indices])</td>
<td>apply a series of cpptraj commands to trajectory</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.Trajectory.translate" title="pytraj.Trajectory.translate"><code class="xref py py-obj docutils literal"><span class="pre">translate</span></code></a>([command])</td>
<td>do translation</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.Trajectory.align_principal_axis">
<code class="descname">align_principal_axis</code><span class="sig-paren">(</span><em>command=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.align_principal_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>align principal axis</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">align_principal_axis</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.append" title="Permalink to this definition">¶</a></dt>
<dd><p>other: xyz, Frame, Trajectory, ...</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li>Can not append TrajectoryIterator object since we use Trajectory in TrajectoryIterator class</li>
<li>This method is not well optimized for speed.</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">traj</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">xyz</span><span class="p">,]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">22</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.append_xyz">
<code class="descname">append_xyz</code><span class="sig-paren">(</span><em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.append_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>append 3D numpy array</p>
<p class="rubric">Notes</p>
<p>This method is not well optimized for speed.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">append_xyz</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">append_xyz</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.at">
<code class="descname">at</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.at" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.autoimage">
<code class="descname">autoimage</code><span class="sig-paren">(</span><em>command=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.autoimage" title="Permalink to this definition">¶</a></dt>
<dd><p>perform autoimage</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span><span class="p">;</span> <span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">*</span><span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">has_box</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">autoimage</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.center">
<code class="descname">center</code><span class="sig-paren">(</span><em>command=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.center" title="Permalink to this definition">¶</a></dt>
<dd><p>do centering</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="s">&#39;@CA origin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>return a deep copy of trajectory</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_rna</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">t0</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="pytraj.Trajectory.from_iterable">
<em class="property">classmethod </em><code class="descname">from_iterable</code><span class="sig-paren">(</span><em>iterables</em>, <em>top=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.from_iterable" title="Permalink to this definition">¶</a></dt>
<dd><p>create a new Trajectory from iterable (produce Frame)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">traj</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj</span> <span class="k">import</span> <span class="n">pipe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;autoimage&#39;</span><span class="p">,</span> <span class="s">&#39;rms&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">radgyr</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
<span class="go">array([ 18.90953437,  18.93564662,  18.85415458,  18.90994856,</span>
<span class="go">        18.85884218,  18.88551081,  18.9364612 ,  18.89353463,</span>
<span class="go">        18.91772124,  18.87070283])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.iterframe">
<code class="descname">iterframe</code><span class="sig-paren">(</span><em>start=0</em>, <em>stop=None</em>, <em>step=1</em>, <em>mask=None</em>, <em>autoimage=False</em>, <em>frame_indices=None</em>, <em>rmsfit=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.iterframe" title="Permalink to this definition">¶</a></dt>
<dd><p>iterate trajectory with given frame_indices or given (start, stop, step)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>start</strong> : int, default 0</p>
<p><strong>stop</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if None, iterate to final frame</p>
</div></blockquote>
<p><strong>step</strong> : int, default 1</p>
<p><strong>mask</strong> : {None, str}, default None</p>
<blockquote>
<div><p>if None, use all atoms. If not None, use given mask</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote>
<div><p>if True, perform autoimage for each frame</p>
</div></blockquote>
<p><strong>rmsfit</strong> : {None, int, tuple}, default None</p>
<blockquote>
<div><p>if not None, perform superpose each Frame to to reference.</p>
</div></blockquote>
<p><strong>frame_indices</strong> : {None, array-like}</p>
<blockquote class="last">
<div><p>if not None, iterate trajectory for given indices. If frame_indices is given,
(start, stop, step) will be ignored.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">*</span><span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># use negative index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># mask is atom indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.load" title="Permalink to this definition">¶</a></dt>
<dd><p>load file or files. This is for internal use. User should always use
<code class="docutils literal"><span class="pre">pytraj.load</span></code> (or <code class="docutils literal"><span class="pre">iterload</span></code>) method</p>
<p class="rubric">Notes</p>
<p>It&#8217;s better to use <code class="docutils literal"><span class="pre">pytraj.load</span></code> method</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">tname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">5293</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span><span class="p">,</span> <span class="n">tname</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_topology</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">5293</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># from list/tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">fname</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">load</span><span class="p">((</span><span class="n">fname</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.Trajectory.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.n_frames">
<code class="descname">n_frames</code><a class="headerlink" href="#pytraj.Trajectory.n_frames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.reverse">
<code class="descname">reverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>reverse Trajectory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.rmsfit">
<code class="descname">rmsfit</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.rmsfit" title="Permalink to this definition">¶</a></dt>
<dd><p>do the fitting to reference Frame by rotation and translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ref</strong> : {Frame, int}, default=None (first Frame)</p>
<blockquote>
<div><p>Reference</p>
</div></blockquote>
<p><strong>mask</strong> : str or AtomMask object, default=&#8217;*&#8217; (fit all atoms)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">self</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>this is alias of superpose</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">rmsfit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># fit to 1st frame </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">rmsfit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span> <span class="c"># fit to last frame using @CA atoms </span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>command=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>do rotation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="s">&#39;@CA x 20&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename=''</em>, <em>overwrite=False</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.save" title="Permalink to this definition">¶</a></dt>
<dd><p>write trajectory to disk with given format.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../read_and_write.html#pytraj.write_traj" title="pytraj.write_traj"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.write_traj</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_rna</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># write to netcdf file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;output/out.nc&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.scale">
<code class="descname">scale</code><span class="sig-paren">(</span><em>command=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>do scaling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="s">&#39;@CA x 1.2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.shape">
<code class="descname">shape</code><a class="headerlink" href="#pytraj.Trajectory.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>(n_frames, n_atoms, 3)</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.strip">
<code class="descname">strip</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>strip atoms with given mask</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">34</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;!@CA&#39;</span><span class="p">)</span> <span class="c"># keep only CA atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.superpose">
<code class="descname">superpose</code><span class="sig-paren">(</span><em>mask='*'</em>, <em>ref=None</em>, <em>frame_indices=None</em>, <em>mass=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.superpose" title="Permalink to this definition">¶</a></dt>
<dd><p>do the fitting to reference Frame by rotation and translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ref</strong> : {Frame object, int, str}, default=None</p>
<blockquote>
<div><p>Reference</p>
</div></blockquote>
<p><strong>mask</strong> : str or AtomMask object, default=&#8217;*&#8217; (fit all atoms)</p>
<p><strong>frame_indices</strong> : array-like, default None, optional</p>
<blockquote>
<div><p>if not None, only do fitting for specific frames</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">self</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">*</span><span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">superpose</span><span class="p">()</span> <span class="c"># fit to 1st frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c"># fit to 1st frame, explitly specify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">superpose</span><span class="p">(</span><span class="n">ref</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">)</span> <span class="c"># fit to last frame using @CA atoms</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.top">
<code class="descname">top</code><a class="headerlink" href="#pytraj.Trajectory.top" title="Permalink to this definition">¶</a></dt>
<dd><p>Topology (having info about atom, residue, ...)</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.Trajectory.topology" title="pytraj.Trajectory.topology"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.Trajectory.topology</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.topology">
<code class="descname">topology</code><a class="headerlink" href="#pytraj.Trajectory.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Topology (having info about atom, residue, ...)</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.Trajectory.topology" title="pytraj.Trajectory.topology"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.Trajectory.topology</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>commands</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>apply a series of cpptraj commands to trajectory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 15.55458927,  28.54844856,  17.18908691])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s">&#39;autoimage&#39;</span><span class="p">,</span> <span class="s">&#39;center @CA origin&#39;</span><span class="p">,</span> <span class="s">&#39;translate x 1.2&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">array([-1.19438073,  8.75046229, -1.82742397])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># which is similiar to below:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c"># before transforming</span>
<span class="go">array([ 15.55458927,  28.54844856,  17.18908691])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj2</span><span class="o">.</span><span class="n">autoimage</span><span class="p">()</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="s">&#39;@CA origin&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s">&#39;x 1.2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">traj2</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c"># after transforming</span>
<span class="go">array([-1.19438073,  8.75046229, -1.82742397])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.Trajectory.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>command=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.Trajectory.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>do translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s">&#39;@CA x 1.2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.unitcells">
<code class="descname">unitcells</code><a class="headerlink" href="#pytraj.Trajectory.unitcells" title="Permalink to this definition">¶</a></dt>
<dd><p>return 2D ndarray, shape=(n_frames, 6)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">unitcells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 35.26277966,  41.84554768,  36.16862953,  90.        ,</span>
<span class="go">        90.        ,  90.        ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.Trajectory.xyz">
<code class="descname">xyz</code><a class="headerlink" href="#pytraj.Trajectory.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Trajectory&#8217;s coordinates, shape=(n_frames, n_frames, 3), dtype=&#8217;f8&#8217;</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj0</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_ala3</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">traj0</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="n">traj0</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;f8&#39;</span><span class="p">),</span> <span class="n">top</span><span class="o">=</span><span class="n">traj0</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">traj0</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># autoconvert from fortran order to c order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">traj0</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj1</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.TrajectoryIterator">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">TrajectoryIterator</code><span class="sig-paren">(</span><em>filename=None</em>, <em>top=None</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.TrajectoryIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">pytraj.c_traj.c_trajectory.TrajectoryCpptraj</span></code></p>
<p>out-of-core trajectory holder.</p>
<p class="rubric">Notes</p>
<p>It&#8217;s a bit tricky to pickle this class. As default, new TrajectoryIterator will
use original trj filename and top filename. If set _pickle_topology to True, its
Topology will be pickled (slow but more accurate if you change the topology in the
fly)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj_name</span><span class="p">,</span> <span class="n">top_name</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">(</span><span class="n">traj_name</span><span class="p">,</span> <span class="n">top_name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># user should always use :method:`pytraj.iterload` to load TrajectoryIterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">([</span><span class="s">&#39;remd.x.000&#39;</span><span class="p">,</span> <span class="s">&#39;remd.x.001&#39;</span><span class="p">],</span> <span class="s">&#39;input.parm7&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.filelist" title="pytraj.TrajectoryIterator.filelist"><code class="xref py py-obj docutils literal"><span class="pre">filelist</span></code></a></td>
<td>return a list of input filenames. Order does matter</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.filename" title="pytraj.TrajectoryIterator.filename"><code class="xref py py-obj docutils literal"><span class="pre">filename</span></code></a></td>
<td>return 1st filename in filelist. For testing only</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.metadata" title="pytraj.TrajectoryIterator.metadata"><code class="xref py py-obj docutils literal"><span class="pre">metadata</span></code></a></td>
<td>return a dict of general information</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.n_atoms" title="pytraj.TrajectoryIterator.n_atoms"><code class="xref py py-obj docutils literal"><span class="pre">n_atoms</span></code></a></td>
<td>used for frame_iter</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.n_frames" title="pytraj.TrajectoryIterator.n_frames"><code class="xref py py-obj docutils literal"><span class="pre">n_frames</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.shape" title="pytraj.TrajectoryIterator.shape"><code class="xref py py-obj docutils literal"><span class="pre">shape</span></code></a></td>
<td>(n_frames, n_atoms, 3)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.temperatures" title="pytraj.TrajectoryIterator.temperatures"><code class="xref py py-obj docutils literal"><span class="pre">temperatures</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.top" title="pytraj.TrajectoryIterator.top"><code class="xref py py-obj docutils literal"><span class="pre">top</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.topology" title="pytraj.TrajectoryIterator.topology"><code class="xref py py-obj docutils literal"><span class="pre">topology</span></code></a></td>
<td>traditional name for Topology file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.unitcells" title="pytraj.TrajectoryIterator.unitcells"><code class="xref py py-obj docutils literal"><span class="pre">unitcells</span></code></a></td>
<td>return unitcells (Box) with shape=(n_frames, 6)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.xyz" title="pytraj.TrajectoryIterator.xyz"><code class="xref py py-obj docutils literal"><span class="pre">xyz</span></code></a></td>
<td>return 3D array of coordinates</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code></td>
<td>Call self as a function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.at" title="pytraj.TrajectoryIterator.at"><code class="xref py py-obj docutils literal"><span class="pre">at</span></code></a>(index)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.copy" title="pytraj.TrajectoryIterator.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>()</td>
<td>return a deep copy. Use this method with care since the copied traj just reuse</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.iterchunk" title="pytraj.TrajectoryIterator.iterchunk"><code class="xref py py-obj docutils literal"><span class="pre">iterchunk</span></code></a>([chunksize,&nbsp;start,&nbsp;stop,&nbsp;...])</td>
<td>iterate trajectory by chunk</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.iterframe" title="pytraj.TrajectoryIterator.iterframe"><code class="xref py py-obj docutils literal"><span class="pre">iterframe</span></code></a>([start,&nbsp;stop,&nbsp;step,&nbsp;mask,&nbsp;...])</td>
<td>iterate trajectory with given frame_indices or given (start, stop, step)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.TrajectoryIterator.save" title="pytraj.TrajectoryIterator.save"><code class="xref py py-obj docutils literal"><span class="pre">save</span></code></a>(self[,&nbsp;filename,&nbsp;overwrite])</td>
<td>convenient method to save Trajectory</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.TrajectoryIterator.at">
<code class="descname">at</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.TrajectoryIterator.at" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.TrajectoryIterator.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.TrajectoryIterator.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>return a deep copy. Use this method with care since the copied traj just reuse
the filenames</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.filelist">
<code class="descname">filelist</code><a class="headerlink" href="#pytraj.TrajectoryIterator.filelist" title="Permalink to this definition">¶</a></dt>
<dd><p>return a list of input filenames. Order does matter</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.filename">
<code class="descname">filename</code><a class="headerlink" href="#pytraj.TrajectoryIterator.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>return 1st filename in filelist. For testing only</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.TrajectoryIterator.iterchunk">
<code class="descname">iterchunk</code><span class="sig-paren">(</span><em>chunksize=2</em>, <em>start=0</em>, <em>stop=-1</em>, <em>autoimage=False</em>, <em>rmsfit=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.TrajectoryIterator.iterchunk" title="Permalink to this definition">¶</a></dt>
<dd><p>iterate trajectory by chunk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chunk</strong> : int, default=2</p>
<blockquote>
<div><p>size of each chunk. Notes: final chunk&#8217;s size might be changed</p>
</div></blockquote>
<p><strong>start</strong> : int, default=0 (first frame)</p>
<p><strong>stop</strong> : int, default=-1 (last frame)</p>
<p><strong>autoimage</strong> : bool, default=False</p>
<p class="last"><strong>rmsfit</strong> : None | tuple/list of (reference frame, mask)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if using &#8216;autoimage` with reference frame for rms-fit, make sure to <cite>autoimage</cite>
ref first</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">rmsfit</span><span class="o">=</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)):</span> <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.TrajectoryIterator.iterframe">
<code class="descname">iterframe</code><span class="sig-paren">(</span><em>start=0</em>, <em>stop=None</em>, <em>step=1</em>, <em>mask=None</em>, <em>autoimage=False</em>, <em>rmsfit=None</em>, <em>copy=False</em>, <em>frame_indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.TrajectoryIterator.iterframe" title="Permalink to this definition">¶</a></dt>
<dd><p>iterate trajectory with given frame_indices or given (start, stop, step)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>start</strong> : int, default 0</p>
<p><strong>stop</strong> : {None, int}, default None</p>
<blockquote>
<div><p>if None, iterate to final frame</p>
</div></blockquote>
<p><strong>step</strong> : int, default 1</p>
<p><strong>mask</strong> : {None, str}, default None</p>
<blockquote>
<div><p>if None, use all atoms. If not None, use given mask</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote>
<div><p>if True, perform autoimage for each frame</p>
</div></blockquote>
<p><strong>rmsfit</strong> : {None, int, tuple}, default None</p>
<blockquote>
<div><p>if not None, perform superpose each Frame to to reference.</p>
</div></blockquote>
<p><strong>frame_indices</strong> : {None, array-like}</p>
<blockquote class="last">
<div><p>if not None, iterate trajectory for given indices. If frame_indices is given,
(start, stop, step) will be ignored.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">load_sample_data</span><span class="p">(</span><span class="s">&#39;tz2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># use negative index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span><span class="o">.</span><span class="n">n_frames</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># mask is atom indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span><span class="o">.</span><span class="n">n_atoms</span>
<span class="go">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.metadata">
<code class="descname">metadata</code><a class="headerlink" href="#pytraj.TrajectoryIterator.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>return a dict of general information</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">{&#39;box_type&#39;: &#39;ortho&#39;,</span>
<span class="go"> &#39;has_box&#39;: True,</span>
<span class="go"> &#39;has_force&#39;: False,</span>
<span class="go"> &#39;has_replcica_dims&#39;: False,</span>
<span class="go"> &#39;has_temperature&#39;: False,</span>
<span class="go"> &#39;has_time&#39;: True,</span>
<span class="go"> &#39;has_velocity&#39;: False,</span>
<span class="go"> &#39;n_atoms&#39;: 5293,</span>
<span class="go"> &#39;n_frames&#39;: 10}</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#pytraj.TrajectoryIterator.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>used for frame_iter</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.n_frames">
<code class="descname">n_frames</code><a class="headerlink" href="#pytraj.TrajectoryIterator.n_frames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pytraj.TrajectoryIterator.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>self</em>, <em>filename=''</em>, <em>overwrite=True</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.TrajectoryIterator.save" title="Permalink to this definition">¶</a></dt>
<dd><p>convenient method to save Trajectory</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># save to DCD file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;traj.dcd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># save to AMBER netcdf file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;traj.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.shape">
<code class="descname">shape</code><a class="headerlink" href="#pytraj.TrajectoryIterator.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>(n_frames, n_atoms, 3)</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(10, 5293, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.temperatures">
<code class="descname">temperatures</code><a class="headerlink" href="#pytraj.TrajectoryIterator.temperatures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.top">
<code class="descname">top</code><a class="headerlink" href="#pytraj.TrajectoryIterator.top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.topology">
<code class="descname">topology</code><a class="headerlink" href="#pytraj.TrajectoryIterator.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>traditional name for Topology file</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytraj.testing</span> <span class="k">import</span> <span class="n">get_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span><span class="p">,</span> <span class="n">tname</span> <span class="o">=</span> <span class="n">get_fn</span><span class="p">(</span><span class="s">&#39;ala3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterload</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">tname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span><span class="o">.</span><span class="n">topology</span>
<span class="go">&lt;Topology: 34 atoms, 3 residues, 1 mols, non-PBC&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">TrajectoryIterator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span><span class="o">.</span><span class="n">topology</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_traj</span><span class="o">.</span><span class="n">_load</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.unitcells">
<code class="descname">unitcells</code><a class="headerlink" href="#pytraj.TrajectoryIterator.unitcells" title="Permalink to this definition">¶</a></dt>
<dd><p>return unitcells (Box) with shape=(n_frames, 6)</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.TrajectoryIterator.xyz">
<code class="descname">xyz</code><a class="headerlink" href="#pytraj.TrajectoryIterator.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>return 3D array of coordinates</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.ActionList">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">ActionList</code><span class="sig-paren">(</span><em>commands=None</em>, <em>Topology top=None</em>, <em>DatasetList dslist=&lt;???&gt;</em>, <em>DataFileList dflist=&lt;???&gt;</em>, <em>crdinfo={}</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.ActionList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.ActionList.data" title="pytraj.ActionList.data"><code class="xref py py-obj docutils literal"><span class="pre">data</span></code></a></td>
<td>Store data (CpptrajDatasetList).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.ActionList.n_frames" title="pytraj.ActionList.n_frames"><code class="xref py py-obj docutils literal"><span class="pre">n_frames</span></code></a></td>
<td>n_frames: &#8216;unsigned int&#8217;</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.ActionList.add" title="pytraj.ActionList.add"><code class="xref py py-obj docutils literal"><span class="pre">add</span></code></a>(self[,&nbsp;action,&nbsp;command,&nbsp;top,&nbsp;check_status])</td>
<td>Add action to ActionList</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pytraj.ActionList.check_topology" title="pytraj.ActionList.check_topology"><code class="xref py py-obj docutils literal"><span class="pre">check_topology</span></code></a>(self,&nbsp;Topology&nbsp;top[,&nbsp;...])</td>
<td>perform Topology checking and some stuff</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.ActionList.compute" title="pytraj.ActionList.compute"><code class="xref py py-obj docutils literal"><span class="pre">compute</span></code></a>(self[,&nbsp;traj])</td>
<td>perform a series of Actions on Frame or Trajectory</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.ActionList.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>self</em>, <em>action=''</em>, <em>command=''</em>, <em>top=None</em>, <em>DatasetList dslist=&lt;???&gt;</em>, <em>DataFileList dflist=&lt;???&gt;</em>, <em>check_status=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.ActionList.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add action to ActionList</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>action</strong> : str or Action object</p>
<p><strong>command</strong> : str or ArgList object</p>
<p><strong>top</strong> : str | Topology | TopologyList</p>
<p><strong>dslist</strong> : DatasetList</p>
<p><strong>dflist</strong> : DataFileList</p>
<p><strong>check_status</strong> : bool, default=False</p>
<blockquote class="last">
<div><p>return status of Action (0 or 1) if &#8220;True&#8221;</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">actlist</span> <span class="o">=</span> <span class="n">ActionList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actlist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;radgyr&#39;</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">dslist</span><span class="o">=</span><span class="n">dslist</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytraj.ActionList.check_topology">
<code class="descname">check_topology</code><span class="sig-paren">(</span><em>self</em>, <em>Topology top</em>, <em>crdinfo={}</em>, <em>n_frames_t=0</em>, <em>bool exit_on_error=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.ActionList.check_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>perform Topology checking and some stuff</p>
</dd></dl>

<dl class="method">
<dt id="pytraj.ActionList.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>self</em>, <em>traj=&lt;???&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.ActionList.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a series of Actions on Frame or Trajectory</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.ActionList.data">
<code class="descname">data</code><a class="headerlink" href="#pytraj.ActionList.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Store data (CpptrajDatasetList). This is for internal use.</p>
</dd></dl>

<dl class="attribute">
<dt id="pytraj.ActionList.n_frames">
<code class="descname">n_frames</code><a class="headerlink" href="#pytraj.ActionList.n_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>n_frames: &#8216;unsigned int&#8217;</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.ActionDict">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">ActionDict</code><a class="headerlink" href="#pytraj.ActionDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.ActionDict.keys" title="pytraj.ActionDict.keys"><code class="xref py py-obj docutils literal"><span class="pre">keys</span></code></a>()</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.ActionDict.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.ActionDict.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytraj.AnalysisDict">
<em class="property">class </em><code class="descclassname">pytraj.</code><code class="descname">AnalysisDict</code><a class="headerlink" href="#pytraj.AnalysisDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pytraj.AnalysisDict.keys" title="pytraj.AnalysisDict.keys"><code class="xref py py-obj docutils literal"><span class="pre">keys</span></code></a>()</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytraj.AnalysisDict.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.AnalysisDict.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pytraj.dispatch">
<code class="descclassname">pytraj.</code><code class="descname">dispatch</code><span class="sig-paren">(</span><em>type cls</em>, <em>CpptrajState state</em>, <em>line</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.dispatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.iterchunk">
<code class="descclassname">pytraj.</code><code class="descname">iterchunk</code><span class="sig-paren">(</span><em>traj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterchunk" title="Permalink to this definition">¶</a></dt>
<dd><p>iterate <code class="docutils literal"><span class="pre">traj</span></code> by chunk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>traj</strong> : TrajectoryIterator</p>
<p><strong>chunksize</strong> : int</p>
<blockquote>
<div><p>the number of frames in each chunk</p>
</div></blockquote>
<p><strong>start</strong> : int, default 0</p>
<blockquote>
<div><p>start frame to iterate</p>
</div></blockquote>
<p><strong>start</strong> : int, default -1 (last frame)</p>
<blockquote>
<div><p>stop frame</p>
</div></blockquote>
<p><strong>autoimage</strong> : bool, default False</p>
<blockquote class="last">
<div><p>if True, do autoimage for chunk</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.TrajectoryIterator.iterchunk" title="pytraj.TrajectoryIterator.iterchunk"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.TrajectoryIterator.iterchunk</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterchunk</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">autoimage</span><span class="o">=</span><span class="k">True</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.iterframe">
<code class="descclassname">pytraj.</code><code class="descname">iterframe</code><span class="sig-paren">(</span><em>traj</em>, <em>*args</em>, <em>**kwd</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.iterframe" title="Permalink to this definition">¶</a></dt>
<dd><p>create frame iterator with given indices, mask or some iter_options</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pytraj.TrajectoryIterator.iterframe" title="pytraj.TrajectoryIterator.iterframe"><code class="xref py py-obj docutils literal"><span class="pre">pytraj.TrajectoryIterator.iterframe</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s">&#39;@CA&#39;</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
<span class="go">&lt;Frame with 12 atoms&gt;</span>
</pre></div>
</div>
<p># create frame iterator for given indices
&gt;&gt;&gt; for frame in pt.iterframe(traj, frame_indices=[0, 7, 3]): print(frame)
&lt;Frame with 5293 atoms&gt;
&lt;Frame with 5293 atoms&gt;
&lt;Frame with 5293 atoms&gt;</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># iterframe its self</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">iterframe</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.select">
<code class="descclassname">pytraj.</code><code class="descname">select</code><span class="sig-paren">(</span><em>mask</em>, <em>topology</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.select" title="Permalink to this definition">¶</a></dt>
<dd><p>return atom indices</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytraj</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">load_tz2_ortho</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s">&#39;@CA&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_indices</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="s">&#39;@CA&#39;</span><span class="p">)</span>
<span class="go">array([  4,  15,  39, ..., 159, 173, 197])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pytraj.set_cpptraj_verbose">
<code class="descclassname">pytraj.</code><code class="descname">set_cpptraj_verbose</code><span class="sig-paren">(</span><em>cm=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.set_cpptraj_verbose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pytraj.show_versions">
<code class="descclassname">pytraj.</code><code class="descname">show_versions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pytraj.show_versions" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">show_versions</span><span class="p">()</span> 
</pre></div>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, pytraj developers.<br/>
      Last updated on Apr 24, 2016.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>